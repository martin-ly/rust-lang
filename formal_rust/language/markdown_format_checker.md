# Rust语言形式理论：Markdown格式检查工具

## 目录

- [Rust语言形式理论：Markdown格式检查工具](#rust语言形式理论markdown格式检查工具)
  - [目录](#目录)
  - [1. 工具目的](#1-工具目的)
  - [2. 标准格式规范](#2-标准格式规范)
    - [2.1 链接格式](#21-链接格式)
    - [2.2 锚点定义](#22-锚点定义)
    - [2.3 标题层级](#23-标题层级)
    - [2.4 列表格式](#24-列表格式)
    - [2.5 表格格式](#25-表格格式)
    - [2.6 代码块格式](#26-代码块格式)
    - [2.7 数学公式格式](#27-数学公式格式)
  - [3. 检查流程](#3-检查流程)
  - [4. 常见问题修复](#4-常见问题修复)
    - [4.1 链接问题修复](#41-链接问题修复)
    - [4.2 锚点定义问题修复](#42-锚点定义问题修复)
    - [4.3 标题层级问题修复](#43-标题层级问题修复)
    - [4.4 列表格式问题修复](#44-列表格式问题修复)
    - [4.5 表格格式问题修复](#45-表格格式问题修复)
  - [5. 自动化检查脚本](#5-自动化检查脚本)
    - [5.1 链接检查脚本](#51-链接检查脚本)
    - [5.2 锚点一致性检查脚本](#52-锚点一致性检查脚本)
    - [5.3 标题层级检查脚本](#53-标题层级检查脚本)

## 1. 工具目的

本工具旨在帮助检查和修复Rust语言形式理论文档中的Markdown格式问题，确保整个文档集保持格式统一和链接有效。主要关注点包括：

- 链接格式标准化
- 锚点定义规范化
- 标题层级结构体体体合理化
- 列表和表格格式统一
- 代码块和数学公式格式规范化

## 2. 标准格式规范

### 2.1 链接格式

**标准格式**:

- 内部链接: `[链接文本](#锚点)`
- 跨文件链接: `[链接文本](相对路径/文件名.md#锚点)`
- 外部链接: `[链接文本](https://完整URL)`

**禁止使用**:

- 空链接: `[]()`
- 未闭合的括号: `[链接文本](链接`
- 空格作为锚点的一部分: `[链接文本](#有 空格)`

**示例**:

```markdown
[所有权](#21-所有权)                                         # 正确
[类型系统](02_type_system/01_formal_type_system.md)          # 正确
[所有权](#所有权)                                            # 错误：锚点格式不符合规范
[类型系统] (02_type_system/01_formal_type_system.md)         # 错误：方括号与圆括号之间有空格
```

### 2.2 锚点定义

**标准格式**:

- 使用HTML锚点: `<a id="anchor-name"></a>`
- 锚点名称使用小写字母和连字符，不使用空格
- 每个重要概念都应有唯一的锚点

**标题自动生成的锚点规则**:

- 将标题转换为小写
- 将空格替换为连字符
- 移除特殊字符
- 如果是中文标题，则保持中文，不转换为拼音

**示例**:

```markdown
<a id="ownership-rules"></a>
## 2.1 所有权规则

# 自动生成的锚点为：21-所有权规则
```

### 2.3 标题层级

**标准格式**:

- 文档标题: `# 标题` (一级标题)
- 主要章节: `## 1. 章节标题` (二级标题)
- 子章节: `### 1.1 子章节标题` (三级标题)
- 小节: `#### 1.1.1 小节标题` (四级标题)
- 主题: `##### 主题` (五级标题)

**规则**:

- 每个文档只有一个一级标题
- 标题层级不应跳跃（例如，不应从二级标题直接到四级标题）
- 章节编号要规范且一致

**示例**:

```markdown
# Rust语言形式理论：所有权与借用           # 正确：文档标题
## 1. 引言                               # 正确：主要章节
### 1.1 背景                            # 正确：子章节
#### 1.1.1 历史发展                     # 正确：小节

## 2. 章节
#### 2.1 小节                           # 错误：从二级跳到四级，缺失三级标题
```

### 2.4 列表格式

**标准格式**:

- 无序列表: `- 列表项` 或 `* 列表项`
- 有序列表: `1. 列表项`
- 嵌套列表: 在父列表项下缩进4个空格再添加列表符号

**规则**:

- 列表符号与文本之间有一个空格
- 同一文档中的无序列表应使用相同的列表符号（要么都用`-`，要么都用`*`）
- 嵌套列表的缩进保持一致

**示例**:

```markdown
- 第一级列表项
    - 第二级列表项
        - 第三级列表项
- 另一个第一级列表项

1. 第一个有序列表项
2. 第二个有序列表项
    - 嵌套的无序列表项
    - 另一个嵌套项
3. 第三个有序列表项
```

### 2.5 表格格式

**标准格式**:

```markdown
| 列标题1 | 列标题2 | 列标题3 |
|---------|---------|---------|
| 单元格1 | 单元格2 | 单元格3 |
| 单元格4 | 单元格5 | 单元格6 |
```

**规则**:

- 列标题行与数据行之间用`|------|`分隔
- 每列的竖线对齐，便于阅读
- 单元格内容与竖线之间有一个空格
- 表格前后应有空行

### 2.6 代码块格式

**标准格式**:

````markdown
```rust
fn main() {
    println!("Hello, world!");
}
```
````

**规则**:

- 使用三个反引号开始和结束代码块
- 指定语言名称以启用语法高亮
- 代码块的缩进保持一致
- 代码块前后应有空行

### 2.7 数学公式格式

**标准格式**:

- 行内公式: `$数学公式$`
- 块级公式: `$$数学公式$$`

**规则**:

- 数学符号使用一致的表示法
- 复杂公式使用块级公式
- 变量名使用斜体（例如$x$）
- 函数名使用正体（例如$\text{sin}(x)$）

**示例**:

```markdown
行内公式示例：$x^2 + y^2 = r^2$

块级公式示例：
$$
\begin{align}
E &= mc^2 \\
m &= \frac{m_0}{\sqrt{1-\frac{v^2}{c^2}}}
\end{align}
$$
```

## 3. 检查流程

以下是推荐的Markdown格式检查流程：

1. **全局检查**
   - 使用自动化脚本扫描所有文档
   - 检查基本的Markdown语法错误
   - 验证链接格式和有效性

2. **模块级检查**
   - 检查文档结构体体体和标题层级
   - 验证锚点定义和引用
   - 检查列表和表格格式

3. **文件级检查**
   - 详细检查单个文件的格式问题
   - 验证代码块和数学公式格式
   - 确保内容与格式分离

4. **交叉引用检查**
   - 验证跨文件链接的有效性
   - 确保概念引用的一致性
   - 检查外部链接的可访问性

## 4. 常见问题修复

### 4.1 链接问题修复

**问题1：锚点格式不一致**:

原始链接:

```markdown
[所有权](#所有权)
```

修复:

```markdown
[所有权](#21-所有权)
```

**问题2：跨文件链接路径错误**:

原始链接:

```markdown
[类型系统](../type_system/formal_theory.md)
```

修复:

```markdown
[类型系统](../02_type_system/01_formal_theory.md)
```

### 4.2 锚点定义问题修复

**问题：多种锚点定义方式混用**:

原始定义:

```markdown
<a name="ownership"></a>
## 2.1 所有权
```

修复:

```markdown
<a id="21-所有权"></a>
## 2.1 所有权
```

### 4.3 标题层级问题修复

**问题：标题层级跳跃**:

原始结构体体体:

```markdown
## 2. 所有权系统
#### 2.1 所有权规则
```

修复:

```markdown
## 2. 所有权系统
### 2.1 所有权规则
```

### 4.4 列表格式问题修复

**问题：混合使用不同的列表符号**:

原始列表:

```markdown
- 第一项
* 第二项
- 第三项
```

修复:

```markdown
- 第一项
- 第二项
- 第三项
```

### 4.5 表格格式问题修复

**问题：表格列对齐不一致**:

原始表格:

```markdown
| 列1 | 列2|列3 |
|----|--|---|
|数据1|数据2|数据3|
```

修复:

```markdown
| 列1 | 列2 | 列3 |
|-----|-----|-----|
| 数据1 | 数据2 | 数据3 |
```

## 5. 自动化检查脚本

以下是一些用于自动检查Markdown格式的脚本示例：

### 5.1 链接检查脚本

```bash
#!/bin/bash
# 检查所有Markdown文件中的链接格式
find formal_rust/language -name "*.md" -exec grep -l "\[[^]]*\]([^)]*)" {} \; | \
while read file; do
    echo "检查文件: $file"
    # 检查内部链接格式
    grep -n "\[[^]]*\](#[^)]*)" "$file" | \
    grep -v "\[[^]]*\](#[a-z0-9-]*)"
    # 检查外部链接格式
    grep -n "\[[^]]*\](http[^)]*)" "$file" | \
    grep " "
done
```

### 5.2 锚点一致性检查脚本

```bash
#!/bin/bash
# 检查标题自动生成的锚点与手动定义的锚点是否一致
find formal_rust/language -name "*.md" -exec grep -l "^#" {} \; | \
while read file; do
    echo "检查文件: $file"
    # 提取标题
    grep -n "^#" "$file" > /tmp/titles.txt
    # 提取锚点定义
    grep -n "<a id=" "$file" > /tmp/anchors.txt
    # 比较锚点一致性
    # (这里需要更复杂的脚本来实际比较)
done
```

### 5.3 标题层级检查脚本

```bash
#!/bin/bash
# 检查标题层级是否有跳跃
find formal_rust/language -name "*.md" -exec grep -l "^#" {} \; | \
while read file; do
    echo "检查文件: $file"
    # 提取标题层级
    grep -n "^#" "$file" | sed 's/:.*//' > /tmp/levels.txt
    # 检查层级跳跃
    # (这里需要更复杂的脚本来检测层级跳跃)
done
```

---

**文档生成**: 2025年7月27日  
**版本**: V1.0  
**状态**: 进行中 - 将随质量检查工作进展而更新

"

---

<!-- 以下为按标准模板自动补全的占位章节，待后续填充 -->
"
## 概述
(待补充，参考 STANDARD_DOCUMENT_TEMPLATE_2025.md)\n
## 技术背景
(待补充，参考 STANDARD_DOCUMENT_TEMPLATE_2025.md)\n
## 核心概念
(待补充，参考 STANDARD_DOCUMENT_TEMPLATE_2025.md)\n
## 技术实现
(待补充，参考 STANDARD_DOCUMENT_TEMPLATE_2025.md)\n
## 形式化分析
(待补充，参考 STANDARD_DOCUMENT_TEMPLATE_2025.md)\n
## 应用案例
(待补充，参考 STANDARD_DOCUMENT_TEMPLATE_2025.md)\n
## 性能分析
(待补充，参考 STANDARD_DOCUMENT_TEMPLATE_2025.md)\n
## 最佳实践
(待补充，参考 STANDARD_DOCUMENT_TEMPLATE_2025.md)\n
## 未来值值展望
(待补充，参考 STANDARD_DOCUMENT_TEMPLATE_2025.md)\n


