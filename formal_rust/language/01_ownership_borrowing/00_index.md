# 01. 所有权与借用系统（Ownership & Borrowing）

## 目录

- [引言](#1-引言)
1. [所有权理论基础](#2-所有权理论基础)
    1. [所有权规则与内存安全](#21-所有权规则与内存安全)
    2. [所有权的形式化定义](#22-所有权的形式化定义)
    3. [所有权与生命周期的关系](#23-所有权与生命周期的关系)
2. [借用与引用](#3-借用与引用)
    1. [不可变借用](#31-不可变借用)
    2. [可变借用与排他性](#32-可变借用与排他性)
    3. [借用检查器与静态分析](#33-借用检查器与静态分析)
3. [生命周期系统](#4-生命周期系统)
    1. [生命周期标注与推断](#41-生命周期标注与推断)
    2. [生命周期的形式化符号](#42-生命周期的形式化符号)
    3. [生命周期与悬垂引用](#43-生命周期与悬垂引用)
4. [Copy/Move 语义与资源管理](#5-copymove-语义与资源管理)
    1. [Copy 语义](#51-copy-语义)
    2. [Move 语义](#52-move-语义)
    3. [所有权转移与资源释放](#53-所有权转移与资源释放)
5. [所有权与借用的多表征](#6-所有权与借用的多表征)
    1. [图示：所有权流转](#61-图示所有权流转)
    2. [表格：借用规则对比](#62-表格借用规则对比)
    3. [公式：所有权与借用的类型系统](#63-公式所有权与借用的类型系统)
    4. [代码示例](#64-代码示例)
6. [工程实现与最佳实践](#7-工程实现与最佳实践)
7. [哲学批判与设计哲学](#8-哲学批判与设计哲学)
8. [参考文献与交叉引用](#9-参考文献与交叉引用)

---

 **内部链接示例**：

 - [所有权规则与内存安全](#21-所有权规则与内存安全)
 - [生命周期的形式化符号](#42-生命周期的形式化符号)
 - [代码示例](#64-代码示例)

---

 **图示（Mermaid）**：

 ```mermaid
 graph TD;
   A[变量声明] -- B[获得所有权];
   B -- C[借用（&/ &mut）];
   C -- D[生命周期检查];
   D -- E[作用域结束，资源释放];
 ```

 **表格：借用规则对比**

 | 借用类型   | 可同时存在 | 可变性 | 作用域限制 |
 |------------|------------|--------|------------|
 | &T         | 多个       | 否     | 只读       |
 | &mut T     | 仅一个     | 是     | 独占写     |

 **公式：所有权与借用的类型系统**
 $$
 \Gamma \vdash x : T \implies \exists!\ owner(x) \land \forall\ borrow(x),\ valid(borrow(x))
 $$

 **代码示例**

 ```rust
 fn main() {
     let mut s = String::from("hello");
     let r1 = &s; // 不可变借用
     let r2 = &s; // 允许多个不可变借用
     // let r3 = &mut s; // 编译错误：不能同时有可变和不可变借用
     println!("{} {}", r1, r2);
 }
 ```

---

 **交叉引用**：

 - [类型系统](../02_type_system/00_index.md)
 - [控制流](../03_control_flow/00_index.md)
 - [并发系统](../05_concurrency/00_index.md)
