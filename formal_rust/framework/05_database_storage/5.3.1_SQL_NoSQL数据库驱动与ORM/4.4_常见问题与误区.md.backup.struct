# SQL/NoSQL数据库驱动与ORM - 常见问题与误区

## 1. 常见问题

### 1.1 连接池配置不当

- 问题：连接池过小导致并发瓶颈，过大导致数据库压力过大。
- 建议：根据业务QPS和数据库承载能力合理配置，监控连接池状态。

### 1.2 类型映射错误

- 问题：Rust类型与数据库类型不匹配，导致运行时错误或数据丢失。
- 建议：使用ORM/驱动的类型安全特征，避免手动类型转换。

### 1.3 SQL注入风险

- 问题：拼接SQL语句易引发注入漏洞。
- 建议：始终使用参数化查询，避免字符串拼接。

### 1.4 事务管理混乱

- 问题：事务未正确提交/回滚，导致数据不一致。
- 建议：明确事务边界，善用自动回滚和错误处理。

### 1.5 迁移工具使用不当

- 问题：数据库迁移脚本未测试，导致生产环境异常。
- 建议：严格区分开发/生产环境，迁移前充分测试。

## 2. 常见误区

### 2.1 盲目追求异步

- 误区：所有场景都用异步，反而增加复杂度。
- 建议：高并发IO密集场景优先异步，简单业务可用同步。

### 2.2 ORM万能论

- 误区：认为ORM能解决所有数据访问问题。
- 建议：复杂查询、性能敏感场景可结合自定义SQL。

### 2.3 忽视数据库特征

- 误区：不同数据库间无差异，随意切换。
- 建议：关注数据库事务、索引、锁机制等差异，合理选型。

### 2.4 忽视错误处理

- 误区：数据库操作未做错误处理，导致异常未捕获。
- 建议：所有数据库操作需显式处理Result/Option，记录日志。

## 3. 最佳实践建议

- 合理配置连接池，监控运行状态。
- 优先使用参数化查询和类型安全API。
- 结合ORM与自定义SQL，兼顾开发效率与性能。
- 关注数据库驱动/ORM社区动态，及时升级修复漏洞。


