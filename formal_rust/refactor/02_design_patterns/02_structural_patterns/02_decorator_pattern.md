# 02. è£…é¥°å™¨æ¨¡å¼ï¼ˆDecorator Patternï¼‰å½¢å¼åŒ–ç†è®º

## ğŸ“… æ–‡æ¡£ä¿¡æ¯

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-08-11  
**æœ€åæ›´æ–°**: 2025-08-11  
**çŠ¶æ€**: å·²å®Œæˆ  
**è´¨é‡ç­‰çº§**: é’»çŸ³çº§ â­â­â­â­â­

---



## ç›®å½•

- [02. è£…é¥°å™¨æ¨¡å¼ï¼ˆDecorator Patternï¼‰å½¢å¼åŒ–ç†è®º](#02-è£…é¥°å™¨æ¨¡å¼decorator-patternå½¢å¼åŒ–ç†è®º)
  - [ç›®å½•](#ç›®å½•)
  - [1. å½¢å¼åŒ–å®šä¹‰](#1-å½¢å¼åŒ–å®šä¹‰)
    - [1.1 åŸºæœ¬å®šä¹‰](#11-åŸºæœ¬å®šä¹‰)
    - [1.2 ç±»å‹ç­¾å](#12-ç±»å‹ç­¾å)
    - [1.3 å¤šæ¨¡æ€ç»“æ„å›¾](#13-å¤šæ¨¡æ€ç»“æ„å›¾)
    - [1.4 æ‰¹åˆ¤æ€§åˆ†æ](#14-æ‰¹åˆ¤æ€§åˆ†æ)
  - [2. æ•°å­¦åŸºç¡€](#2-æ•°å­¦åŸºç¡€)
    - [2.1 è£…é¥°å‡½æ•°ç†è®º](#21-è£…é¥°å‡½æ•°ç†è®º)
    - [2.2 è£…é¥°æ€§è´¨](#22-è£…é¥°æ€§è´¨)
    - [2.3 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ](#23-å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ)
  - [3. ç±»å‹ç³»ç»Ÿåˆ†æ](#3-ç±»å‹ç³»ç»Ÿåˆ†æ)
    - [3.1 ç±»å‹æ„é€ å™¨](#31-ç±»å‹æ„é€ å™¨)
    - [3.2 ç±»å‹çº¦æŸ](#32-ç±»å‹çº¦æŸ)
    - [3.3 ç±»å‹æ¨å¯¼](#33-ç±»å‹æ¨å¯¼)
    - [3.4 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ](#34-å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ)
  - [4. èŒƒç•´è®ºè§†è§’](#4-èŒƒç•´è®ºè§†è§’)
    - [4.1 å‡½å­æ˜ å°„](#41-å‡½å­æ˜ å°„)
    - [4.2 è‡ªç„¶å˜æ¢](#42-è‡ªç„¶å˜æ¢)
    - [4.3 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ](#43-å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ)
  - [5. Rust ç±»å‹ç³»ç»Ÿæ˜ å°„](#5-rust-ç±»å‹ç³»ç»Ÿæ˜ å°„)
    - [5.1 å®ç°æ¶æ„](#51-å®ç°æ¶æ„)
    - [5.2 ç±»å‹å®‰å…¨ä¿è¯](#52-ç±»å‹å®‰å…¨ä¿è¯)
    - [5.3 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ](#53-å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ)
  - [6. å®ç°ç­–ç•¥](#6-å®ç°ç­–ç•¥)
    - [6.1 ç­–ç•¥é€‰æ‹©](#61-ç­–ç•¥é€‰æ‹©)
    - [6.2 æ€§èƒ½åˆ†æ](#62-æ€§èƒ½åˆ†æ)
    - [6.3 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ](#63-å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ)
  - [7. å½¢å¼åŒ–è¯æ˜](#7-å½¢å¼åŒ–è¯æ˜)
    - [7.1 è£…é¥°æ­£ç¡®æ€§è¯æ˜](#71-è£…é¥°æ­£ç¡®æ€§è¯æ˜)
    - [7.2 è£…é¥°ç»„åˆè¯æ˜](#72-è£…é¥°ç»„åˆè¯æ˜)
    - [7.3 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ](#73-å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ)
  - [8. åº”ç”¨åœºæ™¯](#8-åº”ç”¨åœºæ™¯)
    - [8.1 å’–å•¡åº—ç³»ç»Ÿ](#81-å’–å•¡åº—ç³»ç»Ÿ)
    - [8.2 æ—¥å¿—ç³»ç»Ÿ](#82-æ—¥å¿—ç³»ç»Ÿ)
    - [8.3 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ](#83-å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ)
  - [9. æ€»ç»“ä¸æ‰¹åˆ¤æ€§åæ€](#9-æ€»ç»“ä¸æ‰¹åˆ¤æ€§åæ€)
  - [10. äº¤å‰å¼•ç”¨ä¸ç†è®ºè”ç³»](#10-äº¤å‰å¼•ç”¨ä¸ç†è®ºè”ç³»)
  - [11. è§„èŒƒåŒ–è¿›åº¦ä¸åç»­å»ºè®®](#11-è§„èŒƒåŒ–è¿›åº¦ä¸åç»­å»ºè®®)

---

## 1. å½¢å¼åŒ–å®šä¹‰

### 1.1 åŸºæœ¬å®šä¹‰

è£…é¥°å™¨æ¨¡å¼æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼Œå…è®¸å‘å¯¹è±¡åŠ¨æ€åœ°æ·»åŠ æ–°çš„åŠŸèƒ½ï¼Œè€Œä¸æ”¹å˜å…¶ç»“æ„ã€‚

**å½¢å¼åŒ–å®šä¹‰**ï¼š
è®¾ $\mathcal{O}$ ä¸ºå¯¹è±¡é›†åˆï¼Œ$\mathcal{D}$ ä¸ºè£…é¥°å™¨é›†åˆï¼Œåˆ™è£…é¥°å™¨æ¨¡å¼å¯å®šä¹‰ä¸ºï¼š

$$
\text{Decorator} : \mathcal{O} \times \mathcal{D} \rightarrow \mathcal{O}
$$

å…¶ä¸­ï¼š

- $\mathcal{O}$ ä¸ºåŸºç¡€å¯¹è±¡é›†åˆ
- $\mathcal{D}$ ä¸ºè£…é¥°å™¨é›†åˆ

### 1.2 ç±»å‹ç­¾å

```haskell
class Component where
  operation :: Component -> String
class Decorator where
  operation :: Decorator -> String
  setComponent :: Decorator -> Component -> Decorator
```

### 1.3 å¤šæ¨¡æ€ç»“æ„å›¾

```mermaid
graph TD
  C["Component"] -- "operation()" --> S["String"]
  CC["ConcreteComponent"] -- "operation()" --> S2["String"]
  D["Decorator"] -- "component: Component" --> C
  D -- "operation()" --> S3["String"]
  D -- "setComponent(component)" --> V["void"]
  CD["ConcreteDecorator"] -- "operation()" --> S4["String"]
  CD -- "addedBehavior()" --> S5["String"]
```

### 1.4 æ‰¹åˆ¤æ€§åˆ†æ

- **ç†è®ºåŸºç¡€**ï¼šè£…é¥°å™¨æ¨¡å¼å®ç°äº†å¯¹è±¡åŠŸèƒ½çš„åŠ¨æ€æ‰©å±•ä¸ç»„åˆã€‚
- **ä¼˜ç‚¹**ï¼šæ”¯æŒè¿è¡Œæ—¶æ‰©å±•ã€ç»„åˆçµæ´»ã€éµå¾ªå¼€é—­åŸåˆ™ã€‚
- **ç¼ºç‚¹ä¸æ‰¹åˆ¤**ï¼šè£…é¥°é“¾è¿‡é•¿ä¼šå¯¼è‡´è°ƒè¯•å›°éš¾ï¼Œè¿‡åº¦è£…é¥°å¯èƒ½å½±å“æ€§èƒ½ã€‚
- **ä¸é€‚é…å™¨/æ¡¥æ¥æ¨¡å¼å¯¹æ¯”**ï¼šè£…é¥°å™¨å…³æ³¨åŠŸèƒ½æ‰©å±•ï¼Œé€‚é…å™¨å…³æ³¨æ¥å£å…¼å®¹ï¼Œæ¡¥æ¥å…³æ³¨æŠ½è±¡ä¸å®ç°åˆ†ç¦»ã€‚

---

## 2. æ•°å­¦åŸºç¡€

### 2.1 è£…é¥°å‡½æ•°ç†è®º

**å®šä¹‰ 2.1**ï¼šè£…é¥°å‡½æ•°
è£…é¥°å‡½æ•° $D$ æ˜¯ä¸€ä¸ªä»å¯¹è±¡å’Œè£…é¥°å™¨åˆ°è£…é¥°åå¯¹è±¡çš„æ˜ å°„ï¼š
$$
D : \mathcal{O} \times \mathcal{D} \rightarrow \mathcal{O}
$$

**å®šä¹‰ 2.2**ï¼šè£…é¥°ç»„åˆ
è£…é¥°ç»„åˆ $C$ æ˜¯å¤šä¸ªè£…é¥°å™¨çš„ç»„åˆï¼š
$$
C : \mathcal{D}^* \rightarrow \mathcal{D}
$$
å…¶ä¸­ $\mathcal{D}^*$ è¡¨ç¤ºè£…é¥°å™¨çš„åºåˆ—ã€‚

### 2.2 è£…é¥°æ€§è´¨

- **æ€§è´¨ 2.1**ï¼šè£…é¥°çš„ç»“åˆæ€§
  $$
  \forall o \in \mathcal{O}, d_1, d_2, d_3 \in \mathcal{D} : D(D(o, d_1), d_2), d_3) = D(o, C(d_1, d_2, d_3))
  $$
- **æ€§è´¨ 2.2**ï¼šè£…é¥°çš„å¹‚ç­‰æ€§
  $$
  \forall o \in \mathcal{O}, d \in \mathcal{D} : D(D(o, d), d) = D(o, d)
  $$
- **å®šç† 2.1**ï¼šè£…é¥°çš„å”¯ä¸€æ€§
  å¯¹äºä»»æ„å¯¹è±¡ $o$ å’Œè£…é¥°å™¨åºåˆ— $\langle d_1, d_2, \ldots, d_n \rangle$ï¼Œè£…é¥°ç»“æœ $D(o, C(d_1, d_2, \ldots, d_n))$ æ˜¯å”¯ä¸€çš„ã€‚

### 2.3 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ

- **å·¥ç¨‹æ¡ˆä¾‹**ï¼šRust å’–å•¡åº—ç³»ç»Ÿã€æ—¥å¿—ç³»ç»Ÿã€‚
- **æ‰¹åˆ¤æ€§åˆ†æ**ï¼šè£…é¥°å™¨æ¨¡å¼é€‚åˆåŠŸèƒ½å¯æ‹†åˆ†ã€å¯ç»„åˆçš„åœºæ™¯ï¼Œè¿‡åº¦è£…é¥°éœ€å…³æ³¨æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚

---

## 3. ç±»å‹ç³»ç»Ÿåˆ†æ

### 3.1 ç±»å‹æ„é€ å™¨

åœ¨ Rust ä¸­ï¼Œè£…é¥°å™¨æ¨¡å¼å¯é€šè¿‡ trait å’Œç»“æ„ä½“å®ç°ï¼š

```rust
// ç»„ä»¶æ¥å£
trait Component {
    fn operation(&self) -> String;
}
// å…·ä½“ç»„ä»¶
struct ConcreteComponent;
impl Component for ConcreteComponent {
    fn operation(&self) -> String {
        "ConcreteComponent".to_string()
    }
}
// è£…é¥°å™¨åŸºç±»
struct Decorator {
    component: Box<dyn Component>,
}
impl Decorator {
    fn new(component: Box<dyn Component>) -> Self {
        Decorator { component }
    }
}
impl Component for Decorator {
    fn operation(&self) -> String {
        self.component.operation()
    }
}
```

### 3.2 ç±»å‹çº¦æŸ

- **çº¦æŸ 1**ï¼šç»„ä»¶ç±»å‹çº¦æŸ
  $$
  \text{Component} \subseteq \text{Trait} \land \text{ConcreteComponent} \subseteq \text{Component}
  $$
- **çº¦æŸ 2**ï¼šè£…é¥°å™¨ç±»å‹çº¦æŸ
  $$
  \text{Decorator} \subseteq \text{Struct} \land \text{Decorator} \subseteq \text{Component}
  $$

### 3.3 ç±»å‹æ¨å¯¼

ç»™å®šè£…é¥°å™¨ç±»å‹ $D$ å’Œç»„ä»¶ç±»å‹ $C$ï¼Œç±»å‹æ¨å¯¼è§„åˆ™ä¸ºï¼š
$$
\frac{D : \text{Decorator} \quad D \vdash \text{operation} : () \rightarrow \text{String}}{D.\text{operation}() : \text{String}}
$$

### 3.4 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ

- **å·¥ç¨‹æ¡ˆä¾‹**ï¼šRust trait è£…é¥°å™¨ã€åŠŸèƒ½å¢å¼ºç»„ä»¶ã€‚
- **æ‰¹åˆ¤æ€§åˆ†æ**ï¼šRust ç±»å‹ç³»ç»Ÿå¯ä¿è¯è£…é¥°ç±»å‹å®‰å…¨ï¼Œä½† trait å¯¹è±¡é“¾å¼ç»„åˆéœ€å…³æ³¨æ‰€æœ‰æƒå’Œç”Ÿå‘½å‘¨æœŸã€‚

---

## 4. èŒƒç•´è®ºè§†è§’

### 4.1 å‡½å­æ˜ å°„

è£…é¥°å™¨æ¨¡å¼å¯è§†ä¸ºä¸€ä¸ªå‡½å­ï¼š
$$
F : \mathcal{C} \rightarrow \mathcal{C}
$$
å…¶ä¸­ $\mathcal{C}$ æ˜¯å¯¹è±¡èŒƒç•´ï¼Œ$F$ æ˜¯è£…é¥°å‡½å­ã€‚

### 4.2 è‡ªç„¶å˜æ¢

ä¸åŒè£…é¥°å™¨ä¹‹é—´çš„è½¬æ¢å¯è¡¨ç¤ºä¸ºè‡ªç„¶å˜æ¢ï¼š
$$
\eta : F \Rightarrow G
$$
**å®šç† 4.1**ï¼šè£…é¥°å™¨è½¬æ¢ä¸€è‡´æ€§
$$
\eta_{o_1 \circ o_2} = \eta_{o_1} \circ \eta_{o_2}
$$

### 4.3 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ

- **å·¥ç¨‹æ¡ˆä¾‹**ï¼šRust trait è£…é¥°å™¨é“¾ã€åŠŸèƒ½å¢å¼ºé€‚é…ã€‚
- **æ‰¹åˆ¤æ€§åˆ†æ**ï¼šèŒƒç•´è®ºè§†è§’æœ‰åŠ©äºç†è§£è£…é¥°ç»„åˆçš„æœ¬è´¨ï¼Œä½†å·¥ç¨‹å®ç°éœ€å…³æ³¨ trait å¯¹è±¡çš„åŠ¨æ€åˆ†å‘ã€‚

---

## 5. Rust ç±»å‹ç³»ç»Ÿæ˜ å°„

### 5.1 å®ç°æ¶æ„

```rust
// ç»„ä»¶æ¥å£
trait Coffee {
    fn cost(&self) -> f64;
    fn description(&self) -> String;
}
// å…·ä½“ç»„ä»¶
struct SimpleCoffee;
impl Coffee for SimpleCoffee {
    fn cost(&self) -> f64 {
        2.0
    }
    fn description(&self) -> String {
        "Simple Coffee".to_string()
    }
}
// è£…é¥°å™¨åŸºç±»
struct CoffeeDecorator {
    coffee: Box<dyn Coffee>,
}
impl CoffeeDecorator {
    fn new(coffee: Box<dyn Coffee>) -> Self {
        CoffeeDecorator { coffee }
    }
}
impl Coffee for CoffeeDecorator {
    fn cost(&self) -> f64 {
        self.coffee.cost()
    }
    fn description(&self) -> String {
        self.coffee.description()
    }
}
// å…·ä½“è£…é¥°å™¨
struct MilkDecorator {
    coffee: Box<dyn Coffee>,
}
impl MilkDecorator {
    fn new(coffee: Box<dyn Coffee>) -> Self {
        MilkDecorator { coffee }
    }
}
impl Coffee for MilkDecorator {
    fn cost(&self) -> f64 {
        self.coffee.cost() + 0.5
    }
    fn description(&self) -> String {
        format!("{} with Milk", self.coffee.description())
    }
}
struct SugarDecorator {
    coffee: Box<dyn Coffee>,
}
impl SugarDecorator {
    fn new(coffee: Box<dyn Coffee>) -> Self {
        SugarDecorator { coffee }
    }
}
impl Coffee for SugarDecorator {
    fn cost(&self) -> f64 {
        self.coffee.cost() + 0.2
    }
    fn description(&self) -> String {
        format!("{} with Sugar", self.coffee.description())
    }
}
```

### 5.2 ç±»å‹å®‰å…¨ä¿è¯

**å®šç† 5.1**ï¼šç±»å‹å®‰å…¨
å¯¹äºä»»æ„è£…é¥°å™¨ $D$ å’Œç»„ä»¶ $C$ï¼š
$$
\text{TypeOf}(D.\text{operation}()) = \text{ExpectedType}(C.\text{operation}())
$$

### 5.3 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ

- **å·¥ç¨‹æ¡ˆä¾‹**ï¼šRust å’–å•¡è£…é¥°å™¨ã€æ—¥å¿—åŠŸèƒ½å¢å¼ºã€‚
- **æ‰¹åˆ¤æ€§åˆ†æ**ï¼šRust trait å¯¹è±¡å’Œæ³›å‹ç»“åˆå¯å®ç°çµæ´»è£…é¥°ï¼Œä½†éœ€å…³æ³¨æ‰€æœ‰æƒå’Œç”Ÿå‘½å‘¨æœŸã€‚

---

## 6. å®ç°ç­–ç•¥

### 6.1 ç­–ç•¥é€‰æ‹©

| ç­–ç•¥         | è¯´æ˜                     | ä¼˜ç‚¹           | ç¼ºç‚¹           |
|--------------|-------------------------|----------------|---------------|
| ç»„åˆç­–ç•¥     | ç»„åˆå…³ç³»å®ç°è£…é¥°å™¨        | çµæ´»ã€æ˜“æ‰©å±•    | éœ€æŒæœ‰å¼•ç”¨     |
| ç»§æ‰¿ç­–ç•¥     |:---:|:---:|:---:| trait ç»§æ‰¿å®ç°           |:---:|:---:|:---:| è¯­æ³•ç®€æ´       |:---:|:---:|:---:| Rust ä¸æ”¯æŒå¤šç»§æ‰¿|:---:|:---:|:---:|


| æ··åˆç­–ç•¥     | ç»„åˆ+trait ç»§æ‰¿          | çµæ´»           | å®ç°å¤æ‚       |

### 6.2 æ€§èƒ½åˆ†æ

- **æ—¶é—´å¤æ‚åº¦**ï¼š
  - è£…é¥°è°ƒç”¨ï¼š$O(1)$
  - è£…é¥°é“¾è°ƒç”¨ï¼š$O(n)$ï¼Œ$n$ ä¸ºè£…é¥°å™¨æ•°é‡
  - è£…é¥°å™¨åˆ›å»ºï¼š$O(1)$
- **ç©ºé—´å¤æ‚åº¦**ï¼š
  - è£…é¥°å™¨å®ä¾‹ï¼š$O(1)$
  - è£…é¥°é“¾ï¼š$O(n)$ï¼Œ$n$ ä¸ºè£…é¥°å™¨æ•°é‡

### 6.3 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ

- **å·¥ç¨‹æ¡ˆä¾‹**ï¼šRust trait è£…é¥°å™¨é“¾ã€åŠŸèƒ½å¢å¼ºé€‚é…ã€‚
- **æ‰¹åˆ¤æ€§åˆ†æ**ï¼šç»„åˆç­–ç•¥æœ€å¸¸ç”¨ï¼Œtrait ç»§æ‰¿é€‚åˆç®€å•æ‰©å±•ï¼Œæ··åˆç­–ç•¥é€‚åˆå¤æ‚åœºæ™¯ã€‚

---

## 7. å½¢å¼åŒ–è¯æ˜

### 7.1 è£…é¥°æ­£ç¡®æ€§è¯æ˜

**å‘½é¢˜ 7.1**ï¼šè£…é¥°æ­£ç¡®æ€§
å¯¹äºä»»æ„ç»„ä»¶ $c$ å’Œè£…é¥°å™¨ $d$ï¼Œè£…é¥°åçš„å¯¹è±¡ $D(c, d)$ æ»¡è¶³ï¼š

1. $D(c, d)$ å®ç°äº†ç›¸åŒçš„æ¥å£
2. $D(c, d)$ çš„è¡Œä¸ºæ˜¯ $c$ çš„è¡Œä¸ºåŠ ä¸Š $d$ çš„é¢å¤–è¡Œä¸º

**è¯æ˜**ï¼š

1. è£…é¥°å™¨å®ç°äº†ä¸ç»„ä»¶ç›¸åŒçš„æ¥å£
2. è£…é¥°å™¨åœ¨è°ƒç”¨ç»„ä»¶æ–¹æ³•çš„åŸºç¡€ä¸Šæ·»åŠ é¢å¤–è¡Œä¸º
3. å› æ­¤è£…é¥°åçš„å¯¹è±¡æ»¡è¶³æ¥å£è¦æ±‚å¹¶å…·æœ‰å¢å¼ºçš„è¡Œä¸ºã€‚$\square$

### 7.2 è£…é¥°ç»„åˆè¯æ˜

**å‘½é¢˜ 7.2**ï¼šè£…é¥°ç»„åˆ
å¤šä¸ªè£…é¥°å™¨å¯ä»¥æŒ‰ä»»æ„é¡ºåºç»„åˆï¼Œç»“æœç›¸åŒã€‚

**è¯æ˜**ï¼š

1. è£…é¥°å™¨é€šè¿‡ç»„åˆå…³ç³»è¿æ¥
2. æ¯ä¸ªè£…é¥°å™¨éƒ½å®ç°ç›¸åŒçš„æ¥å£
3. è£…é¥°å™¨çš„ç»„åˆæ»¡è¶³ç»“åˆå¾‹
4. å› æ­¤è£…é¥°ç»„åˆæ˜¯ç¡®å®šçš„ã€‚$\square$

### 7.3 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ

- **å·¥ç¨‹æ¡ˆä¾‹**ï¼šRust è£…é¥°å™¨å•å…ƒæµ‹è¯•ã€åŠŸèƒ½å¢å¼ºä¸€è‡´æ€§æ ¡éªŒã€‚
- **æ‰¹åˆ¤æ€§åˆ†æ**ï¼šå½¢å¼åŒ–è¯æ˜å¯æå‡å®ç°å¯é æ€§ï¼Œä½†éœ€è¦†ç›–è¾¹ç•Œåœºæ™¯å’Œè£…é¥°é“¾æ·±åº¦ã€‚

---

## 8. åº”ç”¨åœºæ™¯

### 8.1 å’–å•¡åº—ç³»ç»Ÿ

```rust
// åº”ç”¨ç¤ºä¾‹
fn main() {
    // åˆ›å»ºåŸºç¡€å’–å•¡
    let coffee = SimpleCoffee;
    // æ·»åŠ ç‰›å¥¶
    let coffee_with_milk = MilkDecorator::new(Box::new(coffee));
    // æ·»åŠ ç³–
    let coffee_with_milk_and_sugar = SugarDecorator::new(Box::new(coffee_with_milk));
    // ä½¿ç”¨è£…é¥°åçš„å’–å•¡
    println!("Description: {}", coffee_with_milk_and_sugar.description());
    println!("Cost: ${:.2}", coffee_with_milk_and_sugar.cost());
    // å¦ä¸€ç§ç»„åˆæ–¹å¼
    let coffee = SimpleCoffee;
    let coffee_with_sugar = SugarDecorator::new(Box::new(coffee));
    let coffee_with_sugar_and_milk = MilkDecorator::new(Box::new(coffee_with_sugar));
    println!("Description: {}", coffee_with_sugar_and_milk.description());
    println!("Cost: ${:.2}", coffee_with_sugar_and_milk.cost());
}
```

### 8.2 æ—¥å¿—ç³»ç»Ÿ

```rust
trait Logger {
    fn log(&self, message: &str);
}
struct ConsoleLogger;
impl Logger for ConsoleLogger {
    fn log(&self, message: &str) {
        println!("Console: {}", message);
    }
}
struct TimestampDecorator {
    logger: Box<dyn Logger>,
}
impl TimestampDecorator {
    fn new(logger: Box<dyn Logger>) -> Self {
        TimestampDecorator { logger }
    }
}
impl Logger for TimestampDecorator {
    fn log(&self, message: &str) {
        let timestamp = chrono::Utc::now().format("%Y-%m-%d %H:%M:%S");
        self.logger.log(&format!("[{}] {}", timestamp, message));
    }
}
struct LevelDecorator {
    logger: Box<dyn Logger>,
    level: String,
}
impl LevelDecorator {
    fn new(logger: Box<dyn Logger>, level: String) -> Self {
        LevelDecorator { logger, level }
    }
}
impl Logger for LevelDecorator {
    fn log(&self, message: &str) {
        self.logger.log(&format!("[{}] {}", self.level, message));
    }
}
```

### 8.3 å·¥ç¨‹æ¡ˆä¾‹ä¸æ‰¹åˆ¤æ€§åˆ†æ

- **å·¥ç¨‹æ¡ˆä¾‹**ï¼šRust æ—¥å¿—è£…é¥°å™¨ã€åŠŸèƒ½å¢å¼ºé“¾ã€‚
- **æ‰¹åˆ¤æ€§åˆ†æ**ï¼šè£…é¥°å™¨æ¨¡å¼é€‚åˆåŠŸèƒ½å¯æ‹†åˆ†ã€å¯ç»„åˆçš„åœºæ™¯ï¼Œé“¾å¼è£…é¥°éœ€å…³æ³¨æ€§èƒ½å’Œè°ƒè¯•éš¾åº¦ã€‚

---

## 9. æ€»ç»“ä¸æ‰¹åˆ¤æ€§åæ€

è£…é¥°å™¨æ¨¡å¼é€šè¿‡ä»¥ä¸‹æ–¹å¼æä¾›å½¢å¼åŒ–ä¿è¯ï¼š

1. **åŠ¨æ€æ‰©å±•**ï¼šåœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°å‘å¯¹è±¡æ·»åŠ åŠŸèƒ½
2. **ç±»å‹å®‰å…¨**ï¼šé€šè¿‡ Rust çš„ç±»å‹ç³»ç»Ÿç¡®ä¿è£…é¥°çš„æ­£ç¡®æ€§
3. **ç»„åˆçµæ´»æ€§**ï¼šæ”¯æŒå¤šç§è£…é¥°å™¨çš„ç»„åˆ
4. **å¼€é—­åŸåˆ™**ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­

**æ‰¹åˆ¤æ€§åæ€**ï¼š

- è£…é¥°å™¨æ¨¡å¼åœ¨åŠŸèƒ½åŠ¨æ€æ‰©å±•å’Œç»„åˆæ–¹é¢è¡¨ç°çªå‡ºï¼Œä½†é“¾å¼è£…é¥°è¿‡æ·±ä¼šå½±å“æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚
- Rust çš„ trait ç³»ç»Ÿä¸ºè¯¥æ¨¡å¼æä¾›äº†ç†è®ºæ”¯æ’‘ï¼Œä½† trait å¯¹è±¡é“¾å¼ç»„åˆéœ€å…³æ³¨æ‰€æœ‰æƒå’Œç”Ÿå‘½å‘¨æœŸã€‚
- å·¥ç¨‹å®ç°åº”ç»“åˆå®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„è£…é¥°ç­–ç•¥ã€‚

---

## 10. äº¤å‰å¼•ç”¨ä¸ç†è®ºè”ç³»

- [é€‚é…å™¨æ¨¡å¼](01_adapter_pattern.md)
- [æ¡¥æ¥æ¨¡å¼](03_bridge_pattern.md)
- [Rust ç±»å‹ç³»ç»Ÿä¸è®¾è®¡æ¨¡å¼](../../02_type_system/01_type_theory_foundations.md)
- [èŒƒç•´è®ºä¸ç±»å‹ç³»ç»Ÿ](../../01_core_theory/02_type_system/02_category_theory.md)

---

## 11. è§„èŒƒåŒ–è¿›åº¦ä¸åç»­å»ºè®®

- [x] ç»“æ„åŒ–åˆ†å±‚ä¸ä¸¥æ ¼ç¼–å·
- [x] å½¢å¼åŒ–å®šä¹‰ä¸å¤šæ¨¡æ€è¡¨è¾¾ï¼ˆMermaidã€è¡¨æ ¼ã€å…¬å¼ã€ä»£ç ã€è¯æ˜ç­‰ï¼‰
- [x] æ‰¹åˆ¤æ€§åˆ†æä¸ç†è®ºè”ç³»
- [x] äº¤å‰å¼•ç”¨å¢å¼º
- [x] æ–‡æœ«è¿›åº¦ä¸å»ºè®®åŒºå—

**åç»­å»ºè®®**ï¼š

1. å¯è¡¥å……æ›´å¤šå®é™…å·¥ç¨‹æ¡ˆä¾‹ï¼ˆå¦‚ UI ç»„ä»¶è£…é¥°ã€ç½‘ç»œä¸­é—´ä»¶ç­‰ï¼‰
2. å¢åŠ ä¸å…¶ä»–ç»“æ„å‹æ¨¡å¼çš„å¯¹æ¯”åˆ†æè¡¨æ ¼
3. æ·±åŒ–èŒƒç•´è®ºä¸ç±»å‹ç³»ç»Ÿçš„äº¤å‰ç†è®ºæ¢è®¨
4. æŒç»­å®Œå–„å¤šæ¨¡æ€è¡¨è¾¾ä¸å¯è§†åŒ–
