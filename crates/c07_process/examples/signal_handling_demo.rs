//! ä¿¡å·å¤„ç†ç¤ºä¾‹
//!
//! æœ¬ç¤ºä¾‹å±•ç¤ºè¿›ç¨‹ä¿¡å·å¤„ç†çš„æ¦‚å¿µå’Œæœ€ä½³å®è·µï¼š
//! - ä¿¡å·ç±»å‹è¯´æ˜
//! - ä¿¡å·å¤„ç†ç­–ç•¥
//! - è·¨å¹³å°æ³¨æ„äº‹é¡¹
//!
//! æ³¨æ„ï¼šWindowsä¸æ”¯æŒUnixä¿¡å·ï¼Œæœ¬ç¤ºä¾‹ä¸»è¦å±•ç¤ºæ¦‚å¿µ
//!
//! è¿è¡Œæ–¹å¼:
//! ```bash
//! cargo run --example signal_handling_demo
//! ```

use c07_process::prelude::*;

fn main() -> Result<()> {
    println!("ğŸš€ ä¿¡å·å¤„ç†ç¤ºä¾‹\n");
    println!("{}", "=".repeat(60));

    // 1. ä¿¡å·ç±»å‹è¯´æ˜
    println!("\nğŸ“Š ä¿¡å·ç±»å‹è¯´æ˜:");
    println!("{}", "-".repeat(60));
    println!("  SIGTERM - ç»ˆæ­¢ä¿¡å·ï¼ˆå¯æ•è·ï¼‰");
    println!("  SIGKILL - å¼ºåˆ¶ç»ˆæ­¢ï¼ˆä¸å¯æ•è·ï¼‰");
    println!("  SIGINT  - ä¸­æ–­ä¿¡å·ï¼ˆCtrl+Cï¼‰");
    println!("  SIGCHLD - å­è¿›ç¨‹çŠ¶æ€æ”¹å˜");
    println!("  SIGHUP  - æŒ‚èµ·ä¿¡å·");

    // 2. ä¿¡å·å¤„ç†ç­–ç•¥
    println!("\nğŸ“Š ä¿¡å·å¤„ç†ç­–ç•¥:");
    println!("{}", "-".repeat(60));
    println!("  1. ä½¿ç”¨ProcessManagerçš„kill()æ–¹æ³•å‘é€ä¿¡å·");
    println!("  2. åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½¿ç”¨signal-hookæˆ–ctrlcåº“å¤„ç†ä¿¡å·");
    println!("  3. ç¡®ä¿ä¿¡å·å¤„ç†å‡½æ•°æ˜¯async-signal-safeçš„");

    // 3. è¿›ç¨‹ç»ˆæ­¢ç¤ºä¾‹
    println!("\nğŸ“Š è¿›ç¨‹ç»ˆæ­¢ç¤ºä¾‹:");
    println!("{}", "-".repeat(60));
    let _pm = ProcessManager::new();

    // æ³¨æ„ï¼šè¿™é‡Œåªæ˜¯æ¼”ç¤ºAPIï¼Œå®é™…ä½¿ç”¨éœ€è¦å…ˆåˆ›å»ºè¿›ç¨‹
    println!("âœ… ProcessManageråˆ›å»ºæˆåŠŸ");
    println!("  ä½¿ç”¨ pm.kill(pid) å¯ä»¥å‘é€ç»ˆæ­¢ä¿¡å·");

    // 4. è·¨å¹³å°æ³¨æ„äº‹é¡¹
    println!("\nğŸ’¡ è·¨å¹³å°æ³¨æ„äº‹é¡¹:");
    println!("{}", "-".repeat(60));
    println!("  âš ï¸  Windowsä¸æ”¯æŒUnixä¿¡å·");
    println!("  âœ… Unix/Linux: ä½¿ç”¨killç³»ç»Ÿè°ƒç”¨");
    println!("  âœ… Windows: ä½¿ç”¨TerminateProcess API");
    println!("  âœ… C07åº“æä¾›äº†è·¨å¹³å°æŠ½è±¡");

    // 5. æœ€ä½³å®è·µ
    println!("\nğŸ’¡ æœ€ä½³å®è·µ:");
    println!("{}", "-".repeat(60));
    println!("  1. ä¼˜å…ˆä½¿ç”¨SIGTERMè€Œä¸æ˜¯SIGKILL");
    println!("  2. ç»™è¿›ç¨‹æ—¶é—´è¿›è¡Œæ¸…ç†å·¥ä½œ");
    println!("  3. ä½¿ç”¨è¶…æ—¶æœºåˆ¶é˜²æ­¢è¿›ç¨‹æ— æ³•ç»ˆæ­¢");
    println!("  4. è®°å½•ä¿¡å·å¤„ç†æ—¥å¿—ä¾¿äºè°ƒè¯•");

    println!("\nâœ… ä¿¡å·å¤„ç†æ¼”ç¤ºå®Œæˆï¼");

    Ok(())
}
