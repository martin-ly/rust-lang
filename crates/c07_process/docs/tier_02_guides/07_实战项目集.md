# âš™ï¸ C07: Process & System Programming - å®æˆ˜é¡¹ç›®é›†

> **åˆ›å»ºæ—¥æœŸ**: 2025-10-25
> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
> **é€‚ç”¨æ¨¡å—**: C07 è¿›ç¨‹å’Œç³»ç»Ÿç¼–ç¨‹
> **ç›®æ ‡**: é€šè¿‡å®æˆ˜é¡¹ç›®æŒæ¡è¿›ç¨‹ç®¡ç†å’Œç³»ç»Ÿç¼–ç¨‹

---

## ğŸ“ çŸ¥è¯†ç»“æ„

### æ¦‚å¿µå®šä¹‰

**å®æˆ˜é¡¹ç›®é›† (Practical Projects Collection)**:

- **å®šä¹‰**: æ”¶é›†å’Œç»„ç»‡çš„å®æˆ˜é¡¹ç›®é›†åˆï¼Œç”¨äºæ¼”ç¤ºè¿›ç¨‹ç®¡ç†å’Œç³»ç»Ÿç¼–ç¨‹çš„å®é™…åº”ç”¨
- **ç±»å‹**: é¡¹ç›®é›†åˆæ–‡æ¡£
- **èŒƒç•´**: ç³»ç»Ÿç¼–ç¨‹ã€é¡¹ç›®å®è·µ
- **ç‰ˆæœ¬**: Rust 1.0+
- **ç›¸å…³æ¦‚å¿µ**: è¿›ç¨‹ç®¡ç†ã€ç³»ç»Ÿç¼–ç¨‹ã€é¡¹ç›®å®è·µ

### å±æ€§ç‰¹å¾

**æ ¸å¿ƒå±æ€§**:

- **å±‚æ¬¡æ€§**: ä»ç®€å•åˆ°å¤æ‚çš„é¡¹ç›®
- **å®ç”¨æ€§**: è§£å†³å®é™…é—®é¢˜
- **å®Œæ•´æ€§**: æ¯ä¸ªé¡¹ç›®éƒ½æœ‰å®Œæ•´å®ç°
- **å¯è¿è¡Œæ€§**: æ‰€æœ‰é¡¹ç›®éƒ½å¯ä»¥è¿è¡Œ

### å…³ç³»è¿æ¥

**ç»„åˆå…³ç³»**:

- å®æˆ˜é¡¹ç›®é›† --[contains]--> å¤šä¸ªå®æˆ˜é¡¹ç›®
- å­¦ä¹ è·¯å¾„ --[uses]--> å®æˆ˜é¡¹ç›®é›†

**ä¾èµ–å…³ç³»**:

- å®æˆ˜é¡¹ç›®é›† --[depends-on]--> è¿›ç¨‹ç®¡ç†çŸ¥è¯†
- é¡¹ç›®å®è·µ --[depends-on]--> å®æˆ˜é¡¹ç›®é›†

### æ€ç»´å¯¼å›¾

```text
å®æˆ˜é¡¹ç›®é›†
â”‚
â”œâ”€â”€ å‘½ä»¤æ‰§è¡Œå™¨
â”‚   â””â”€â”€ Commandã€stdin/stdout
â”œâ”€â”€ ç®¡é“é€šä¿¡
â”‚   â””â”€â”€ Stdioã€è¿›ç¨‹é—´é€šä¿¡
â””â”€â”€ è¿›ç¨‹æ± ç®¡ç†å™¨
    â””â”€â”€ è¿›ç¨‹ç®¡ç†ã€é”™è¯¯å¤„ç†
```

---

## ğŸ“‹ é¡¹ç›®æ¦‚è§ˆ

| #   | é¡¹ç›®åç§°                            | éš¾åº¦   | é¢„è®¡æ—¶é—´ | æ ¸å¿ƒæ¦‚å¿µ              |
| :--- | :--- | :--- | :--- | :--- || 1   | [å‘½ä»¤æ‰§è¡Œå™¨](#é¡¹ç›®1-å‘½ä»¤æ‰§è¡Œå™¨)     | â­     | 1-2å°æ—¶  | Commandã€stdin/stdout |
| 2   | [ç®¡é“é€šä¿¡](#é¡¹ç›®2-ç®¡é“é€šä¿¡)         | â­â­   | 2-3å°æ—¶  | Stdioã€è¿›ç¨‹é—´é€šä¿¡     |
| 3   | [è¿›ç¨‹æ± ç®¡ç†å™¨](#é¡¹ç›®3-è¿›ç¨‹æ± ç®¡ç†å™¨) | â­â­â­ | 3-4å°æ—¶  | è¿›ç¨‹ç®¡ç†ã€é”™è¯¯å¤„ç†    |

---

## é¡¹ç›®1: å‘½ä»¤æ‰§è¡Œå™¨

### ğŸ“– é¡¹ç›®è¯´æ˜

**éš¾åº¦**: â­
**é¢„è®¡æ—¶é—´**: 1-2å°æ—¶

### æ ¸å¿ƒä»£ç 

```rust
use std::process::{Command, Stdio};
use std::io::{self, Write};

fn main() {
    println!("===== å‘½ä»¤æ‰§è¡Œå™¨ =====\n");

    loop {
        print!("$ ");
        io::stdout().flush().unwrap();

        let mut input = String::new();
        io::stdin().read_line(&mut input).unwrap();

        let input = input.trim();

        if input == "exit" {
            break;
        }

        let parts: Vec<&str> = input.split_whitespace().collect();
        if parts.is_empty() {
            continue;
        }

        let cmd = parts[0];
        let args = &parts[1..];

        match Command::new(cmd)
            .args(args)
            .stdout(Stdio::inherit())
            .stderr(Stdio::inherit())
            .spawn()
        {
            Ok(mut child) => {
                match child.wait() {
                    Ok(status) => {
                        println!("é€€å‡ºç : {}\n", status);
                    }
                    Err(e) => {
                        println!("âŒ ç­‰å¾…å¤±è´¥: {}\n", e);
                    }
                }
            }
            Err(e) => {
                println!("âŒ æ‰§è¡Œå¤±è´¥: {}\n", e);
            }
        }
    }
}
```

---

## é¡¹ç›®2: ç®¡é“é€šä¿¡

### ğŸ“– é¡¹ç›®è¯´æ˜2

**éš¾åº¦**: â­â­
**é¢„è®¡æ—¶é—´**: 2-3å°æ—¶

### æ ¸å¿ƒä»£ç 2

```rust
use std::process::{Command, Stdio};
use std::io::Write;

fn main() -> Result<(), Box<dyn std::error::Error>> {
    println!("===== ç®¡é“é€šä¿¡æµ‹è¯• =====\n");

    // ç¤ºä¾‹1: å‘è¿›ç¨‹å†™å…¥æ•°æ®
    {
        println!("ç¤ºä¾‹1: stdin å†™å…¥");

        let mut child = Command::new("grep")
            .arg("rust")
            .stdin(Stdio::piped())
            .stdout(Stdio::piped())
            .spawn()?;

        let stdin = child.stdin.as_mut().unwrap();
        stdin.write_all(b"hello world\n")?;
        stdin.write_all(b"rust programming\n")?;
        stdin.write_all(b"python code\n")?;

        let output = child.wait_with_output()?;
        println!("è¾“å‡º:\n{}\n", String::from_utf8_lossy(&output.stdout));
    }

    // ç¤ºä¾‹2: ç®¡é“é“¾
    {
        println!("ç¤ºä¾‹2: å‘½ä»¤ç®¡é“");

        let ps = Command::new("ps")
            .arg("aux")
            .stdout(Stdio::piped())
            .spawn()?;

        let grep = Command::new("grep")
            .arg("rust")
            .stdin(ps.stdout.unwrap())
            .stdout(Stdio::piped())
            .spawn()?;

        let output = grep.wait_with_output()?;
        println!("ç»“æœ:\n{}", String::from_utf8_lossy(&output.stdout));
    }

    Ok(())
}
```

---

## é¡¹ç›®3: è¿›ç¨‹æ± ç®¡ç†å™¨

### ğŸ“– é¡¹ç›®è¯´æ˜3

**éš¾åº¦**: â­â­â­
**é¢„è®¡æ—¶é—´**: 3-4å°æ—¶

### æ ¸å¿ƒä»£ç 3

```rust
use std::process::{Command, Child};
use std::collections::HashMap;
use std::io;

struct ProcessPool {
    processes: HashMap<String, Child>,
}

impl ProcessPool {
    fn new() -> Self {
        ProcessPool {
            processes: HashMap::new(),
        }
    }

    fn spawn(&mut self, name: String, cmd: &str, args: &[&str]) -> io::Result<()> {
        let child = Command::new(cmd)
            .args(args)
            .spawn()?;

        self.processes.insert(name, child);
        Ok(())
    }

    fn kill(&mut self, name: &str) -> io::Result<()> {
        if let Some(child) = self.processes.get_mut(name) {
            child.kill()?;
            println!("âŒ ç»ˆæ­¢è¿›ç¨‹: {}", name);
        }
        Ok(())
    }

    fn wait(&mut self, name: &str) -> io::Result<()> {
        if let Some(mut child) = self.processes.remove(name) {
            let status = child.wait()?;
            println!("âœ… è¿›ç¨‹ {} é€€å‡º: {}", name, status);
        }
        Ok(())
    }

    fn list(&self) {
        println!("å½“å‰è¿›ç¨‹:");
        for (name, child) in &self.processes {
            println!("  - {}: PID {}", name, child.id());
        }
    }
}

fn main() -> io::Result<()> {
    println!("===== è¿›ç¨‹æ± ç®¡ç†å™¨ =====\n");

    let mut pool = ProcessPool::new();

    // å¯åŠ¨å¤šä¸ªè¿›ç¨‹
    pool.spawn("sleep1".to_string(), "sleep", &["5"])?;
    pool.spawn("sleep2".to_string(), "sleep", &["10"])?;

    pool.list();

    // ç­‰å¾…è¿›ç¨‹
    pool.wait("sleep1")?;

    // ç»ˆæ­¢è¿›ç¨‹
    pool.kill("sleep2")?;

    Ok(())
}
```

---

## ğŸ“ æ€»ç»“

### å…³é”®æ¦‚å¿µ

| æ¦‚å¿µ       | é¡¹ç›®1  | é¡¹ç›®2  | é¡¹ç›®3  |
| :--- | :--- | :--- | :--- || Command    | âœ…âœ…âœ… | âœ…âœ…âœ… | âœ…âœ…âœ… |
| Stdio      | âœ…âœ…   | âœ…âœ…âœ… | âœ…     |
| è¿›ç¨‹ç®¡ç†   | âœ…     | âœ…âœ…   | âœ…âœ…âœ… |
| è¿›ç¨‹é—´é€šä¿¡ | âŒ     | âœ…âœ…âœ… | âœ…     |

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¥æœŸ**: 2025-10-25

**ğŸ¯ æŒæ¡è¿›ç¨‹ç®¡ç†ï¼Œæ„å»ºç³»ç»Ÿçº§åº”ç”¨ï¼ğŸ¦€**-
