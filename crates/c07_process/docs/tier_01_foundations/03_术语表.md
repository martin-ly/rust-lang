# Tier 1: C07 进程管理 - 术语表

> **文档类型**: 术语参考
> **适用版本**: Rust 1.90+
> **最后更新**: 2025-10-22

---

## 目录

- [Tier 1: C07 进程管理 - 术语表](#tier-1-c07-进程管理---术语表)
  - [目录](#目录)
  - [📋 术语索引](#-术语索引)
  - [核心术语](#核心术语)
    - [进程 (Process)](#进程-process)
    - [进程ID (PID)](#进程id-pid)
    - [父进程与子进程 (Parent \& Child Process)](#父进程与子进程-parent--child-process)
    - [进程状态 (Process State)](#进程状态-process-state)
    - [僵尸进程 (Zombie Process)](#僵尸进程-zombie-process)
    - [孤儿进程 (Orphan Process)](#孤儿进程-orphan-process)
  - [IPC 术语](#ipc-术语)
    - [进程间通信 (IPC)](#进程间通信-ipc)
    - [管道 (Pipe)](#管道-pipe)
    - [命名管道 (Named Pipe / FIFO)](#命名管道-named-pipe--fifo)
    - [共享内存 (Shared Memory)](#共享内存-shared-memory)
    - [消息队列 (Message Queue)](#消息队列-message-queue)
    - [Unix域套接字 (Unix Domain Socket)](#unix域套接字-unix-domain-socket)
  - [同步术语](#同步术语)
    - [互斥锁 (Mutex)](#互斥锁-mutex)
    - [读写锁 (RwLock)](#读写锁-rwlock)
    - [条件变量 (Condvar)](#条件变量-condvar)
    - [信号量 (Semaphore)](#信号量-semaphore)
    - [屏障 (Barrier)](#屏障-barrier)
  - [Unix/Linux 术语](#unixlinux-术语)
    - [Fork](#fork)
    - [Exec](#exec)
    - [信号 (Signal)](#信号-signal)
    - [进程组 (Process Group)](#进程组-process-group)
    - [会话 (Session)](#会话-session)
    - [守护进程 (Daemon)](#守护进程-daemon)
  - [Windows 术语](#windows-术语)
    - [CreateProcess](#createprocess)
    - [句柄 (Handle)](#句柄-handle)
    - [作业对象 (Job Object)](#作业对象-job-object)
  - [Rust 特定术语](#rust-特定术语)
    - [Command](#command)
    - [Child](#child)
    - [ExitStatus](#exitstatus)
    - [Stdio](#stdio)
  - [性能术语](#性能术语)
    - [上下文切换 (Context Switch)](#上下文切换-context-switch)
    - [零拷贝 (Zero-Copy)](#零拷贝-zero-copy)
    - [写时复制 (Copy-on-Write, COW)](#写时复制-copy-on-write-cow)
  - [🔗 相关资源](#-相关资源)

---

## 📋 术语索引

**快速跳转**: [核心](#核心术语) | [IPC](#ipc-术语) | [同步](#同步术语) | [Unix/Linux](#unixlinux-术语) | [Windows](#windows-术语) | [Rust](#rust-特定术语) | [性能](#性能术语)

---

## 核心术语

### 进程 (Process)

**定义**: 程序在操作系统中的一次执行实例，是资源分配和调度的基本单位。

**组成部分**:

- 代码段 (Text Segment)
- 数据段 (Data Segment)
- 堆 (Heap)
- 栈 (Stack)
- 文件描述符表
- 进程控制块 (PCB)

**Rust 示例**:

```rust
use std::process::Command;

let child = Command::new("ls").spawn()?;
println!("子进程 PID: {}", child.id());
```

**参考**: [进程模型参考](../tier_03_references/01_进程模型参考.md)

---

### 进程ID (PID)

**定义**: 操作系统为每个进程分配的唯一标识符。

**特点**:

- PID 1: 通常是 init 进程 (Unix/Linux)
- PID 可以重用（进程终止后）
- 父进程 PID (PPID): 创建该进程的父进程ID

**Rust 获取**:

```rust
use std::process;

// 当前进程 PID
let pid = process::id();
println!("当前进程: {}", pid);

// 子进程 PID
let child = Command::new("echo").spawn()?;
println!("子进程: {}", child.id());
```

---

### 父进程与子进程 (Parent & Child Process)

**定义**:

- **父进程**: 创建其他进程的进程
- **子进程**: 被其他进程创建的进程

**关系**:

- 子进程继承父进程的大部分属性
- 父进程负责回收子进程（调用 `wait()`）
- 父进程先退出，子进程成为孤儿进程

**Rust 示例**:

```rust
let mut child = Command::new("sleep")
    .arg("10")
    .spawn()?;

println!("父进程: {}", process::id());
println!("子进程: {}", child.id());

child.wait()?; // 父进程等待子进程
```

---

### 进程状态 (Process State)

**定义**: 进程在生命周期中的不同阶段。

**主要状态**:

1. **Running (运行)**: 正在 CPU 上执行
2. **Ready (就绪)**: 等待 CPU 调度
3. **Blocked (阻塞)**: 等待 I/O 或事件
4. **Zombie (僵尸)**: 已终止但未被回收
5. **Stopped (停止)**: 被信号暂停

**状态转换**:

```text
创建 → 就绪 → 运行 → 阻塞
              ↓
            终止 → 僵尸 → 回收
```

---

### 僵尸进程 (Zombie Process)

**定义**: 已终止但父进程未读取其退出状态的进程。

**特征**:

- 进程已结束执行
- 保留进程表项（PID、退出状态）
- 不占用 CPU 和内存
- 数量过多会耗尽 PID

**避免方法**:

```rust
// 方法1: 使用 wait()
let mut child = Command::new("app").spawn()?;
child.wait()?; // 回收子进程

// 方法2: 使用 try_wait() 非阻塞
loop {
    match child.try_wait() {
        Ok(Some(status)) => break, // 已结束，已回收
        Ok(None) => { /* 仍在运行 */ }
        Err(e) => return Err(e),
    }
}
```

**参考**: [常见问题 - 僵尸进程](./04_常见问题.md#q4-如何避免和处理僵尸进程)

---

### 孤儿进程 (Orphan Process)

**定义**: 父进程先于子进程退出，子进程被 init (PID 1) 收养。

**特点**:

- 自动被 init 进程收养
- init 会自动回收（不会成为僵尸）
- 守护进程通常是故意创建的孤儿进程

**示例场景**:

```rust
// 父进程创建子进程后立即退出
let child = Command::new("long_running_task").spawn()?;
// 父进程退出，child 成为孤儿进程
```

---

## IPC 术语

### 进程间通信 (IPC)

**定义**: 不同进程之间交换数据和信息的机制。

**常见 IPC 类型**:

1. **管道** (Pipe)
2. **命名管道** (Named Pipe / FIFO)
3. **消息队列** (Message Queue)
4. **共享内存** (Shared Memory)
5. **信号** (Signal)
6. **套接字** (Socket)
7. **内存映射文件** (Memory-Mapped File)

**选择标准**:

- **简单**: 管道
- **高性能**: 共享内存
- **跨网络**: Socket
- **灵活**: 消息队列

**参考**: [IPC通信实践](../tier_02_guides/02_IPC通信实践.md)

---

### 管道 (Pipe)

**定义**: 单向数据流通道，用于父子进程或相关进程间通信。

**特点**:

- 半双工（单向）
- 缓冲区有限（通常 64KB）
- 数据按 FIFO 顺序传递
- 匿名（只能亲缘进程使用）

**Rust 示例**:

```rust
use std::process::{Command, Stdio};
use std::io::Write;

let mut child = Command::new("cat")
    .stdin(Stdio::piped())
    .stdout(Stdio::piped())
    .spawn()?;

// 写入数据到子进程
if let Some(mut stdin) = child.stdin.take() {
    stdin.write_all(b"Hello, Pipe!")?;
}

// 读取子进程输出
let output = child.wait_with_output()?;
println!("{}", String::from_utf8_lossy(&output.stdout));
```

---

### 命名管道 (Named Pipe / FIFO)

**定义**: 有名字的管道，允许无亲缘关系的进程通信。

**特点**:

- 在文件系统中有路径
- 持久化（创建后可重复使用）
- 仍然是单向通信

**Unix 示例**:

```rust
#[cfg(unix)]
use nix::unistd::mkfifo;
use nix::sys::stat::Mode;
use std::path::Path;

// 创建命名管道
mkfifo(Path::new("/tmp/my_pipe"), Mode::S_IRWXU)?;

// 进程A写入
let mut file = File::create("/tmp/my_pipe")?;
file.write_all(b"data")?;

// 进程B读取
let mut file = File::open("/tmp/my_pipe")?;
let mut buf = String::new();
file.read_to_string(&mut buf)?;
```

---

### 共享内存 (Shared Memory)

**定义**: 多个进程可以访问的同一块物理内存区域。

**特点**:

- **最快的 IPC 方式**（无数据拷贝）
- 需要同步机制（信号量、互斥锁）
- 跨平台实现复杂

**Rust 实现**:

```rust
use shared_memory::*;

// 创建共享内存
let shmem = ShmemConf::new()
    .size(4096)
    .flink("my_shmem")
    .create()?;

// 写入数据
unsafe {
    let ptr = shmem.as_ptr() as *mut u8;
    *ptr = 42;
}

// 其他进程打开并读取
let shmem = ShmemConf::new()
    .flink("my_shmem")
    .open()?;
```

**参考**: [IPC机制参考](../tier_03_references/02_IPC机制参考.md)

---

### 消息队列 (Message Queue)

**定义**: 存储在内核中的消息链表，进程可以发送和接收消息。

**特点**:

- 异步通信
- 消息有优先级
- 持久化（进程退出后仍存在）
- 跨平台支持有限

---

### Unix域套接字 (Unix Domain Socket)

**定义**: 在同一主机上进程间通信的套接字。

**优势**:

- 比网络套接字快
- 支持双向通信
- 可传递文件描述符

**Rust 示例**:

```rust
use std::os::unix::net::{UnixStream, UnixListener};

// 服务端
let listener = UnixListener::bind("/tmp/my.sock")?;
let (stream, _) = listener.accept()?;

// 客户端
let mut stream = UnixStream::connect("/tmp/my.sock")?;
stream.write_all(b"hello")?;
```

---

## 同步术语

### 互斥锁 (Mutex)

**定义**: 确保同一时刻只有一个线程/进程访问临界区。

**Rust 示例**:

```rust
use std::sync::{Arc, Mutex};

let data = Arc::new(Mutex::new(0));
let guard = data.lock().unwrap();
// 临界区
drop(guard); // 释放锁
```

---

### 读写锁 (RwLock)

**定义**: 允许多个读者或一个写者访问的锁。

---

### 条件变量 (Condvar)

**定义**: 线程间同步的机制，等待某个条件成立。

---

### 信号量 (Semaphore)

**定义**: 控制对有限资源的访问计数器。

---

### 屏障 (Barrier)

**定义**: 等待多个线程/进程到达同一点后一起继续。

**参考**: [同步原语参考](../tier_03_references/04_同步原语参考.md)

---

## Unix/Linux 术语

### Fork

**定义**: Unix 系统调用，创建当前进程的完整副本（子进程）。

**返回值**:

- 父进程: 子进程 PID
- 子进程: 0

**示例**:

```rust
#[cfg(unix)]
use nix::unistd::fork;

match unsafe { fork() }? {
    ForkResult::Parent { child } => {
        println!("父进程，子PID: {}", child);
    }
    ForkResult::Child => {
        println!("子进程");
    }
}
```

---

### Exec

**定义**: 用新程序替换当前进程的内存空间。

---

### 信号 (Signal)

**定义**: Unix/Linux 中进程间异步通知机制。

**常见信号**:

- `SIGTERM` (15): 优雅终止
- `SIGKILL` (9): 强制终止
- `SIGINT` (2): 中断 (Ctrl+C)
- `SIGCHLD` (17): 子进程状态变化

---

### 进程组 (Process Group)

**定义**: 一组相关进程的集合，可以一起接收信号。

---

### 会话 (Session)

**定义**: 一个或多个进程组的集合。

---

### 守护进程 (Daemon)

**定义**: 在后台运行的长期服务进程，不与任何终端关联。

---

## Windows 术语

### CreateProcess

**定义**: Windows 创建进程的 API（等价于 Unix 的 fork+exec）。

---

### 句柄 (Handle)

**定义**: Windows 中引用对象（进程、线程、文件）的不透明标识符。

---

### 作业对象 (Job Object)

**定义**: Windows 进程组管理机制。

---

## Rust 特定术语

### Command

**定义**: Rust 标准库中用于创建进程的构建器。

```rust
use std::process::Command;

let output = Command::new("ls")
    .arg("-la")
    .output()?;
```

---

### Child

**定义**: 代表已启动的子进程。

---

### ExitStatus

**定义**: 进程的退出状态。

---

### Stdio

**定义**: 配置子进程的标准 I/O。

---

## 性能术语

### 上下文切换 (Context Switch)

**定义**: CPU 从一个进程切换到另一个进程。

**开销**: 保存/恢复寄存器、切换内存映射。

---

### 零拷贝 (Zero-Copy)

**定义**: 数据在内存中移动时不进行拷贝。

---

### 写时复制 (Copy-on-Write, COW)

**定义**: Fork 时内存页面共享，只在写入时才复制。

---

## 🔗 相关资源

- [项目概览](./01_项目概览.md)
- [主索引导航](./02_主索引导航.md)
- [常见问题](./04_常见问题.md)
- [IPC通信实践](../tier_02_guides/02_IPC通信实践.md)

---

**文档维护**: Documentation Team
**创建日期**: 2025-10-22
**适用版本**: Rust 1.90+
