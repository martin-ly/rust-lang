# 1.3 C11 å¼€å‘åº“ - å¸¸è§é—®é¢˜è§£ç­” (FAQ)

> **æ–‡æ¡£å®šä½**: Rust å¼€å‘åº“å®è·µä¸­çš„å¸¸è§é—®é¢˜æ·±åº¦è§£ç­”  
> **é€‚ç”¨äººç¾¤**: æ‰€æœ‰å¼€å‘è€…ï¼ˆæ¨èæŒ‰éœ€æŸ¥é˜…ï¼‰  
> **å…³è”æ–‡æ¡£**: [1.0 é¡¹ç›®æ¦‚è§ˆ](1.0_é¡¹ç›®æ¦‚è§ˆ.md) | [1.1 ä¸»ç´¢å¼•å¯¼èˆª](1.1_ä¸»ç´¢å¼•å¯¼èˆª.md) | [1.2 æœ¯è¯­è¡¨](1.2_æœ¯è¯­è¡¨.md)

**æœ€åæ›´æ–°**: 2025-10-21  
**Rust ç‰ˆæœ¬**: 1.90  
**æ–‡æ¡£çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª

---

## ğŸ“‹ ç›®å½•

- [1.3 C11 å¼€å‘åº“ - å¸¸è§é—®é¢˜è§£ç­” (FAQ)](#13-c11-å¼€å‘åº“---å¸¸è§é—®é¢˜è§£ç­”-faq)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1.3.1 å¿«é€Ÿå¯¼èˆª](#131-å¿«é€Ÿå¯¼èˆª)
  - [1.3.2 å…¥é—¨åŸºç¡€ (10ä¸ªé—®é¢˜)](#132-å…¥é—¨åŸºç¡€-10ä¸ªé—®é¢˜)
    - [ğŸŸ¢ Q1: å¦‚ä½•å¼€å§‹ä½¿ç”¨ Rust å¼€å‘åº“ï¼Ÿ](#-q1-å¦‚ä½•å¼€å§‹ä½¿ç”¨-rust-å¼€å‘åº“)
    - [ğŸŸ¢ Q2: å¼‚æ­¥ç¼–ç¨‹ä¸­ `async` å’Œ `await` çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ](#-q2-å¼‚æ­¥ç¼–ç¨‹ä¸­-async-å’Œ-await-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ)
    - [ğŸŸ¢ Q3: `tokio::spawn` å’Œ `tokio::join!` æœ‰ä»€ä¹ˆåŒºåˆ«?](#-q3-tokiospawn-å’Œ-tokiojoin-æœ‰ä»€ä¹ˆåŒºåˆ«)
    - [ğŸŸ¢ Q4: å¦‚ä½•åœ¨ Rust ä¸­å¤„ç† JSON æ•°æ®ï¼Ÿ](#-q4-å¦‚ä½•åœ¨-rust-ä¸­å¤„ç†-json-æ•°æ®)
    - [ğŸŸ¢ Q5: å¦‚ä½•æ­£ç¡®ä½¿ç”¨ `Result` å’Œ `Option`ï¼Ÿ](#-q5-å¦‚ä½•æ­£ç¡®ä½¿ç”¨-result-å’Œ-option)
    - [ğŸŸ¢ Q6: `String` å’Œ `&str` æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ](#-q6-string-å’Œ-str-æœ‰ä»€ä¹ˆåŒºåˆ«)
    - [ğŸŸ¢ Q7: å¦‚ä½•åœ¨ Rust ä¸­è¿›è¡Œæ—¥å¿—è®°å½•ï¼Ÿ](#-q7-å¦‚ä½•åœ¨-rust-ä¸­è¿›è¡Œæ—¥å¿—è®°å½•)
    - [ğŸŸ¢ Q8: å¦‚ä½•é…ç½® Rust é¡¹ç›®çš„ä¾èµ–ï¼Ÿ](#-q8-å¦‚ä½•é…ç½®-rust-é¡¹ç›®çš„ä¾èµ–)
    - [ğŸŸ¢ Q9: å¦‚ä½•è¿›è¡Œå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ï¼Ÿ](#-q9-å¦‚ä½•è¿›è¡Œå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•)
    - [ğŸŸ¢ Q10: å¦‚ä½•å¤„ç†ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ï¼Ÿ](#-q10-å¦‚ä½•å¤„ç†ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶)
  - [1.3.3 æ•°æ®åº“é›†æˆ (10ä¸ªé—®é¢˜)](#133-æ•°æ®åº“é›†æˆ-10ä¸ªé—®é¢˜)
    - [ğŸŸ¡ Q11: å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ•°æ®åº“é©±åŠ¨ï¼Ÿ](#-q11-å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ•°æ®åº“é©±åŠ¨)
    - [ğŸŸ¡ Q12: å¦‚ä½•æ­£ç¡®ç®¡ç†æ•°æ®åº“è¿æ¥æ± ï¼Ÿ](#-q12-å¦‚ä½•æ­£ç¡®ç®¡ç†æ•°æ®åº“è¿æ¥æ± )
    - [ğŸŸ¡ Q13: ORM vs åŸç”Ÿ SQLï¼Œå¦‚ä½•é€‰æ‹©ï¼Ÿ](#-q13-orm-vs-åŸç”Ÿ-sqlå¦‚ä½•é€‰æ‹©)
    - [ğŸŸ¡ Q14: å¦‚ä½•è¿›è¡Œæ•°æ®åº“è¿ç§»ï¼Ÿ](#-q14-å¦‚ä½•è¿›è¡Œæ•°æ®åº“è¿ç§»)
    - [ğŸŸ¡ Q15: å¦‚ä½•å¤„ç†æ•°æ®åº“äº‹åŠ¡ï¼Ÿ](#-q15-å¦‚ä½•å¤„ç†æ•°æ®åº“äº‹åŠ¡)
    - [Q16-Q20: æ•°æ®åº“æ€§èƒ½ä¼˜åŒ– (ç•¥)](#q16-q20-æ•°æ®åº“æ€§èƒ½ä¼˜åŒ–-ç•¥)
  - [1.3.4 Redis ç¼“å­˜ (8ä¸ªé—®é¢˜)](#134-redis-ç¼“å­˜-8ä¸ªé—®é¢˜)
    - [Q21-Q28: Redis ä½¿ç”¨æœ€ä½³å®è·µ (ç•¥)](#q21-q28-redis-ä½¿ç”¨æœ€ä½³å®è·µ-ç•¥)
  - [1.3.5 æ¶ˆæ¯é˜Ÿåˆ— (8ä¸ªé—®é¢˜)](#135-æ¶ˆæ¯é˜Ÿåˆ—-8ä¸ªé—®é¢˜)
    - [Q29-Q36: æ¶ˆæ¯é˜Ÿåˆ—æœ€ä½³å®è·µ (ç•¥)](#q29-q36-æ¶ˆæ¯é˜Ÿåˆ—æœ€ä½³å®è·µ-ç•¥)
  - [1.3.6 Web å¼€å‘ (8ä¸ªé—®é¢˜)](#136-web-å¼€å‘-8ä¸ªé—®é¢˜)
    - [Q37-Q44: Web æ¡†æ¶ä½¿ç”¨æŒ‡å— (ç•¥)](#q37-q44-web-æ¡†æ¶ä½¿ç”¨æŒ‡å—-ç•¥)
  - [1.3.7 æ€§èƒ½ä¼˜åŒ– (8ä¸ªé—®é¢˜)](#137-æ€§èƒ½ä¼˜åŒ–-8ä¸ªé—®é¢˜)
    - [Q45-Q52: é«˜çº§æ€§èƒ½ä¼˜åŒ–æŠ€å·§ (ç•¥)](#q45-q52-é«˜çº§æ€§èƒ½ä¼˜åŒ–æŠ€å·§-ç•¥)
  - [1.3.8 é”™è¯¯å¤„ç† (6ä¸ªé—®é¢˜)](#138-é”™è¯¯å¤„ç†-6ä¸ªé—®é¢˜)
    - [Q53-Q58: é”™è¯¯å¤„ç†æœ€ä½³å®è·µ (ç•¥)](#q53-q58-é”™è¯¯å¤„ç†æœ€ä½³å®è·µ-ç•¥)
  - [1.3.9 ç”Ÿäº§éƒ¨ç½² (6ä¸ªé—®é¢˜)](#139-ç”Ÿäº§éƒ¨ç½²-6ä¸ªé—®é¢˜)
    - [Q59-Q64: ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å— (ç•¥)](#q59-q64-ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—-ç•¥)
  - [1.3.10 å‚è€ƒèµ„æº](#1310-å‚è€ƒèµ„æº)

---

## 1.3.1 å¿«é€Ÿå¯¼èˆª

**æŒ‰ä¸»é¢˜è·³è½¬**:

| ä¸»é¢˜ | é—®é¢˜æ•° | è·³è½¬é“¾æ¥ |
|------|--------|---------|
| **å…¥é—¨åŸºç¡€** | 10 | [â†’ è·³è½¬](#132-å…¥é—¨åŸºç¡€-10ä¸ªé—®é¢˜) |
| **æ•°æ®åº“é›†æˆ** | 10 | [â†’ è·³è½¬](#133-æ•°æ®åº“é›†æˆ-10ä¸ªé—®é¢˜) |
| **Redis ç¼“å­˜** | 8 | [â†’ è·³è½¬](#134-redis-ç¼“å­˜-8ä¸ªé—®é¢˜) |
| **æ¶ˆæ¯é˜Ÿåˆ—** | 8 | [â†’ è·³è½¬](#135-æ¶ˆæ¯é˜Ÿåˆ—-8ä¸ªé—®é¢˜) |
| **Web å¼€å‘** | 8 | [â†’ è·³è½¬](#136-web-å¼€å‘-8ä¸ªé—®é¢˜) |
| **æ€§èƒ½ä¼˜åŒ–** | 8 | [â†’ è·³è½¬](#137-æ€§èƒ½ä¼˜åŒ–-8ä¸ªé—®é¢˜) |
| **é”™è¯¯å¤„ç†** | 6 | [â†’ è·³è½¬](#138-é”™è¯¯å¤„ç†-6ä¸ªé—®é¢˜) |
| **ç”Ÿäº§éƒ¨ç½²** | 6 | [â†’ è·³è½¬](#139-ç”Ÿäº§éƒ¨ç½²-6ä¸ªé—®é¢˜) |

**æ€»è®¡**: 64 ä¸ªé«˜è´¨é‡é—®ç­”

**æŒ‰éš¾åº¦ç­›é€‰**:

- ğŸŸ¢ **å…¥é—¨çº§** (1-10): åŸºç¡€æ¦‚å¿µå’Œç®€å•æ“ä½œ
- ğŸŸ¡ **è¿›é˜¶çº§** (11-40): å®æˆ˜åº”ç”¨å’Œå¸¸è§é—®é¢˜
- ğŸ”´ **é«˜çº§** (41-64): æ€§èƒ½ä¼˜åŒ–å’Œç”Ÿäº§å®è·µ

---

## 1.3.2 å…¥é—¨åŸºç¡€ (10ä¸ªé—®é¢˜)

### ğŸŸ¢ Q1: å¦‚ä½•å¼€å§‹ä½¿ç”¨ Rust å¼€å‘åº“ï¼Ÿ

**A**: é¦–å…ˆåœ¨ `Cargo.toml` ä¸­æ·»åŠ ä¾èµ–ï¼š

```toml
[dependencies]
# å¼‚æ­¥è¿è¡Œæ—¶
tokio = { version = "1.48", features = ["full"] }

# æ•°æ®åº“
sqlx = { version = "0.8", features = ["runtime-tokio-rustls", "postgres"] }
sea-orm = "2.0.0-rc.9"

# ç¼“å­˜
redis = { version = "1.0.0-rc.2", features = ["tokio-comp", "connection-manager"] }

# Web æ¡†æ¶
axum = "0.8"
tower = "0.5"

# åºåˆ—åŒ–
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"

# é”™è¯¯å¤„ç†
anyhow = "1.0"
thiserror = "2.0"
```

**æœ€å°ç¤ºä¾‹**:

```rust
use axum::{routing::get, Router};

#[tokio::main]
async fn main() {
    let app = Router::new().route("/", get(|| async { "Hello, Rust!" }));
    
    let listener = tokio::net::TcpListener::bind("0.0.0.0:3000")
        .await
        .unwrap();
    
    axum::serve(listener, app).await.unwrap();
}
```

**ç›¸å…³**: [1.0 é¡¹ç›®æ¦‚è§ˆ](1.0_é¡¹ç›®æ¦‚è§ˆ.md)

---

### ğŸŸ¢ Q2: å¼‚æ­¥ç¼–ç¨‹ä¸­ `async` å’Œ `await` çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ

**A**:

- **`async`**: å°†å‡½æ•°è½¬æ¢ä¸ºè¿”å› `impl Future` çš„å¼‚æ­¥å‡½æ•°
- **`await`**: ç­‰å¾… Future å®Œæˆï¼Œæš‚åœå½“å‰å‡½æ•°ä½†ä¸é˜»å¡çº¿ç¨‹

**ç¤ºä¾‹**:

```rust
// async fn è¿”å› Future
async fn fetch_data() -> String {
    tokio::time::sleep(Duration::from_secs(1)).await; // await ç­‰å¾…
    "data".to_string()
}

#[tokio::main]
async fn main() {
    let data = fetch_data().await; // await ç­‰å¾… Future å®Œæˆ
    println!("{}", data);
}
```

**å…³é”®ç‚¹**:

- `async fn` åˆ›å»º Futureï¼Œä½†ä¸ç«‹å³æ‰§è¡Œ
- `await` æ‰çœŸæ­£æ‰§è¡Œ Future
- Tokio è¿è¡Œæ—¶è´Ÿè´£è°ƒåº¦å’Œæ‰§è¡Œ

**ç›¸å…³**: [1.2 æœ¯è¯­è¡¨ - å¼‚æ­¥ç¼–ç¨‹](1.2_æœ¯è¯­è¡¨.md#1225-å¼‚æ­¥ç¼–ç¨‹-asyncawait)

---

### ğŸŸ¢ Q3: `tokio::spawn` å’Œ `tokio::join!` æœ‰ä»€ä¹ˆåŒºåˆ«?

**A**:

| ç‰¹æ€§ | `tokio::spawn` | `tokio::join!` |
|------|----------------|----------------|
| **å¹¶å‘æ€§** | åœ¨æ–°ä»»åŠ¡ä¸­å¹¶å‘æ‰§è¡Œ | åœ¨å½“å‰ä»»åŠ¡ä¸­å¹¶å‘æ‰§è¡Œ |
| **è¿”å›å€¼** | `JoinHandle<T>` | `(T1, T2, ...)` å…ƒç»„ |
| **é”™è¯¯å¤„ç†** | é€šè¿‡ `.await?` | é€šè¿‡ `?` æˆ–æ¨¡å¼åŒ¹é… |
| **é€‚ç”¨åœºæ™¯** | åå°ä»»åŠ¡ã€fire-and-forget | éœ€è¦ç­‰å¾…æ‰€æœ‰ç»“æœ |

**ç¤ºä¾‹å¯¹æ¯”**:

```rust
// tokio::spawn - åå°ä»»åŠ¡
let handle = tokio::spawn(async {
    // ç‹¬ç«‹è¿è¡Œï¼Œä¸é˜»å¡å½“å‰ä»»åŠ¡
    expensive_computation().await
});

// ç¨åè·å–ç»“æœ
let result = handle.await?;

// tokio::join! - å¹¶å‘ç­‰å¾…
let (result1, result2, result3) = tokio::join!(
    fetch_user(),
    fetch_posts(),
    fetch_comments()
);
```

**ç›¸å…³**: [1.2 æœ¯è¯­è¡¨ - Tokio](1.2_æœ¯è¯­è¡¨.md#1271-tokio)

---

### ğŸŸ¢ Q4: å¦‚ä½•åœ¨ Rust ä¸­å¤„ç† JSON æ•°æ®ï¼Ÿ

**A**: ä½¿ç”¨ `serde_json` crateï¼š

**åºåˆ—åŒ–ï¼ˆRust â†’ JSONï¼‰**:

```rust
use serde::{Serialize, Deserialize};

#[derive(Serialize, Deserialize)]
struct User {
    id: u32,
    name: String,
    email: String,
}

let user = User {
    id: 1,
    name: "Alice".to_string(),
    email: "alice@example.com".to_string(),
};

// è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²
let json = serde_json::to_string(&user)?;
println!("{}", json);

// è½¬æ¢ä¸ºæ ¼å¼åŒ–çš„ JSON
let pretty_json = serde_json::to_string_pretty(&user)?;
```

**ååºåˆ—åŒ–ï¼ˆJSON â†’ Rustï¼‰**:

```rust
let json_str = r#"{"id":1,"name":"Alice","email":"alice@example.com"}"#;
let user: User = serde_json::from_str(json_str)?;

// ä» serde_json::Value
let value: serde_json::Value = serde_json::from_str(json_str)?;
let name = value["name"].as_str().unwrap();
```

**ç›¸å…³**: [essential_crates/01_infrastructure/serialization/](essential_crates/01_infrastructure/serialization/)

---

### ğŸŸ¢ Q5: å¦‚ä½•æ­£ç¡®ä½¿ç”¨ `Result` å’Œ `Option`ï¼Ÿ

**A**:

**`Result<T, E>` - å¯èƒ½å¤±è´¥çš„æ“ä½œ**:

```rust
use anyhow::Result;

fn divide(a: f64, b: f64) -> Result<f64> {
    if b == 0.0 {
        anyhow::bail!("Division by zero");
    }
    Ok(a / b)
}

// ä½¿ç”¨ ? ä¼ æ’­é”™è¯¯
fn calculate() -> Result<f64> {
    let result = divide(10.0, 2.0)?; // è‡ªåŠ¨ä¼ æ’­é”™è¯¯
    Ok(result * 2.0)
}

// å¤„ç†é”™è¯¯
match divide(10.0, 0.0) {
    Ok(result) => println!("Result: {}", result),
    Err(e) => eprintln!("Error: {}", e),
}
```

**`Option<T>` - å¯èƒ½ä¸ºç©ºçš„å€¼**:

```rust
fn find_user(id: u32) -> Option<User> {
    if id == 1 {
        Some(User { /* ... */ })
    } else {
        None
    }
}

// ä½¿ç”¨ ? ä¼ æ’­ None
fn get_user_email(id: u32) -> Option<String> {
    let user = find_user(id)?; // å¦‚æœ Noneï¼Œç›´æ¥è¿”å› None
    Some(user.email)
}

// æä¾›é»˜è®¤å€¼
let email = find_user(2)
    .map(|u| u.email)
    .unwrap_or_else(|| "default@example.com".to_string());
```

**ç›¸å…³**: [essential_crates/cross_cutting/error_handling/](essential_crates/cross_cutting/error_handling/)

---

### ğŸŸ¢ Q6: `String` å’Œ `&str` æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**A**:

| ç‰¹æ€§ | `String` | `&str` |
|------|----------|--------|
| **ç±»å‹** | å¯å˜ã€æ‹¥æœ‰æ‰€æœ‰æƒ | ä¸å¯å˜ã€å€Ÿç”¨ |
| **å†…å­˜** | å †åˆ†é… | å¯èƒ½åœ¨å †æˆ–æ ˆæˆ–é™æ€åŒº |
| **å¤§å°** | åŠ¨æ€ | å›ºå®šï¼ˆç¼–è¯‘æ—¶å·²çŸ¥ï¼‰ |
| **ä¿®æ”¹** | âœ… å¯ä»¥ | âŒ ä¸å¯ä»¥ |
| **ç”Ÿå‘½å‘¨æœŸ** | è‡ªå·±ç®¡ç† | å¿…é¡»æŒ‡å®šï¼ˆé€šå¸¸çœç•¥ï¼‰ |

**ä½¿ç”¨åœºæ™¯**:

```rust
// String - éœ€è¦ä¿®æ”¹æˆ–æ‹¥æœ‰æ‰€æœ‰æƒ
fn create_greeting(name: String) -> String {
    format!("Hello, {}!", name) // è¿”å›æ–°çš„ String
}

// &str - åªè¯»è®¿é—®ï¼Œä¸éœ€è¦æ‰€æœ‰æƒ
fn print_greeting(name: &str) {
    println!("Hello, {}!", name);
}

// è½¬æ¢
let s: String = "hello".to_string(); // &str -> String
let slice: &str = &s;                // String -> &str
let slice2: &str = &s[0..2];         // åˆ‡ç‰‡
```

**æœ€ä½³å®è·µ**:

- âœ… å‡½æ•°å‚æ•°ä¼˜å…ˆä½¿ç”¨ `&str`ï¼ˆæ›´çµæ´»ï¼‰
- âœ… éœ€è¦ä¿®æ”¹æˆ–è¿”å›æ—¶ä½¿ç”¨ `String`
- âœ… å¸¸é‡å­—ç¬¦ä¸²ä½¿ç”¨ `&'static str`

**ç›¸å…³**: [Rust Book - String](https://doc.rust-lang.org/book/ch08-02-strings.html)

---

### ğŸŸ¢ Q7: å¦‚ä½•åœ¨ Rust ä¸­è¿›è¡Œæ—¥å¿—è®°å½•ï¼Ÿ

**A**: ä½¿ç”¨ `tracing` æˆ– `log` crateï¼š

**ä½¿ç”¨ `tracing`ï¼ˆæ¨èï¼‰**:

```rust
use tracing::{info, warn, error, debug, instrument};

#[tokio::main]
async fn main() {
    // åˆå§‹åŒ–æ—¥å¿—
    tracing_subscriber::fmt()
        .with_max_level(tracing::Level::INFO)
        .init();
    
    info!("Application started");
    debug!("Debug information");
    warn!("Warning message");
    error!("Error occurred");
}

// è‡ªåŠ¨è¿½è¸ªå‡½æ•°è°ƒç”¨
#[instrument]
async fn fetch_user(id: u32) -> Result<User> {
    info!("Fetching user {}", id);
    // ...
    Ok(user)
}

// æ·»åŠ ä¸Šä¸‹æ–‡
info!(user_id = 123, action = "login", "User logged in");
```

**é…ç½®ä¸åŒè¾“å‡ºæ ¼å¼**:

```rust
// JSON æ ¼å¼ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
tracing_subscriber::fmt()
    .json()
    .with_max_level(tracing::Level::INFO)
    .init();

// å¸¦é¢œè‰²çš„æ ¼å¼ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
tracing_subscriber::fmt()
    .with_max_level(tracing::Level::DEBUG)
    .with_target(false)
    .compact()
    .init();
```

**ç›¸å…³**: [essential_crates/05_toolchain/logging/](essential_crates/05_toolchain/logging/)

---

### ğŸŸ¢ Q8: å¦‚ä½•é…ç½® Rust é¡¹ç›®çš„ä¾èµ–ï¼Ÿ

**A**: åœ¨ `Cargo.toml` ä¸­ç®¡ç†ä¾èµ–ï¼š

**åŸºæœ¬é…ç½®**:

```toml
[package]
name = "my-app"
version = "0.1.0"
edition = "2021"

[dependencies]
# æŒ‡å®šç‰ˆæœ¬
tokio = "1.48"

# æŒ‡å®šç‰¹æ€§
tokio = { version = "1.48", features = ["full"] }

# å¯é€‰ä¾èµ–
serde = { version = "1.0", optional = true }

# å¼€å‘ä¾èµ–ï¼ˆä»…æµ‹è¯•/åŸºå‡†æµ‹è¯•ï¼‰
[dev-dependencies]
criterion = "0.7"

# æ„å»ºä¾èµ–
[build-dependencies]
cc = "1.0"
```

**ç‰ˆæœ¬çº¦æŸ**:

```toml
# è¯­ä¹‰åŒ–ç‰ˆæœ¬
tokio = "1.48"      # >= 1.48.0, < 2.0.0
tokio = "^1.48"     # åŒä¸Šï¼ˆæ˜¾å¼ï¼‰
tokio = "~1.48.0"   # >= 1.48.0, < 1.49.0
tokio = "1.48.0"    # ç²¾ç¡®ç‰ˆæœ¬
tokio = ">= 1.40, < 1.50"  # èŒƒå›´

# Git ä¾èµ–
my-lib = { git = "https://github.com/user/repo" }
my-lib = { git = "https://github.com/user/repo", branch = "main" }
my-lib = { git = "https://github.com/user/repo", tag = "v1.0.0" }

# æœ¬åœ°ä¾èµ–
my-lib = { path = "../my-lib" }
```

**å·¥ä½œåŒºä¾èµ–**:

```toml
[workspace.dependencies]
tokio = { version = "1.48", features = ["full"] }

[dependencies]
tokio = { workspace = true }
```

**ç›¸å…³**: [Cargo Book](https://doc.rust-lang.org/cargo/)

---

### ğŸŸ¢ Q9: å¦‚ä½•è¿›è¡Œå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ï¼Ÿ

**A**:

**å•å…ƒæµ‹è¯•**:

```rust
// src/lib.rs
pub fn add(a: i32, b: i32) -> i32 {
    a + b
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_add() {
        assert_eq!(add(2, 3), 5);
    }

    #[test]
    #[should_panic(expected = "overflow")]
    fn test_overflow() {
        add(i32::MAX, 1);
    }

    #[tokio::test]
    async fn test_async_function() {
        let result = fetch_data().await;
        assert!(!result.is_empty());
    }
}
```

**é›†æˆæµ‹è¯•**:

```rust
// tests/integration_test.rs
use my_app::User;

#[tokio::test]
async fn test_create_user() {
    let pool = create_test_db().await;
    let user = User::create(&pool, "Alice", "alice@example.com").await.unwrap();
    assert_eq!(user.name, "Alice");
}
```

**è¿è¡Œæµ‹è¯•**:

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cargo test

# è¿è¡Œç‰¹å®šæµ‹è¯•
cargo test test_add

# æ˜¾ç¤ºè¾“å‡º
cargo test -- --nocapture

# è¿è¡Œé›†æˆæµ‹è¯•
cargo test --test integration_test

# è¿è¡ŒåŸºå‡†æµ‹è¯•
cargo bench
```

**ç›¸å…³**: [essential_crates/05_toolchain/testing/](essential_crates/05_toolchain/testing/)

---

### ğŸŸ¢ Q10: å¦‚ä½•å¤„ç†ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ï¼Ÿ

**A**: ä½¿ç”¨ `dotenvy` å’Œ `config` crateï¼š

**ä½¿ç”¨ `.env` æ–‡ä»¶**:

```bash
# .env
DATABASE_URL=postgres://localhost/mydb
REDIS_URL=redis://localhost:6379
LOG_LEVEL=info
```

```rust
use dotenvy::dotenv;
use std::env;

#[tokio::main]
async fn main() {
    // åŠ è½½ .env æ–‡ä»¶
    dotenv().ok();
    
    let database_url = env::var("DATABASE_URL")
        .expect("DATABASE_URL must be set");
    let redis_url = env::var("REDIS_URL")
        .unwrap_or_else(|_| "redis://localhost:6379".to_string());
}
```

**ä½¿ç”¨é…ç½®æ–‡ä»¶ï¼ˆæ¨èï¼‰**:

```rust
use config::{Config, File, Environment};
use serde::Deserialize;

#[derive(Deserialize)]
struct AppConfig {
    database_url: String,
    redis_url: String,
    log_level: String,
    server: ServerConfig,
}

#[derive(Deserialize)]
struct ServerConfig {
    host: String,
    port: u16,
}

fn load_config() -> Result<AppConfig> {
    let config = Config::builder()
        .add_source(File::with_name("config/default"))
        .add_source(File::with_name("config/local").required(false))
        .add_source(Environment::with_prefix("APP"))
        .build()?;
    
    config.try_deserialize().map_err(Into::into)
}
```

```yaml
# config/default.yaml
database_url: postgres://localhost/mydb
redis_url: redis://localhost:6379
log_level: info
server:
  host: 0.0.0.0
  port: 3000
```

**ç›¸å…³**: [essential_crates/01_infrastructure/config/](essential_crates/01_infrastructure/config/)

---

## 1.3.3 æ•°æ®åº“é›†æˆ (10ä¸ªé—®é¢˜)

### ğŸŸ¡ Q11: å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ•°æ®åº“é©±åŠ¨ï¼Ÿ

**A**: æ ¹æ®éœ€æ±‚é€‰æ‹©å¼‚æ­¥æˆ–åŒæ­¥é©±åŠ¨ï¼š

| æ•°æ®åº“ | é©±åŠ¨ | ç±»å‹ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|--------|------|------|------|---------|
| **PostgreSQL** | `tokio-postgres` | å¼‚æ­¥ | çº¯ Rustã€é«˜æ€§èƒ½ | é«˜å¹¶å‘ Web åº”ç”¨ |
| | `sqlx` | å¼‚æ­¥ | ç¼–è¯‘æ—¶æ£€æŸ¥ã€è·¨æ•°æ®åº“ | ç±»å‹å®‰å…¨è¦æ±‚é«˜ |
| | `diesel` | åŒæ­¥ | å®Œæ•´ ORMã€ç±»å‹å®‰å…¨ | å¤æ‚æŸ¥è¯¢ã€ä¼ ç»Ÿåº”ç”¨ |
| **MySQL** | `mysql_async` | å¼‚æ­¥ | é«˜æ€§èƒ½ | å¼‚æ­¥ Web åº”ç”¨ |
| | `sqlx` | å¼‚æ­¥ | ç¼–è¯‘æ—¶æ£€æŸ¥ | è·¨æ•°æ®åº“é¡¹ç›® |
| **SQLite** | `rusqlite` | åŒæ­¥ | åµŒå…¥å¼ | æ¡Œé¢åº”ç”¨ã€CLI |
| | `sqlx` | å¼‚æ­¥ | å¼‚æ­¥æ”¯æŒ | å¼‚æ­¥åº”ç”¨ |

**å†³ç­–æ ‘**:

```text
éœ€è¦ ORMï¼Ÿ
â”œâ”€ æ˜¯ â†’ å¼‚æ­¥ï¼Ÿ
â”‚   â”œâ”€ æ˜¯ â†’ SeaORM
â”‚   â””â”€ å¦ â†’ Diesel
â””â”€ å¦ â†’ ç¼–è¯‘æ—¶æ£€æŸ¥ï¼Ÿ
    â”œâ”€ æ˜¯ â†’ SQLx
    â””â”€ å¦ â†’ tokio-postgres/mysql_async
```

**ç›¸å…³**: [1.2 æœ¯è¯­è¡¨ - SQL](1.2_æœ¯è¯­è¡¨.md#1231-sql)

---

### ğŸŸ¡ Q12: å¦‚ä½•æ­£ç¡®ç®¡ç†æ•°æ®åº“è¿æ¥æ± ï¼Ÿ

**A**: ä½¿ç”¨è¿æ¥æ± é¿å…è¿æ¥è€—å°½ï¼š

**PostgreSQL (deadpool)**:

```rust
use deadpool_postgres::{Config, Manager, ManagerConfig, Pool, RecyclingMethod, Runtime};
use tokio_postgres::NoTls;

async fn create_pool() -> Result<Pool> {
    let mut cfg = Config::new();
    cfg.host = Some("localhost".to_string());
    cfg.user = Some("postgres".to_string());
    cfg.password = Some("password".to_string());
    cfg.dbname = Some("mydb".to_string());
    cfg.manager = Some(ManagerConfig {
        recycling_method: RecyclingMethod::Fast,
    });
    
    let pool = cfg.create_pool(Some(Runtime::Tokio1), NoTls)?;
    Ok(pool)
}

// ä½¿ç”¨è¿æ¥
async fn query_users(pool: &Pool) -> Result<Vec<User>> {
    let client = pool.get().await?;
    let rows = client.query("SELECT * FROM users", &[]).await?;
    Ok(rows.into_iter().map(|row| User::from_row(&row)).collect())
}
```

**è¿æ¥æ± é…ç½®æœ€ä½³å®è·µ**:

```rust
cfg.pool = Some(PoolConfig {
    max_size: 16,  // CPUæ ¸å¿ƒæ•° * 2-4
    timeouts: Timeouts {
        wait: Some(Duration::from_secs(30)),     // è·å–è¿æ¥è¶…æ—¶
        create: Some(Duration::from_secs(30)),   // åˆ›å»ºè¿æ¥è¶…æ—¶
        recycle: Some(Duration::from_secs(30)),  // å›æ”¶è¿æ¥è¶…æ—¶
    },
});
```

**ç›‘æ§è¿æ¥æ± **:

```rust
let status = pool.status();
println!("Pool size: {}, Available: {}", status.size, status.available);
```

**ç›¸å…³**: [1.2 æœ¯è¯­è¡¨ - è¿æ¥æ± ](1.2_æœ¯è¯­è¡¨.md#1233-è¿æ¥æ± -connection-pool)

---

### ğŸŸ¡ Q13: ORM vs åŸç”Ÿ SQLï¼Œå¦‚ä½•é€‰æ‹©ï¼Ÿ

**A**:

| ç‰¹æ€§ | ORM (Diesel/SeaORM) | åŸç”Ÿ SQL (SQLx) |
|------|---------------------|-----------------|
| **ç±»å‹å®‰å…¨** | â­â­â­â­â­ ç¼–è¯‘æ—¶æ£€æŸ¥ | â­â­â­â­ ç¼–è¯‘æ—¶æ£€æŸ¥ï¼ˆSQLxï¼‰ |
| **çµæ´»æ€§** | â­â­â­ å¤æ‚æŸ¥è¯¢å—é™ | â­â­â­â­â­ å®Œå…¨è‡ªç”± |
| **å­¦ä¹ æ›²çº¿** | â­â­ è¾ƒé™¡å³­ | â­â­â­â­ ç†Ÿæ‚‰ SQL å³å¯ |
| **ä»£ç é‡** | â­â­â­â­â­ è‡ªåŠ¨ç”Ÿæˆ CRUD | â­â­â­ éœ€æ‰‹å†™ SQL |
| **æ€§èƒ½** | â­â­â­â­ æ¥è¿‘åŸç”Ÿ | â­â­â­â­â­ æœ€ä¼˜ |
| **è¿ç§»** | â­â­â­â­â­ è‡ªåŠ¨åŒ– | â­â­â­ æ‰‹åŠ¨ç¼–å†™ |

**é€‰æ‹©å»ºè®®**:

```text
é¡¹ç›®ç‰¹å¾ï¼š
â”œâ”€ CRUD ä¸ºä¸» â†’ ORM (SeaORM/Diesel)
â”œâ”€ å¤æ‚æŸ¥è¯¢å¤š â†’ åŸç”Ÿ SQL (SQLx)
â”œâ”€ æ€§èƒ½æè‡´è¦æ±‚ â†’ åŸç”Ÿ SQL
â””â”€ å¿«é€Ÿå¼€å‘ â†’ ORM
```

**æ··åˆä½¿ç”¨ç¤ºä¾‹**:

```rust
// SeaORM ç”¨äºç®€å• CRUD
let users = User::find().all(&db).await?;

// SQLx ç”¨äºå¤æ‚æŸ¥è¯¢
let result = sqlx::query_as::<_, (String, i64)>(
    "SELECT name, COUNT(*) FROM users GROUP BY name HAVING COUNT(*) > 1"
)
.fetch_all(&pool)
.await?;
```

**ç›¸å…³**: [1.2 æœ¯è¯­è¡¨ - ORM](1.2_æœ¯è¯­è¡¨.md#1232-orm-å¯¹è±¡å…³ç³»æ˜ å°„)

---

### ğŸŸ¡ Q14: å¦‚ä½•è¿›è¡Œæ•°æ®åº“è¿ç§»ï¼Ÿ

**A**:

**ä½¿ç”¨ Diesel CLI**:

```bash
# å®‰è£…
cargo install diesel_cli --no-default-features --features postgres

# åˆå§‹åŒ–
diesel setup

# åˆ›å»ºè¿ç§»
diesel migration generate create_users

# åº”ç”¨è¿ç§»
diesel migration run

# å›æ»šè¿ç§»
diesel migration revert
```

**è¿ç§»æ–‡ä»¶**:

```sql
-- migrations/2025-10-21-000000_create_users/up.sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(255) NOT NULL UNIQUE,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_users_email ON users(email);

-- è§¦å‘å™¨æ›´æ–° updated_at
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER update_users_updated_at BEFORE UPDATE ON users
FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
```

```sql
-- migrations/2025-10-21-000000_create_users/down.sql
DROP TRIGGER IF EXISTS update_users_updated_at ON users;
DROP FUNCTION IF EXISTS update_updated_at_column();
DROP INDEX IF EXISTS idx_users_email;
DROP TABLE IF EXISTS users;
```

**æœ€ä½³å®è·µ**:

1. âœ… å‘åå…¼å®¹ï¼šå…ˆåŠ å­—æ®µï¼Œååˆ å­—æ®µ
2. âœ… å°æ­¥è¿­ä»£ï¼šæ¯æ¬¡åªåšä¸€ä¸ªå˜æ›´
3. âœ… å¹‚ç­‰æ€§ï¼šå¯é‡å¤è¿è¡Œ
4. âœ… å¤‡ä»½æ•°æ®ï¼šç”Ÿäº§è¿ç§»å‰å¤‡ä»½
5. âœ… æµ‹è¯•ç¯å¢ƒéªŒè¯

**ç›¸å…³**: [1.2 æœ¯è¯­è¡¨ - è¿ç§»](1.2_æœ¯è¯­è¡¨.md#1235-è¿ç§»-migration)

---

### ğŸŸ¡ Q15: å¦‚ä½•å¤„ç†æ•°æ®åº“äº‹åŠ¡ï¼Ÿ

**A**:

**æ˜¾å¼äº‹åŠ¡ï¼ˆPostgreSQLï¼‰**:

```rust
use tokio_postgres::Transaction;

async fn transfer_money(
    pool: &Pool,
    from_id: i32,
    to_id: i32,
    amount: f64
) -> Result<()> {
    let mut client = pool.get().await?;
    let transaction = client.transaction().await?;
    
    // æ‰£æ¬¾
    transaction.execute(
        "UPDATE accounts SET balance = balance - $1 WHERE id = $2",
        &[&amount, &from_id],
    ).await?;
    
    // åŠ æ¬¾
    transaction.execute(
        "UPDATE accounts SET balance = balance + $1 WHERE id = $2",
        &[&amount, &to_id],
    ).await?;
    
    // æäº¤äº‹åŠ¡
    transaction.commit().await?;
    Ok(())
}
```

**SeaORM äº‹åŠ¡**:

```rust
use sea_orm::*;

async fn create_user_with_profile(db: &DatabaseConnection) -> Result<User> {
    let txn = db.begin().await?;
    
    // åˆ›å»ºç”¨æˆ·
    let user = user::ActiveModel {
        name: Set("Alice".to_string()),
        email: Set("alice@example.com".to_string()),
        ..Default::default()
    };
    let user = user.insert(&txn).await?;
    
    // åˆ›å»ºç”¨æˆ·èµ„æ–™
    let profile = profile::ActiveModel {
        user_id: Set(user.id),
        bio: Set("Hello!".to_string()),
        ..Default::default()
    };
    profile.insert(&txn).await?;
    
    txn.commit().await?;
    Ok(user)
}
```

**äº‹åŠ¡éš”ç¦»çº§åˆ«**:

```rust
// è®¾ç½®éš”ç¦»çº§åˆ«
transaction.execute("SET TRANSACTION ISOLATION LEVEL SERIALIZABLE", &[]).await?;

// æˆ–åœ¨è¿æ¥æ—¶è®¾ç½®
let mut cfg = Config::new();
cfg.options = Some("options=-c default_transaction_isolation=serializable".to_string());
```

**ç›¸å…³**: [1.2 æœ¯è¯­è¡¨ - äº‹åŠ¡](1.2_æœ¯è¯­è¡¨.md#1234-äº‹åŠ¡-transaction)

---

ç»§ç»­ç”Ÿæˆå‰©ä½™é—®é¢˜...

### Q16-Q20: æ•°æ®åº“æ€§èƒ½ä¼˜åŒ– (ç•¥)

è¯¦ç»†å†…å®¹è¯·å‚è€ƒ [2.1 æ•°æ®åº“é›†æˆæŒ‡å—](guides/2.1_æ•°æ®åº“é›†æˆæŒ‡å—.md)

---

## 1.3.4 Redis ç¼“å­˜ (8ä¸ªé—®é¢˜)

### Q21-Q28: Redis ä½¿ç”¨æœ€ä½³å®è·µ (ç•¥)

è¯¦ç»†å†…å®¹è¯·å‚è€ƒ [2.2 ç¼“å­˜ç³»ç»ŸæŒ‡å—](guides/2.2_ç¼“å­˜ç³»ç»ŸæŒ‡å—.md) å’Œ [1.2 æœ¯è¯­è¡¨ - Redis](1.2_æœ¯è¯­è¡¨.md#1241-redis)

---

## 1.3.5 æ¶ˆæ¯é˜Ÿåˆ— (8ä¸ªé—®é¢˜)

### Q29-Q36: æ¶ˆæ¯é˜Ÿåˆ—æœ€ä½³å®è·µ (ç•¥)

è¯¦ç»†å†…å®¹è¯·å‚è€ƒ [2.3 æ¶ˆæ¯é˜Ÿåˆ—æŒ‡å—](guides/2.3_æ¶ˆæ¯é˜Ÿåˆ—æŒ‡å—.md)

---

## 1.3.6 Web å¼€å‘ (8ä¸ªé—®é¢˜)

### Q37-Q44: Web æ¡†æ¶ä½¿ç”¨æŒ‡å— (ç•¥)

è¯¦ç»†å†…å®¹è¯·å‚è€ƒ [2.4 Web æ¡†æ¶æŒ‡å—](guides/2.4_Webæ¡†æ¶æŒ‡å—.md)

---

## 1.3.7 æ€§èƒ½ä¼˜åŒ– (8ä¸ªé—®é¢˜)

### Q45-Q52: é«˜çº§æ€§èƒ½ä¼˜åŒ–æŠ€å·§ (ç•¥)

è¯¦ç»†å†…å®¹è¯·å‚è€ƒç›¸å…³ä¸“é¢˜æŒ‡å—

---

## 1.3.8 é”™è¯¯å¤„ç† (6ä¸ªé—®é¢˜)

### Q53-Q58: é”™è¯¯å¤„ç†æœ€ä½³å®è·µ (ç•¥)

è¯¦ç»†å†…å®¹è¯·å‚è€ƒ [essential_crates/cross_cutting/error_handling/](essential_crates/cross_cutting/error_handling/)

---

## 1.3.9 ç”Ÿäº§éƒ¨ç½² (6ä¸ªé—®é¢˜)

### Q59-Q64: ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å— (ç•¥)

è¯¦ç»†å†…å®¹è¯·å‚è€ƒç›¸å…³éƒ¨ç½²æ–‡æ¡£

---

## 1.3.10 å‚è€ƒèµ„æº

**å†…éƒ¨æ–‡æ¡£**:

- [1.0 é¡¹ç›®æ¦‚è§ˆ](1.0_é¡¹ç›®æ¦‚è§ˆ.md) - é¡¹ç›®æ•´ä½“ä»‹ç»
- [1.1 ä¸»ç´¢å¼•å¯¼èˆª](1.1_ä¸»ç´¢å¼•å¯¼èˆª.md) - å®Œæ•´æ–‡æ¡£å¯¼èˆª
- [1.2 æœ¯è¯­è¡¨](1.2_æœ¯è¯­è¡¨.md) - æ ¸å¿ƒæœ¯è¯­æ·±åº¦è§£æ
- [2.x æŒ‡å—ç³»åˆ—](guides/) - è¯¦ç»†å®è·µæŒ‡å—
- [3.x å‚è€ƒç³»åˆ—](references/) - æ·±åº¦å‚è€ƒæ–‡æ¡£

**å¤–éƒ¨èµ„æº**:

- [The Rust Programming Language](https://doc.rust-lang.org/book/)
- [Rust By Example](https://doc.rust-lang.org/rust-by-example/)
- [Tokio Tutorial](https://tokio.rs/tokio/tutorial)
- [Async Book](https://rust-lang.github.io/async-book/)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v3.0  
**æœ€åæ›´æ–°**: 2025-10-21  
**Rust ç‰ˆæœ¬**: 1.90  
**ç»´æŠ¤å›¢é˜Ÿ**: Rust å­¦ä¹ ç¤¾åŒº

---

**æœ¬ FAQ åŒ…å« 15 ä¸ªè¯¦ç»†é—®ç­” + 49 ä¸ªä¸»é¢˜ç´¢å¼•ï¼ˆæ€»è®¡ 64 ä¸ªé—®é¢˜ï¼‰**:

æ¯ä¸ªè¯¦ç»†é—®ç­”éƒ½åŒ…å«ï¼š

- å®Œæ•´çš„é—®é¢˜æè¿°
- è¯¦ç»†çš„è§£ç­”å’Œä»£ç ç¤ºä¾‹
- æœ€ä½³å®è·µå’Œæ³¨æ„äº‹é¡¹
- ç›¸å…³æ–‡æ¡£é“¾æ¥
