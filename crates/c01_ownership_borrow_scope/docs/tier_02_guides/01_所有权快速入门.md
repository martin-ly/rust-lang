# 2.1 所有权系统

## 📋 目录

- [2.1 所有权系统](#21-所有权系统)
  - [� 目录](#-目录)
  - [📖 学习目标](#-学习目标)
  - [🎯 核心内容导航](#-核心内容导航)
    - [1. 所有权三大规则](#1-所有权三大规则)
    - [2. Move 语义](#2-move-语义)
    - [3. Copy 语义](#3-copy-语义)
    - [4. 函数中的所有权](#4-函数中的所有权)
  - [📚 完整内容](#-完整内容)
  - [🎓 学习建议](#-学习建议)
    - [学习路径](#学习路径)
    - [重点关注](#重点关注)
    - [配套资源](#配套资源)
  - [💡 快速参考](#-快速参考)
    - [所有权规则速查](#所有权规则速查)
    - [Move vs Copy 决策树](#move-vs-copy-决策树)
    - [常见错误速查](#常见错误速查)
  - [🔗 相关主题](#-相关主题)
    - [本层级](#本层级)
    - [其他层级](#其他层级)
  - [✅ 完成检查](#-完成检查)
  - [🚀 下一步](#-下一步)

## 📖 学习目标

完成本文档后，你将能够：

- ✅ 深入理解所有权的三大规则及其实现原理
- ✅ 掌握 Move 和 Copy 语义的区别和应用场景
- ✅ 理解栈和堆的内存分配机制
- ✅ 能够设计合理的所有权传递策略
- ✅ 掌握所有权在函数和结构体中的应用

## 🎯 核心内容导航

### 1. 所有权三大规则

**规则概述**:

```text
规则 1: 每个值都有唯一的所有者（变量）
规则 2: 同一时间只能有一个所有者
规则 3: 所有者离开作用域时，值被自动释放
```

**详细学习**: [所有权基础概念 §1.1](../02_core/01_ownership_fundamentals.md#11-所有权规则)

### 2. Move 语义

**核心概念**:

- 默认的所有权转移机制
- 适用于堆分配的类型（String, Vec, Box等）
- 零运行时开销

**详细学习**: [移动语义 §1.2](../02_core/01_ownership_fundamentals.md#12-移动语义-move-semantics)

### 3. Copy 语义

**核心概念**:

- 简单类型的按位复制
- 适用于栈分配的类型（i32, f64, bool等）
- 实现 Copy trait 的条件

**详细学习**: [所有权基础概念 §1.1](../02_core/01_ownership_fundamentals.md#11-所有权规则)

### 4. 函数中的所有权

**关键场景**:

- 参数传递的所有权转移
- 返回值的所有权转移
- 如何设计函数签名

**详细学习**: [高级所有权模式 §5.1](../02_core/01_ownership_fundamentals.md#51-所有权转移模式)

## 📚 完整内容

本主题的完整详细内容，包括大量示例和深入解析，请参考：

**[📖 所有权系统基础完整文档](../02_core/01_ownership_fundamentals.md)**

该文档包含：

- ✅ 所有权基础概念（600+ 行）
- ✅ 移动语义详解
- ✅ 智能指针系统
- ✅ 内存安全保证
- ✅ 高级所有权模式
- ✅ 性能优化技巧
- ✅ 常见错误和解决方案
- ✅ 最佳实践总结

## 🎓 学习建议

### 学习路径

1. **第一遍**（2小时）: 快速浏览，理解核心概念
2. **第二遍**（2-3小时）: 详细阅读，运行所有示例
3. **第三遍**（1-2小时）: 实践练习，解决问题

### 重点关注

| 优先级 | 主题 | 重要性 |
|--------|------|--------|
| 🔴 **必须掌握** | 三大规则、Move vs Copy | 基础 |
| 🟡 **应该理解** | 函数所有权、返回值 | 常用 |
| 🟢 **可以了解** | 高级模式、优化技巧 | 进阶 |

### 配套资源

**代码示例**:

- 💻 **所有权示例** → [所有权系统基础](../02_core/01_ownership_fundamentals.md) (包含 15+ 完整示例和测试)
- 🧪 **综合示例集** → [Rust 1.90 实战示例](../RUST_190_EXAMPLES_COLLECTION.md) (138+ 综合示例)

**可视化资源**:

- 📊 [知识图谱](../KNOWLEDGE_GRAPH.md) - 查看所有权相关概念
- 🧠 [思维导图](../MIND_MAP.md) - 所有权学习路径

## 💡 快速参考

### 所有权规则速查

```rust
// 规则 1 & 2: 唯一所有者
let s1 = String::from("hello");
let s2 = s1;  // 所有权转移，s1 失效

// 规则 3: 离开作用域自动释放
{
    let s = String::from("hello");
}  // s 被自动释放

// Copy 类型：复制而非移动
let x = 5;
let y = x;  // x 仍然有效
```

### Move vs Copy 决策树

```text
值的赋值
    ↓
类型实现了 Copy？
    ├─ 是 → 复制值，原变量仍有效
    └─ 否 → 移动所有权，原变量失效
```

### 常见错误速查

| 错误信息 | 原因 | 解决方案 |
|----------|------|----------|
| value used after move | 使用已移动的值 | 使用引用或 clone |
| cannot move out of | 尝试移出借用值 | 使用 to_owned 或重新设计 |

## 🔗 相关主题

### 本层级

- 📖 [2.2 借用检查器](./2.2_借用检查器.md) - 理解借用规则
- 📖 [2.3 生命周期](./2.3_生命周期.md) - 引用的有效性
- 📖 [2.4 作用域规则](./2.4_作用域规则.md) - 资源管理

### 其他层级

- 🎯 [Tier 1: 快速开始](../tier1_foundation/1.2_快速开始指南.md) - 快速回顾
- 🎨 [Tier 3: 高级所有权](../tier3_advanced/3.1_高级所有权模式.md) - 高级模式
- 🔬 [Tier 4: 类型系统理论](../tier4_theoretical/4.1_类型系统理论.md) - 理论基础

## ✅ 完成检查

完成学习后，你应该能够：

- [ ] 解释所有权的三大规则
- [ ] 区分 Move 和 Copy 语义
- [ ] 预测代码中的所有权变化
- [ ] 设计合理的函数所有权策略
- [ ] 解决常见的所有权编译错误

## 🚀 下一步

**继续学习**: [2.2 借用检查器](./2.2_借用检查器.md)

---

**最后更新**: 2025-10-22
**维护状态**: ✅ 活跃维护
