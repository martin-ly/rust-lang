# 贡献指南

感谢您对 **C01 所有权系统学习模块**的关注！我们欢迎各种形式的贡献。

---

## 📋 目录

- [贡献指南](#贡献指南)
  - [📋 目录](#-目录)
  - [🤝 贡献方式](#-贡献方式)
    - [1. 📖 文档改进](#1--文档改进)
    - [2. 💻 代码示例](#2--代码示例)
    - [3. 🎨 可视化资源](#3--可视化资源)
    - [4. 🐛 问题报告](#4--问题报告)
    - [5. 💬 社区参与](#5--社区参与)
  - [🚀 开始之前](#-开始之前)
    - [前置条件](#前置条件)
    - [了解项目](#了解项目)
    - [环境设置](#环境设置)
  - [🔄 贡献流程](#-贡献流程)
    - [标准流程](#标准流程)
    - [详细步骤](#详细步骤)
      - [1. 创建 Issue (可选但推荐)](#1-创建-issue-可选但推荐)
      - [2. 开发您的贡献](#2-开发您的贡献)
      - [3. 提交更改](#3-提交更改)
      - [4. 推送并创建 PR](#4-推送并创建-pr)
  - [📖 文档贡献](#-文档贡献)
    - [文档结构](#文档结构)
    - [文档标准](#文档标准)
      - [必须包含](#必须包含)
      - [代码示例规范](#代码示例规范)
      - [Markdown 格式](#markdown-格式)
    - [文档质量检查](#文档质量检查)
  - [💻 代码贡献](#-代码贡献)
    - [代码标准](#代码标准)
      - [代码风格](#代码风格)
      - [命名规范](#命名规范)
      - [示例函数规范](#示例函数规范)
    - [测试要求](#测试要求)
      - [单元测试](#单元测试)
      - [集成测试](#集成测试)
      - [测试覆盖](#测试覆盖)
    - [性能考虑](#性能考虑)
  - [⭐ 质量标准](#-质量标准)
    - [文档质量评分标准](#文档质量评分标准)
    - [代码质量检查清单](#代码质量检查清单)
    - [审查标准](#审查标准)
  - [🔍 审查流程](#-审查流程)
    - [审查时间](#审查时间)
    - [审查过程](#审查过程)
    - [如何加速审查](#如何加速审查)
    - [常见反馈](#常见反馈)
      - [需要改进](#需要改进)
      - [如何响应](#如何响应)
  - [🌟 社区规范](#-社区规范)
    - [行为准则](#行为准则)
    - [沟通渠道](#沟通渠道)
    - [获取帮助](#获取帮助)
  - [🎯 贡献者进阶](#-贡献者进阶)
    - [成为活跃贡献者](#成为活跃贡献者)
    - [成为维护者](#成为维护者)
  - [📞 联系方式](#-联系方式)
    - [项目维护者](#项目维护者)
    - [快速链接](#快速链接)
  - [🙏 致谢](#-致谢)

---

## 🤝 贡献方式

我们欢迎以下类型的贡献：

### 1. 📖 文档改进

- **修正错误**: 拼写、语法、技术错误
- **内容补充**: 添加遗漏的概念或示例
- **结构优化**: 改进文档组织和导航
- **翻译**: 英文版本或其他语言版本

### 2. 💻 代码示例

- **新增示例**: 补充有价值的代码示例
- **优化示例**: 改进现有示例的质量
- **测试用例**: 添加或完善测试覆盖
- **性能优化**: 提供性能对比和优化方案

### 3. 🎨 可视化资源

- **图表**: Mermaid 图表、流程图、架构图
- **思维导图**: ASCII 艺术或其他格式
- **对比表格**: 技术对比、性能数据

### 4. 🐛 问题报告

- **Bug 报告**: 发现的错误或问题
- **改进建议**: 提出改进意见
- **功能请求**: 建议新功能或内容

### 5. 💬 社区参与

- **答疑解惑**: 帮助其他学习者
- **经验分享**: 分享学习心得
- **反馈意见**: 提供使用反馈

---

## 🚀 开始之前

### 前置条件

- **Rust 环境**: Rust 1.90+ (推荐使用 rustup)
- **Git**: 版本控制工具
- **Markdown 编辑器**: 推荐 VS Code + Markdown 插件

### 了解项目

1. **阅读 README**: 了解项目概况和目标
2. **浏览文档**: 熟悉 Tier 1-4 架构
3. **查看 CHANGELOG**: 了解最新更新
4. **阅读现有 Issues**: 避免重复工作

### 环境设置

```bash
# 1. Fork 项目到您的 GitHub 账户

# 2. Clone 到本地
git clone https://github.com/YOUR_USERNAME/rust-lang.git
cd rust-lang/crates/c01_ownership_borrow_scope

# 3. 添加上游仓库
git remote add upstream https://github.com/rust-lang/rust-lang.git

# 4. 创建新分支
git checkout -b feature/your-feature-name

# 5. 运行测试确保环境正常
cargo test --all
```

---

## 🔄 贡献流程

### 标准流程

```text
1. Fork 项目
   ↓
2. 创建特性分支
   ↓
3. 进行修改
   ↓
4. 运行测试
   ↓
5. 提交更改
   ↓
6. 推送到 Fork
   ↓
7. 创建 Pull Request
   ↓
8. 等待审查
   ↓
9. 根据反馈修改
   ↓
10. 合并 ✅
```

### 详细步骤

#### 1. 创建 Issue (可选但推荐)

对于较大的改动，建议先创建 Issue 讨论：

```markdown
**标题**: [功能/文档/Bug] 简短描述

**描述**:
- 问题/建议的详细说明
- 相关背景信息
- 预期效果
- 可能的实现方案
```

#### 2. 开发您的贡献

**文档修改**:

```bash
# 编辑文档
vim docs/tier3_advanced/3.1_高级所有权模式.md

# 检查格式
# (确保使用一致的 Markdown 格式)
```

**代码示例**:

```bash
# 添加示例
vim examples/your_example.rs

# 运行示例
cargo run --example your_example

# 添加测试
cargo test --example your_example
```

#### 3. 提交更改

**提交信息格式**:

```text
<type>(<scope>): <subject>

<body>

<footer>
```

**Type 类型**:

- `feat`: 新功能
- `fix`: 修复bug
- `docs`: 文档更新
- `style`: 格式调整
- `refactor`: 重构
- `test`: 测试相关
- `chore`: 构建/工具相关

**示例**:

```bash
git commit -m "docs(tier3): 添加 Arc 循环引用示例

- 添加完整的 Arc 循环引用代码示例
- 包含问题演示和 Weak 解决方案
- 更新相关测试用例

Closes #123"
```

#### 4. 推送并创建 PR

```bash
# 推送到您的 Fork
git push origin feature/your-feature-name

# 在 GitHub 上创建 Pull Request
```

**PR 标题格式**:

```text
[Tier N] 简短描述 (#issue-number)
```

**PR 描述模板**:

```markdown
## 概述
简要描述此 PR 的目的和内容。

## 变更类型
- [ ] 文档改进
- [ ] 代码示例
- [ ] Bug 修复
- [ ] 新功能
- [ ] 其他

## 详细说明
具体说明做了哪些更改，为什么这样做。

## 测试
- [ ] 已运行 `cargo test`
- [ ] 已运行 `cargo clippy`
- [ ] 已检查文档格式
- [ ] 已测试示例代码

## 相关 Issue
Closes #issue-number

## 截图 (如适用)
提供截图或输出结果。

## Checklist
- [ ] 代码遵循项目风格指南
- [ ] 已添加必要的注释
- [ ] 已更新相关文档
- [ ] 所有测试通过
- [ ] 已阅读贡献指南
```

---

## 📖 文档贡献

### 文档结构

我们的文档遵循 **Tier 1-4 架构**：

```text
docs/
├── tier1_foundation/      # 基础入门 (Tier 1)
├── tier2_core_concepts/   # 核心概念 (Tier 2)
├── tier3_advanced/        # 高级实践 (Tier 3)
└── tier4_theoretical/     # 理论深度 (Tier 4)
```

### 文档标准

#### 必须包含

1. **元数据**:

    ```markdown
    # 文档标题

    **文档版本**: 2.0  
    **适用 Rust 版本**: 1.90+  
    **最后更新**: 2025-10-22  
    **文档类型**: Tier N [类型]
    ```

2. **目录**:

    ```markdown
    ## 📋 目录

    - [章节 1](#章节-1)
    - [章节 2](#章节-2)
    ```

3. **学习目标** (Tier 1-3):

    ```markdown
    ### 🎯 学习目标

    - ✅ 理解...
    - ✅ 掌握...
    ```

4. **前置知识** (Tier 2+):

    ```markdown
    ### 📚 前置知识

    - ✅ 需要了解...
    - ✅ 推荐先学习...
    ```

5. **相关资源**:

    ```markdown
    ## 相关资源

    ### 📖 核心文档
    - **[文档名](./路径.md)**: 简短描述
    ```

#### 代码示例规范

```rust
// ✅ 良好示例: 包含详细注释

/// 演示所有权转移
/// 
/// # 示例
/// 
/// ```rust
/// let s1 = String::from("hello");
/// let s2 = s1;  // s1 的所有权转移给 s2
/// // println!("{}", s1);  // ❌ 错误: s1 已失效
/// ```
fn ownership_transfer_example() {
    let s1 = String::from("hello");
    let s2 = s1;  // 所有权转移
    
    println!("s2 = {}", s2);  // ✅ OK
    // s1 不再可用
}
```

```rust
// ❌ 避免: 缺少注释和说明

fn example() {
    let s = String::from("test");
    let s2 = s;
    println!("{}", s2);
}
```

#### Markdown 格式

- **标题**: 使用 `#` 层级标题，不超过 4 级
- **列表**: 使用 `-` 或 `1.`，统一缩进
- **代码块**: 指定语言 ````rust`,`bash`,`text` 等
- **强调**: 使用 `**粗体**` 和 `*斜体*`
- **链接**: 内部链接使用相对路径
- **表格**: 使用 Markdown 表格语法，对齐清晰

### 文档质量检查

提交前请检查：

- [ ] 无拼写和语法错误
- [ ] 代码示例可以编译和运行
- [ ] 所有链接有效
- [ ] 格式统一规范
- [ ] 逻辑清晰连贯
- [ ] 目录结构完整

---

## 💻 代码贡献

### 代码标准

#### 代码风格

```bash
# 运行格式化
cargo fmt --all

# 运行 Clippy 检查
cargo clippy --all -- -D warnings
```

#### 命名规范

- **变量/函数**: `snake_case`
- **类型/Trait**: `PascalCase`
- **常量**: `SCREAMING_SNAKE_CASE`
- **模块**: `snake_case`

#### 示例函数规范

```rust
/// 功能简述
///
/// # 参数
///
/// * `param1` - 参数1说明
/// * `param2` - 参数2说明
///
/// # 返回值
///
/// 返回值说明
///
/// # 示例
///
/// ```rust
/// let result = function_name(arg1, arg2);
/// assert_eq!(result, expected);
/// ```
///
/// # Rust 版本
///
/// 要求 Rust 1.90+
pub fn function_name(param1: Type1, param2: Type2) -> ReturnType {
    // 实现
}
```

### 测试要求

#### 单元测试

```rust
#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_function_name() {
        // 测试代码
        let result = function_name(test_input);
        assert_eq!(result, expected_output);
    }

    #[test]
    fn test_edge_case() {
        // 边界情况测试
    }
}
```

#### 集成测试

```rust
// tests/integration_test.rs

#[test]
fn test_complete_workflow() {
    // 完整流程测试
}
```

#### 测试覆盖

```bash
# 运行所有测试
cargo test --all

# 运行特定测试
cargo test test_name

# 生成覆盖率报告 (需要 tarpaulin)
cargo tarpaulin --out Html
```

### 性能考虑

- 提供性能基准测试 (使用 Criterion.rs)
- 对比不同实现的性能
- 说明时间/空间复杂度
- 讨论权衡 (trade-offs)

---

## ⭐ 质量标准

### 文档质量评分标准

我们的目标是保持 **98/100** 的质量评分。贡献应符合以下标准：

| 维度 | 要求 | 权重 |
|------|------|------|
| **技术准确性** | 无技术错误，引用可靠来源 | 30% |
| **内容完整性** | 覆盖核心知识点，层次清晰 | 25% |
| **可读性** | 语言流畅，结构合理 | 20% |
| **代码质量** | 可运行，有注释，遵循规范 | 15% |
| **实用性** | 解决实际问题，提供价值 | 10% |

### 代码质量检查清单

- [ ] **编译**: `cargo build --all` 无错误
- [ ] **测试**: `cargo test --all` 全部通过
- [ ] **Clippy**: `cargo clippy --all` 无警告
- [ ] **格式**: `cargo fmt --all --check` 格式正确
- [ ] **文档**: `cargo doc --no-deps` 文档生成正常

### 审查标准

所有 PR 将根据以下标准审查：

1. **技术正确性** ⭐⭐⭐⭐⭐
   - 技术内容准确无误
   - 符合 Rust 最佳实践
   - 引用权威来源

2. **代码质量** ⭐⭐⭐⭐
   - 遵循 Rust 风格指南
   - 有充分的测试覆盖
   - 通过所有检查

3. **文档质量** ⭐⭐⭐⭐
   - 语言清晰准确
   - 格式统一规范
   - 结构逻辑清晰

4. **用户价值** ⭐⭐⭐⭐
   - 解决实际问题
   - 提供学习价值
   - 易于理解应用

---

## 🔍 审查流程

### 审查时间

- **小改动** (修正错别字等): 1-2 天
- **中等改动** (新增示例等): 3-5 天
- **大改动** (新章节等): 1-2 周

### 审查过程

1. **自动检查**: CI/CD 自动运行测试和检查
2. **初步审查**: 维护者检查格式和基本要求
3. **技术审查**: 专家审查技术内容准确性
4. **社区反馈**: 其他贡献者可能提供意见
5. **最终审核**: 维护者决定是否合并

### 如何加速审查

- **遵循规范**: 符合所有质量标准
- **小步快跑**: 分解大改动为多个小 PR
- **及时响应**: 快速回应审查意见
- **自我审查**: 提交前仔细检查
- **清晰沟通**: 在 PR 中详细说明

### 常见反馈

#### 需要改进

- "请添加更多注释说明代码逻辑"
- "请运行 `cargo fmt` 格式化代码"
- "请添加测试用例"
- "请修正文档中的技术错误"

#### 如何响应

```bash
# 1. 在本地进行修改
git add modified_files
git commit -m "fix: 根据审查意见修改"

# 2. 推送更新
git push origin feature/your-feature-name

# 3. 在 PR 中回复审查者
```

---

## 🌟 社区规范

### 行为准则

我们致力于维护一个友好、包容、专业的社区环境：

✅ **应该做的**:

- 尊重所有贡献者
- 提供建设性的反馈
- 欢迎不同的观点和经验
- 聚焦于对项目最有利的选择

❌ **不应该做的**:

- 使用不当或冒犯性语言
- 人身攻击或侮辱
- 骚扰其他参与者
- 未经许可分享他人隐私信息

### 沟通渠道

- **GitHub Issues**: 问题报告、功能请求
- **GitHub Discussions**: 一般讨论、问答
- **Pull Requests**: 代码和文档贡献
- **Email**: <rust-learning@example.com> (重要事项)

### 获取帮助

如果您在贡献过程中遇到困难：

1. **查看文档**: README, CHANGELOG, 本指南
2. **搜索 Issues**: 看是否已有类似问题
3. **创建 Discussion**: 提出问题寻求帮助
4. **联系维护者**: 必要时直接联系

---

## 🎯 贡献者进阶

### 成为活跃贡献者

通过以下方式提升贡献影响力：

1. **持续贡献**: 定期提交高质量 PR
2. **帮助他人**: 在 Issues 和 Discussions 中答疑
3. **审查代码**: 帮助审查其他人的 PR
4. **分享经验**: 撰写博客或教程
5. **推广项目**: 在社区中推荐本项目

### 成为维护者

优秀的活跃贡献者有机会成为项目维护者：

**要求**:

- 持续 3+ 个月的高质量贡献
- 深入理解项目架构和目标
- 获得现有维护者的推荐
- 承诺长期参与项目

**职责**:

- 审查和合并 PR
- 回复 Issues 和 Discussions
- 指导新贡献者
- 参与项目规划

---

## 📞 联系方式

### 项目维护者

- **项目负责人**: Rust 学习社区
- **邮箱**: <rust-learning@example.com>
- **GitHub**: [rust-lang/rust-lang](https://github.com/rust-lang/rust-lang)

### 快速链接

- **项目主页**: [README.md](./README.md)
- **更新日志**: [CHANGELOG.md](./CHANGELOG.md)
- **问题反馈**: [GitHub Issues](https://github.com/rust-lang/rust-lang/issues)
- **讨论区**: [GitHub Discussions](https://github.com/rust-lang/rust-lang/discussions)

---

## 🙏 致谢

感谢所有为 C01 项目做出贡献的人！

您的贡献让这个项目变得更好 🎉

---

**最后更新**: 2025-10-22  
**文档版本**: 2.0  
**适用版本**: Rust 1.90+

---

*"每一个贡献都很重要，无论大小。让我们一起打造最好的 Rust 所有权学习资源！"* 🚀
