# 05 生产级宏开发

## 目录

- [05 生产级宏开发](#05-生产级宏开发)
  - [目录](#目录)
  - [1. 概述](#1-概述)
  - [2. 版本兼容性](#2-版本兼容性)
    - [2.1 MSRV 管理](#21-msrv-管理)
      - [2.1.1 声明 MSRV](#211-声明-msrv)
      - [2.1.2 CI 测试 MSRV](#212-ci-测试-msrv)
      - [2.1.3 MSRV 更新策略](#213-msrv-更新策略)
    - [2.2 Edition 兼容](#22-edition-兼容)
      - [2.2.1 支持多个 Edition](#221-支持多个-edition)
      - [2.2.2 Edition 特性隔离](#222-edition-特性隔离)
    - [2.3 依赖版本策略](#23-依赖版本策略)
      - [2.3.1 固定核心依赖](#231-固定核心依赖)
      - [2.3.2 可选依赖](#232-可选依赖)
    - [2.4 弃用和迁移](#24-弃用和迁移)
      - [2.4.1 弃用旧 API](#241-弃用旧-api)
      - [2.4.2 迁移指南](#242-迁移指南)
      - [2. `Config` 结构体重命名](#2-config-结构体重命名)
      - [自动化迁移](#自动化迁移)
  - [3. 错误诊断最佳实践](#3-错误诊断最佳实践)
    - [3.1 Span感知错误](#31-span感知错误)
      - [3.1.1 保留原始 Span](#311-保留原始-span)
      - [3.1.2 多位置错误](#312-多位置错误)
    - [3.2 帮助消息](#32-帮助消息)
      - [3.2.1 使用 proc-macro-error](#321-使用-proc-macro-error)
    - [3.3 多错误聚合](#33-多错误聚合)
      - [3.3.1 收集所有错误](#331-收集所有错误)
    - [3.4 友好错误文案](#34-友好错误文案)
      - [3.4.1 错误消息准则](#341-错误消息准则)
      - [3.4.2 上下文信息](#342-上下文信息)
  - [4. 文档生成](#4-文档生成)
    - [4.1 宏文档最佳实践](#41-宏文档最佳实践)
      - [4.1.1 完整示例](#411-完整示例)
      - [4.1.2 展开示例](#412-展开示例)
    - [4.2 示例代码](#42-示例代码)
      - [4.2.1 examples/ 目录](#421-examples-目录)
    - [4.3 隐藏实现细节](#43-隐藏实现细节)
      - [4.3.1 使用 #\[doc(hidden)\]](#431-使用-dochidden)
      - [4.3.2 使用 #\[doc(cfg(...))\]](#432-使用-doccfg)
    - [4.4 Doc Tests](#44-doc-tests)
      - [4.4.1 编译测试](#441-编译测试)
      - [4.4.2 运行时测试](#442-运行时测试)
  - [5. 发布策略](#5-发布策略)
    - [5.1 语义化版本](#51-语义化版本)
      - [5.1.1 版本号规则](#511-版本号规则)
      - [5.1.2 Pre-release 版本](#512-pre-release-版本)
    - [5.2 Changelog 管理](#52-changelog-管理)
      - [5.2.1 Keep a Changelog 格式](#521-keep-a-changelog-格式)
    - [5.3 Breaking Changes 处理](#53-breaking-changes-处理)
      - [5.3.1 通告期](#531-通告期)
      - [5.3.2 Cargo Features 隔离](#532-cargo-features-隔离)
    - [5.4 CI/CD 集成](#54-cicd-集成)
      - [5.4.1 GitHub Actions 发布流程](#541-github-actions-发布流程)
  - [6. 维护策略](#6-维护策略)
    - [6.1 问题追踪](#61-问题追踪)
      - [6.1.1 Issue 模板](#611-issue-模板)
    - [6.2 安全更新](#62-安全更新)
      - [6.2.1 cargo-audit 集成](#621-cargo-audit-集成)
      - [6.2.2 依赖更新策略](#622-依赖更新策略)
    - [6.3 社区支持](#63-社区支持)
      - [6.3.1 文档优先](#631-文档优先)
      - [6.3.2 响应时间](#632-响应时间)
    - [6.4 长期维护](#64-长期维护)
      - [6.4.1 LTS 版本](#641-lts-版本)
      - [6.4.2 向后兼容承诺](#642-向后兼容承诺)
  - [7. 实战案例](#7-实战案例)
    - [7.1 Serde 的版本策略](#71-serde-的版本策略)
    - [7.2 Tokio 宏的错误诊断](#72-tokio-宏的错误诊断)
  - [8. 相关资源](#8-相关资源)
    - [8.1 工具](#81-工具)
    - [8.2 学习资源](#82-学习资源)

---

## 1. 概述

**生产级宏开发**不仅要求宏功能正确，还需要考虑长期维护、版本兼容、用户体验等多个维度。本文档总结了成熟宏库的最佳实践，帮助开发者构建可靠、易用、可维护的宏系统。

**本文档涵盖**：

- **版本兼容性**：MSRV、Edition、依赖管理
- **错误诊断**：Span感知、帮助消息、友好文案
- **文档生成**：文档最佳实践、示例、Doc Tests
- **发布策略**：语义化版本、Changelog、CI/CD
- **维护策略**：问题追踪、安全更新、社区支持

**适用场景**：

- ✅ 发布开源宏库
- ✅ 维护企业内部宏工具
- ✅ 提升宏库质量和用户体验
- ✅ 建立长期维护流程

**学习路径**：

1. 理解版本兼容性要求
2. 掌握错误诊断最佳实践
3. 学习文档生成技术
4. 制定发布策略
5. 建立维护流程

---

## 2. 版本兼容性

### 2.1 MSRV 管理

#### 2.1.1 声明 MSRV

```toml
# Cargo.toml
[package]
name = "my_macro"
version = "1.0.0"
rust-version = "1.70.0"  # 最低支持的 Rust 版本

[package.metadata.docs.rs]
rustc-args = ["--cfg", "docsrs"]
```

#### 2.1.2 CI 测试 MSRV

```yaml
# .github/workflows/ci.yml
name: CI

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        rust:
          - 1.70.0  # MSRV
          - stable
          - nightly
    steps:
      - uses: actions/checkout@v3
      - uses: actions-rust-lang/setup-rust-toolchain@v1
        with:
          toolchain: ${{ matrix.rust }}
      - run: cargo test --all-features
```

#### 2.1.3 MSRV 更新策略

**保守策略**（推荐）：

- **Minor 版本**：不更新 MSRV
- **Major 版本**：可更新 MSRV（至少支持最近 6 个月的 Rust 版本）

**示例**：

```text
v1.0.0 (MSRV 1.65)
v1.1.0 (MSRV 1.65) ✅ 不变
v1.2.0 (MSRV 1.65) ✅ 不变
v2.0.0 (MSRV 1.70) ✅ Major 版本可更新
```

---

### 2.2 Edition 兼容

#### 2.2.1 支持多个 Edition

```toml
# Cargo.toml
[package]
edition = "2021"

[lib]
proc-macro = true

[dev-dependencies]
# 测试 Edition 2018 兼容性
trybuild = "1.0"
```

#### 2.2.2 Edition 特性隔离

```rust
// ✅ 使用 cfg 隔离 Edition 特定特性
#[cfg(not(rust_2021))]
fn legacy_impl() {
    // Edition 2018 实现
}

#[cfg(rust_2021)]
fn modern_impl() {
    // Edition 2021 实现
}

pub fn public_api() {
    #[cfg(rust_2021)]
    modern_impl();

    #[cfg(not(rust_2021))]
    legacy_impl();
}
```

---

### 2.3 依赖版本策略

#### 2.3.1 固定核心依赖

```toml
# Cargo.toml
[dependencies]
syn = "2.0"           # ✅ 固定 Major 版本
quote = "1.0"         # ✅ 固定 Major 版本
proc-macro2 = "1.0"   # ✅ 固定 Major 版本

[dev-dependencies]
trybuild = "1.0"
prettyplease = "0.2"  # ✅ 开发依赖可以更灵活
```

#### 2.3.2 可选依赖

```toml
[dependencies]
serde = { version = "1.0", optional = true }

[features]
default = []
serde-support = ["serde"]
```

```rust
#[cfg(feature = "serde-support")]
use serde::{Serialize, Deserialize};

// ✅ 条件生成代码
#[proc_macro_derive(MyMacro)]
pub fn my_macro(input: TokenStream) -> TokenStream {
    let input = parse_macro_input!(input as DeriveInput);

    #[cfg(feature = "serde-support")]
    let extra_impl = quote! {
        impl Serialize for #name { /* ... */ }
    };

    #[cfg(not(feature = "serde-support"))]
    let extra_impl = quote! {};

    // ...
}
```

---

### 2.4 弃用和迁移

#### 2.4.1 弃用旧 API

```rust
/// 旧 API（已弃用）
#[deprecated(
    since = "1.5.0",
    note = "请使用 `new_api` 替代。此函数将在 2.0.0 移除。"
)]
pub fn old_api() {
    // ...
}

/// 新 API（推荐）
pub fn new_api() {
    // ...
}
```

#### 2.4.2 迁移指南

```markdown
# 迁移指南：v1.x → v2.0

## Breaking Changes

### 1. `old_macro!` 已移除

**v1.x**:
```rust
old_macro! {
    field: value
}
```

**v2.0**:

```rust
new_macro! {
    field = "value"
}
```

#### 2. `Config` 结构体重命名

| v1.x | v2.0 |
|------|------|
| `Config::new()` | `ConfigBuilder::new()` |
| `Config::build()` | `ConfigBuilder::build()` |

#### 自动化迁移

使用 `cargo fix --edition` 自动迁移大部分代码。

---

## 3. 错误诊断最佳实践

### 3.1 Span感知错误

#### 3.1.1 保留原始 Span

```rust
use syn::Error;
use proc_macro2::Span;

fn validate_field(field: &syn::Field) -> Result<(), Error> {
    if field.attrs.is_empty() {
        return Err(Error::new(
            field.span(),  // ✅ 使用字段的 Span
            "expected at least one attribute"
        ));
    }
    Ok(())
}

// 错误会精确指向问题字段
// error: expected at least one attribute
//   --> src/lib.rs:5:5
//    |
// 5  |     name: String,
//    |     ^^^^^^^^^^^^
```

#### 3.1.2 多位置错误

```rust
use syn::Error;

fn check_consistency(field1: &syn::Field, field2: &syn::Field) -> Result<(), Error> {
    if /* 不一致 */ true {
        let mut error = Error::new(
            field1.span(),
            "this field conflicts with another field"
        );

        error.combine(Error::new(
            field2.span(),
            "conflicting field defined here"
        ));

        return Err(error);
    }
    Ok(())
}
```

---

### 3.2 帮助消息

#### 3.2.1 使用 proc-macro-error

```toml
[dependencies]
proc-macro-error = "1.0"
```

```rust
use proc_macro_error::{abort, emit_error, proc_macro_error};

#[proc_macro_derive(MyMacro)]
#[proc_macro_error]
pub fn my_macro(input: TokenStream) -> TokenStream {
    let input = parse_macro_input!(input as DeriveInput);

    if input.generics.params.is_empty() {
        abort!(
            input.ident.span(),
            "expected at least one generic parameter";
            help = "try: struct {}< T> {{ ... }}", input.ident;
            note = "generic parameters are required for this derive"
        );
    }

    // ...
}
```

**输出**：

```text
error: expected at least one generic parameter
  --> src/lib.rs:5:8
   |
5  | struct MyStruct;
   |        ^^^^^^^^
   |
   = help: try: struct MyStruct<T> { ... }
   = note: generic parameters are required for this derive
```

---

### 3.3 多错误聚合

#### 3.3.1 收集所有错误

```rust
use syn::Error;

fn validate_all(input: &DeriveInput) -> Result<(), Vec<Error>> {
    let mut errors = Vec::new();

    // 检查 1
    if let Err(e) = validate_generics(input) {
        errors.push(e);
    }

    // 检查 2
    if let Err(e) = validate_attributes(input) {
        errors.push(e);
    }

    // 检查 3
    if let Err(e) = validate_fields(input) {
        errors.push(e);
    }

    if errors.is_empty() {
        Ok(())
    } else {
        Err(errors)
    }
}

// 使用
#[proc_macro_derive(MyMacro)]
pub fn my_macro(input: TokenStream) -> TokenStream {
    let input = parse_macro_input!(input as DeriveInput);

    match validate_all(&input) {
        Ok(_) => { /* 生成代码 */ }
        Err(errors) => {
            // ✅ 一次性报告所有错误
            return errors.into_iter()
                .map(|e| e.to_compile_error())
                .collect::<TokenStream2>()
                .into();
        }
    }
}
```

---

### 3.4 友好错误文案

#### 3.4.1 错误消息准则

**❌ 糟糕**：

```text
error: invalid input
error: parse failed
error: type error
```

**✅ 好**：

```text
error: expected identifier, found keyword `type`
error: field `name` must be of type `String`, found `i32`
error: attribute `#[skip]` cannot be used with `#[rename]`
```

#### 3.4.2 上下文信息

```rust
fn report_error(field: &syn::Field, expected: &str, found: &str) -> Error {
    Error::new(
        field.span(),
        format!(
            "expected field type `{}`, found `{}`\n\
             \n\
             help: change the field type to `{}`\n\
             note: this restriction is due to the `Serialize` trait requirement",
            expected, found, expected
        )
    )
}
```

---

## 4. 文档生成

### 4.1 宏文档最佳实践

#### 4.1.1 完整示例

```rust
/// 自动派生 `Builder` 模式。
///
/// # Examples
///
/// ```
/// use my_macro::Builder;
///
/// #[derive(Builder)]
/// struct Config {
///     host: String,
///     port: u16,
/// }
///
/// let config = ConfigBuilder::new()
///     .host("localhost".to_string())
///     .port(8080)
///     .build();
/// ```
///
/// # Attributes
///
/// - `#[builder(default = "expr")]`: 设置字段默认值
/// - `#[builder(skip)]`: 跳过该字段
///
/// # Generated Code
///
/// 此宏生成：
/// - `<Name>Builder` 结构体
/// - `new()` 构造函数
/// - 每个字段的 setter 方法
/// - `build()` 最终构造方法
///
#[proc_macro_derive(Builder, attributes(builder))]
pub fn derive_builder(input: TokenStream) -> TokenStream {
    // ...
}
```

#### 4.1.2 展开示例

```rust
/// # Generated Code Example
///
/// For the following input:
///
/// ```ignore
/// #[derive(Builder)]
/// struct Config {
///     host: String,
///     port: u16,
/// }
/// ```
///
/// The macro generates:
///
/// ```ignore
/// struct ConfigBuilder {
///     host: Option<String>,
///     port: Option<u16>,
/// }
///
/// impl ConfigBuilder {
///     pub fn new() -> Self {
///         Self {
///             host: None,
///             port: None,
///         }
///     }
///
///     pub fn host(mut self, value: String) -> Self {
///         self.host = Some(value);
///         self
///     }
///
///     pub fn port(mut self, value: u16) -> Self {
///         self.port = Some(value);
///         self
///     }
///
///     pub fn build(self) -> Config {
///         Config {
///             host: self.host.expect("host is required"),
///             port: self.port.expect("port is required"),
///         }
///     }
/// }
/// ```
#[proc_macro_derive(Builder)]
pub fn derive_builder(input: TokenStream) -> TokenStream {
    // ...
}
```

---

### 4.2 示例代码

#### 4.2.1 examples/ 目录

**examples/basic.rs**:

```rust
use my_macro::Builder;

#[derive(Builder, Debug)]
struct ServerConfig {
    host: String,
    port: u16,
    #[builder(default = "4")]
    workers: usize,
}

fn main() {
    let config = ServerConfigBuilder::new()
        .host("0.0.0.0".to_string())
        .port(8080)
        .build();

    println!("{:?}", config);
}
```

**运行示例**：

```bash
cargo run --example basic
```

---

### 4.3 隐藏实现细节

#### 4.3.1 使用 #[doc(hidden)]

```rust
/// ⚠️ 内部实现细节，不要直接使用！
#[doc(hidden)]
pub mod __internal {
    pub fn helper_function() {
        // ...
    }
}

// 用户文档中不会显示 __internal 模块
```

#### 4.3.2 使用 #[doc(cfg(...))]

```rust
#[cfg(feature = "unstable")]
#[doc(cfg(feature = "unstable"))]
pub fn experimental_api() {
    // 仅在 "unstable" feature 启用时显示
}
```

---

### 4.4 Doc Tests

#### 4.4.1 编译测试

```rust
/// ```compile_fail
/// use my_macro::Builder;
///
/// #[derive(Builder)]
/// struct Invalid {
///     // ❌ 缺少类型注解
///     field
/// }
/// ```
#[proc_macro_derive(Builder)]
pub fn derive_builder(input: TokenStream) -> TokenStream {
    // ...
}
```

#### 4.4.2 运行时测试

```rust
/// ```
/// use my_macro::Builder;
///
/// #[derive(Builder)]
/// struct Config {
///     value: i32,
/// }
///
/// let config = ConfigBuilder::new().value(42).build();
/// assert_eq!(config.value, 42);
/// ```
#[proc_macro_derive(Builder)]
pub fn derive_builder(input: TokenStream) -> TokenStream {
    // ...
}
```

---

## 5. 发布策略

### 5.1 语义化版本

#### 5.1.1 版本号规则

**格式**：`MAJOR.MINOR.PATCH`

| 变更类型 | 版本号 | 示例 |
|---------|-------|------|
| 破坏性变更 | MAJOR | 1.5.0 → 2.0.0 |
| 新功能（向后兼容） | MINOR | 1.5.0 → 1.6.0 |
| Bug 修复 | PATCH | 1.5.0 → 1.5.1 |

#### 5.1.2 Pre-release 版本

```toml
# Cargo.toml
[package]
version = "2.0.0-rc.1"  # Release Candidate
# version = "2.0.0-alpha.1"  # Alpha
# version = "2.0.0-beta.1"   # Beta
```

---

### 5.2 Changelog 管理

#### 5.2.1 Keep a Changelog 格式

```markdown
# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Added
- 新功能：支持 `#[builder(validate)]` 属性

### Changed
- 优化：减少生成代码大小 20%

### Fixed
- 修复：在嵌套结构体中的 Span 错误

## [2.0.0] - 2025-10-23

### Added
- 支持泛型类型参数
- 添加 `#[builder(default = "expr")]` 属性

### Changed
- **BREAKING**: `Builder::new()` 现在返回 `Result`
- 更新 MSRV 至 1.70.0

### Removed
- **BREAKING**: 移除 `legacy_api()` 函数

## [1.5.0] - 2025-09-15

### Added
- 支持 `#[builder(skip)]` 属性

### Fixed
- 修复：在 `Option<T>` 字段的默认值问题
```

---

### 5.3 Breaking Changes 处理

#### 5.3.1 通告期

```rust
// v1.8.0: 添加弃用警告
#[deprecated(
    since = "1.8.0",
    note = "将在 2.0.0 移除，请使用 `new_api()` 替代"
)]
pub fn old_api() {
    new_api() // 内部调用新 API
}

// v2.0.0: 移除旧 API
// pub fn old_api() { /* 已移除 */ }
```

#### 5.3.2 Cargo Features 隔离

```toml
[features]
default = ["new-api"]
new-api = []
legacy-api = []
```

```rust
#[cfg(feature = "legacy-api")]
pub fn old_api() {
    // ...
}

#[cfg(feature = "new-api")]
pub fn new_api() {
    // ...
}
```

---

### 5.4 CI/CD 集成

#### 5.4.1 GitHub Actions 发布流程

```yaml
# .github/workflows/release.yml
name: Release

on:
  push:
    tags:
      - 'v*'

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - uses: actions-rust-lang/setup-rust-toolchain@v1

      - name: Run tests
        run: cargo test --all-features

      - name: Publish to crates.io
        run: cargo publish --token ${{ secrets.CARGO_TOKEN }}

      - name: Create GitHub Release
        uses: actions/create-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag_name: ${{ github.ref }}
          release_name: Release ${{ github.ref }}
          body_path: CHANGELOG.md
```

---

## 6. 维护策略

### 6.1 问题追踪

#### 6.1.1 Issue 模板

```markdown
    <!-- .github/ISSUE_TEMPLATE/bug_report.md -->
    ---
    name: Bug Report
    about: 报告 bug
    ---

    ## 描述

    简要描述问题。

    ## 重现步骤

    ```rust
    // 最小可重现示例
    #[derive(MyMacro)]
    struct Example {
        field: String,
    }
    ```

    ## 预期行为

    应该生成...

    ## 实际行为

        ```text
        error: ...
        ```

    ## 环境

    - Rust 版本: `rustc 1.70.0`
    - Crate 版本: `my_macro = "1.5.0"`
    - 操作系统: Ubuntu 22.04

```

---

### 6.2 安全更新

#### 6.2.1 cargo-audit 集成

```yaml
# .github/workflows/audit.yml
name: Security Audit

on:
  schedule:
    - cron: '0 0 * * *'  # 每天运行

jobs:
  audit:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions-rust-lang/audit-check@v1
```

#### 6.2.2 依赖更新策略

**定期更新**：

- **Patch 版本**：每周检查
- **Minor 版本**：每月评估
- **Major 版本**：每季度评估

**Dependabot 配置**：

```yaml
# .github/dependabot.yml
version: 2
updates:
  - package-ecosystem: "cargo"
    directory: "/"
    schedule:
      interval: "weekly"
```

---

### 6.3 社区支持

#### 6.3.1 文档优先

**优先级**：

1. README.md
2. API 文档
3. examples/
4. 迁移指南
5. 常见问题（FAQ）

#### 6.3.2 响应时间

| 问题类型 | 目标响应时间 |
|---------|-------------|
| 安全漏洞 | 24 小时 |
| 重大 Bug | 48 小时 |
| 功能请求 | 1 周 |
| 文档问题 | 3 天 |

---

### 6.4 长期维护

#### 6.4.1 LTS 版本

```text
v1.x (LTS)  → 维护至 2026-12-31
v2.x (Current) → 当前稳定版
v3.x (Next) → 开发中
```

#### 6.4.2 向后兼容承诺

**承诺**：

- Major 版本至少维护 **2 年**
- 提前 **6 个月**通告弃用
- 提供自动化迁移工具

---

## 7. 实战案例

### 7.1 Serde 的版本策略

**特点**：

1. **MSRV 保守**：仅在 Major 版本更新
2. **Feature 隔离**：核心功能独立，扩展通过 Feature 启用
3. **错误消息优秀**：Span精准，帮助消息详细

**示例错误**：

```text
error: duplicate serde attribute `rename`
  --> src/lib.rs:5:14
   |
5  | #[serde(rename = "id", rename = "ID")]
   |                        ^^^^^^^^^^^^^^
   |
   = note: remove the duplicate attribute
```

---

### 7.2 Tokio 宏的错误诊断

**特点**：

1. **上下文丰富**：错误消息包含修复建议
2. **编译期检查**：尽可能在编译期捕获错误
3. **示例丰富**：文档包含大量实际用例

**示例错误**：

```text
error: the async fn must be inside a tokio runtime
  --> src/main.rs:3:1
   |
3  | async fn main() {
   | ^^^^^^^^^^^^^^^^
   |
   = help: consider using `#[tokio::main]` attribute:
           #[tokio::main]
           async fn main() {
               // ...
           }
```

---

## 8. 相关资源

### 8.1 工具

- **cargo-release**: 自动化发布流程
- **cargo-audit**: 安全审计
- **cargo-outdated**: 依赖更新检查
- **cliff**: 自动生成 Changelog

### 8.2 学习资源

- [Semantic Versioning](https://semver.org/)
- [Keep a Changelog](https://keepachangelog.com/)
- [Rust API Guidelines](https://rust-lang.github.io/api-guidelines/)
- [Serde Design](https://serde.rs/design.html)

---

**总结**：

- → 参考 [C11 主索引](../../02_主索引导航.md) 探索其他主题
- → 实践 [Tier 2 宏开发指南](../../tier_02_guides/README.md) 巩固知识
- → 查看 [Tier 1 核心概念](../../tier_01_core/README.md) 复习基础

---

*最后更新: 2025-10-23*
*版本: 1.0.0*
*作者: Rust 学习系统团队*
