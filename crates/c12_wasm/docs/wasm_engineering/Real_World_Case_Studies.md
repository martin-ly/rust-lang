# å®é™…é¡¹ç›®æ¡ˆä¾‹ (Real-World Case Studies)

## ğŸ“‹ ç›®å½•

- [å®é™…é¡¹ç›®æ¡ˆä¾‹ (Real-World Case Studies)](#å®é™…é¡¹ç›®æ¡ˆä¾‹-real-world-case-studies)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [æ ¸å¿ƒå‘½é¢˜](#æ ¸å¿ƒå‘½é¢˜)
  - [æ¡ˆä¾‹ 1: Figma - åœ¨çº¿è®¾è®¡å·¥å…·](#æ¡ˆä¾‹-1-figma---åœ¨çº¿è®¾è®¡å·¥å…·)
    - [èƒŒæ™¯](#èƒŒæ™¯)
    - [å®ç°ç»†èŠ‚](#å®ç°ç»†èŠ‚)
    - [æ€§èƒ½ç»“æœ](#æ€§èƒ½ç»“æœ)
    - [é‡åˆ°çš„å‘](#é‡åˆ°çš„å‘)
    - [å…³é”®ç»éªŒ](#å…³é”®ç»éªŒ)
  - [æ¡ˆä¾‹ 2: AutoCAD Web - CAD è®¾è®¡å·¥å…·](#æ¡ˆä¾‹-2-autocad-web---cad-è®¾è®¡å·¥å…·)
    - [èƒŒæ™¯2](#èƒŒæ™¯2)
    - [è¿ç§»ç­–ç•¥](#è¿ç§»ç­–ç•¥)
    - [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
    - [ä»£ç ç»„ç»‡](#ä»£ç ç»„ç»‡)
    - [å…³é”®æŒ‡æ ‡](#å…³é”®æŒ‡æ ‡)
  - [æ¡ˆä¾‹ 3: Zoom - è§†é¢‘ä¼šè®®èƒŒæ™¯è™šåŒ–](#æ¡ˆä¾‹-3-zoom---è§†é¢‘ä¼šè®®èƒŒæ™¯è™šåŒ–)
    - [æŠ€æœ¯æŒ‘æˆ˜](#æŠ€æœ¯æŒ‘æˆ˜)
    - [æŠ€æœ¯æ–¹æ¡ˆ](#æŠ€æœ¯æ–¹æ¡ˆ)
    - [æ€§èƒ½ä¼˜åŒ–2](#æ€§èƒ½ä¼˜åŒ–2)
    - [éƒ¨ç½²æŒ‘æˆ˜](#éƒ¨ç½²æŒ‘æˆ˜)
    - [ç»éªŒæ€»ç»“](#ç»éªŒæ€»ç»“)
  - [æ¡ˆä¾‹ 4: Shopify - å›¾ç‰‡å‹ç¼©æœåŠ¡](#æ¡ˆä¾‹-4-shopify---å›¾ç‰‡å‹ç¼©æœåŠ¡)
    - [ä¸šåŠ¡èƒŒæ™¯](#ä¸šåŠ¡èƒŒæ™¯)
    - [æŠ€æœ¯å®ç°](#æŠ€æœ¯å®ç°)
    - [æˆæœ¬èŠ‚çœ](#æˆæœ¬èŠ‚çœ)
    - [é‡åˆ°çš„æŒ‘æˆ˜](#é‡åˆ°çš„æŒ‘æˆ˜)
  - [é€šç”¨ç»éªŒæ€»ç»“](#é€šç”¨ç»éªŒæ€»ç»“)
    - [æˆåŠŸæ¨¡å¼](#æˆåŠŸæ¨¡å¼)
    - [å¤±è´¥æ¡ˆä¾‹](#å¤±è´¥æ¡ˆä¾‹)
  - [å†³ç­–æ ‘](#å†³ç­–æ ‘)
    - [ä½•æ—¶ä½¿ç”¨ Wasmï¼Ÿ](#ä½•æ—¶ä½¿ç”¨-wasm)
  - [æœ€ä½³å®è·µæ¸…å•](#æœ€ä½³å®è·µæ¸…å•)
    - [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
    - [æ€§èƒ½ä¼˜åŒ–1](#æ€§èƒ½ä¼˜åŒ–1)
    - [å¼€å‘æµç¨‹](#å¼€å‘æµç¨‹)
    - [éƒ¨ç½²ç­–ç•¥](#éƒ¨ç½²ç­–ç•¥)
  - [å‚è€ƒæ–‡çŒ®](#å‚è€ƒæ–‡çŒ®)
  - [ç›¸å…³æ–‡æ¡£](#ç›¸å…³æ–‡æ¡£)

## æ ¸å¿ƒå‘½é¢˜

**æ¡ˆä¾‹å­¦ä¹ ä»·å€¼**ï¼š
\[
\text{Learning}_{\text{case study}} > \text{Learning}_{\text{theory}} \quad (\text{å®è·µä¸­çš„çœŸç†})
\]

**å¤±è´¥æ•™è®­æƒé‡**ï¼š
\[
\text{Value}(\text{failure}) \geq 2 \times \text{Value}(\text{success})
\]

**æŠ€æœ¯å€ºåŠ¡ç´¯ç§¯**ï¼š
\[
\text{Debt}(t) = \text{Debt}_0 \times e^{r \cdot t} \quad (\text{æŒ‡æ•°å¢é•¿})
\]

---

## æ¡ˆä¾‹ 1: Figma - åœ¨çº¿è®¾è®¡å·¥å…·

### èƒŒæ™¯

**é—®é¢˜**ï¼š

- å¤æ‚çš„å›¾å½¢æ¸²æŸ“ï¼ˆæ•°ä¸‡å›¾å±‚ï¼‰
- å®æ—¶åä½œï¼ˆä½å»¶è¿Ÿè¦æ±‚ï¼‰
- è·¨å¹³å°ä¸€è‡´æ€§

**æŠ€æœ¯é€‰æ‹©**ï¼š

- C++ æ¸²æŸ“å¼•æ“ â†’ Wasm
- Canvas API æ¸²æŸ“
- SharedArrayBuffer å¤šçº¿ç¨‹

### å®ç°ç»†èŠ‚

**æ¶æ„**ï¼š

```text
JavaScript (UIé€»è¾‘)
     â†“
  Wasm (æ¸²æŸ“å¼•æ“)
     â†“
  Canvas 2D API
```

**ä»£ç ç‰‡æ®µ**ï¼ˆç®€åŒ–ï¼‰ï¼š

```cpp
// C++ æ¸²æŸ“æ ¸å¿ƒ
class RenderEngine {
public:
    void render_scene(Scene* scene, Canvas* canvas) {
        // åœºæ™¯å›¾éå†
        for (auto& layer : scene->layers) {
            if (layer->visible) {
                render_layer(layer, canvas);
            }
        }
    }

private:
    void render_layer(Layer* layer, Canvas* canvas) {
        // Wasm é«˜æ•ˆå‡ ä½•è¿ç®—
        auto transformed = apply_transforms(layer);

        // è°ƒç”¨ JS Canvas API
        canvas->draw_path(transformed.path, layer->style);
    }
};
```

**JS èƒ¶æ°´ä»£ç **ï¼š

```javascript
// é›¶æ‹·è´å†…å­˜å…±äº«
const memory = new WebAssembly.Memory({
  initial: 256,
  maximum: 512,
  shared: true,
});

const renderWorker = new Worker('render-worker.js');
renderWorker.postMessage({ memory, module: wasmModule });

// ä¸»çº¿ç¨‹å¤„ç† UI äº‹ä»¶
document.addEventListener('mousemove', (e) => {
  renderWorker.postMessage({
    type: 'mouse_move',
    x: e.clientX,
    y: e.clientY,
  });
});
```

### æ€§èƒ½ç»“æœ

**å¯¹æ¯”**ï¼š

| æŒ‡æ ‡ | çº¯ JavaScript | Wasm ç‰ˆæœ¬ | æ”¹è¿› |
|------|--------------|----------|------|
| æ¸²æŸ“ 1ä¸‡å›¾å±‚ | 850ms | 120ms | **7.1Ã—** |
| å†…å­˜å ç”¨ | 1.2 GB | 450 MB | **2.7Ã—** |
| é¦–æ¬¡åŠ è½½ | 3.5s | 1.8s | **1.9Ã—** |

### é‡åˆ°çš„å‘

**é—®é¢˜ 1: è·¨çº¿ç¨‹é€šä¿¡å¼€é”€**:

**ç—‡çŠ¶**ï¼š

- å¤šçº¿ç¨‹æ¸²æŸ“åè€Œæ›´æ…¢
- CPU åˆ©ç”¨ç‡ä¸è¶³ 30%

**åŸå› **ï¼š

- postMessage æ‹·è´å¼€é”€å¤§
- çº¿ç¨‹é—´åŒæ­¥é”ç«äº‰

**è§£å†³æ–¹æ¡ˆ**ï¼š

```javascript
// ä½¿ç”¨ SharedArrayBuffer + Atomics
const sharedBuffer = new SharedArrayBuffer(4096);
const view = new Int32Array(sharedBuffer);

// ä¸»çº¿ç¨‹å†™å…¥ä»»åŠ¡
Atomics.store(view, 0, taskId);
Atomics.notify(view, 0, 1);

// Worker è¯»å–ä»»åŠ¡
Atomics.wait(view, 0, 0);
const task = Atomics.load(view, 0);
```

**é—®é¢˜ 2: Wasm å†…å­˜å¢é•¿å¯¼è‡´å¡é¡¿**:

**ç—‡çŠ¶**ï¼š

- å†…å­˜å¢é•¿æ—¶ç•Œé¢å†»ç»“
- ç”¨æˆ·ä½“éªŒæ˜¾è‘—ä¸‹é™

**åŸå› **ï¼š

- Wasm å†…å­˜å¢é•¿éœ€è¦åŒæ­¥æ“ä½œ
- æµè§ˆå™¨éœ€è¦é‡æ–°åˆ†é…å¤§å—å†…å­˜

**è§£å†³æ–¹æ¡ˆ**ï¼š

```cpp
// é¢„åˆ†é…è¶³å¤Ÿå†…å­˜
__attribute__((constructor))
void init_memory() {
    // å¯åŠ¨æ—¶åˆ†é… 256MB
    void* large_buffer = malloc(256 * 1024 * 1024);
    // é˜²æ­¢è¢«ä¼˜åŒ–æ‰
    volatile char* p = (volatile char*)large_buffer;
    *p = 0;
}
```

### å…³é”®ç»éªŒ

âœ… **æˆåŠŸå› ç´ **ï¼š

1. ä¸“æ³¨äºè®¡ç®—å¯†é›†å‹éƒ¨åˆ†ï¼ˆæ¸²æŸ“ï¼‰
2. å……åˆ†åˆ©ç”¨ Canvas APIï¼ˆé¿å…é‡æ–°å‘æ˜è½®å­ï¼‰
3. æ¸è¿›å¼è¿ç§»ï¼ˆå…ˆè¿ç§»çƒ­ç‚¹å‡½æ•°ï¼‰

âš ï¸ **é¿å‘æŒ‡å—**ï¼š

1. ä¸è¦è¿‡æ—©ä¼˜åŒ–ï¼ˆå…ˆ profile å†é‡å†™ï¼‰
2. æ³¨æ„ JS â†” Wasm è¾¹ç•Œå¼€é”€
3. é¢„åˆ†é…å†…å­˜é¿å…è¿è¡Œæ—¶å¢é•¿

---

## æ¡ˆä¾‹ 2: AutoCAD Web - CAD è®¾è®¡å·¥å…·

### èƒŒæ™¯2

**æŒ‘æˆ˜**ï¼š

- 30 å¹´å†å²çš„ C++ ä»£ç åº“
- æ•°ç™¾ä¸‡è¡Œä»£ç 
- å¤æ‚çš„ 3D å‡ ä½•è¿ç®—

**ç›®æ ‡**ï¼š

- å°†æ¡Œé¢åº”ç”¨ç§»æ¤åˆ° Web
- ä¿æŒ 90% ä»¥ä¸Šæ€§èƒ½
- ä»£ç å¤ç”¨ç‡ > 80%

### è¿ç§»ç­–ç•¥

**Phase 1: æ ¸å¿ƒå¼•æ“è¿ç§»**:

```bash
# Emscripten ç¼–è¯‘
emcc src/geometry/*.cpp src/renderer/*.cpp \
    -s WASM=1 -s ALLOW_MEMORY_GROWTH=1 \
    -s MODULARIZE=1 -s EXPORT_ES6=1 \
    -s EXPORTED_FUNCTIONS='["_compute_intersection", "_render_scene"]' \
    -O3 -o autocad-core.js
```

**Phase 2: UI å±‚é‡å†™**:

- React + Three.js (æ–° UI)
- Wasm æ ¸å¿ƒå¼•æ“ï¼ˆå¤ç”¨ï¼‰
- WebGL æ¸²æŸ“ï¼ˆæ›¿ä»£ DirectXï¼‰

**Phase 3: å¢é‡åŠ è½½**:

```javascript
// æŒ‰éœ€åŠ è½½æ¨¡å—
async function loadModule(name) {
  const response = await fetch(`/modules/${name}.wasm`);
  const buffer = await response.arrayBuffer();
  const module = await WebAssembly.instantiate(buffer, imports);
  return module.instance.exports;
}

// å»¶è¿ŸåŠ è½½éæ ¸å¿ƒåŠŸèƒ½
document.getElementById('open-file').addEventListener('click', async () => {
  if (!fileModule) {
    fileModule = await loadModule('file-io');
  }
  fileModule.open_dialog();
});
```

### æ€§èƒ½ä¼˜åŒ–

**é—®é¢˜: å¤§æ–‡ä»¶åŠ è½½æ…¢**:

**åˆç‰ˆæ€§èƒ½**ï¼š

- æ‰“å¼€ 100MB DWG æ–‡ä»¶ï¼š45 ç§’
- ç”¨æˆ·ç­‰å¾…ä¸å¯æ¥å—

**ä¼˜åŒ– 1: æµå¼è§£æ**:

```cpp
class StreamingParser {
public:
    void parse_chunk(const uint8_t* data, size_t len) {
        buffer_.insert(buffer_.end(), data, data + len);

        while (buffer_.size() >= MIN_CHUNK_SIZE) {
            auto entity = parse_entity(buffer_);
            if (entity) {
                emit_entity(entity);
                buffer_.erase(buffer_.begin(), buffer_.begin() + entity->size);
            } else {
                break;  // éœ€è¦æ›´å¤šæ•°æ®
            }
        }
    }
};
```

**ä¼˜åŒ– 2: Web Worker å¹¶è¡Œ**:

```javascript
// ä¸»çº¿ç¨‹
const workers = Array.from({ length: navigator.hardwareConcurrency }, () =>
  new Worker('parser-worker.js')
);

const chunks = splitFileIntoChunks(fileBuffer);
const results = await Promise.all(
  chunks.map((chunk, i) => workers[i % workers.length].parse(chunk))
);
```

**æœ€ç»ˆæ€§èƒ½**ï¼š

- æ‰“å¼€ 100MB æ–‡ä»¶ï¼š**8 ç§’** (5.6Ã— æå‡)
- ç”¨æˆ·ä½“éªŒå¯æ¥å—

### ä»£ç ç»„ç»‡

**ç›®å½•ç»“æ„**ï¼š

```text
autocad-web/
â”œâ”€â”€ core/                 # C++ æ ¸å¿ƒï¼ˆç¼–è¯‘ä¸º Wasmï¼‰
â”‚   â”œâ”€â”€ geometry/
â”‚   â”œâ”€â”€ renderer/
â”‚   â”œâ”€â”€ file-io/
â”‚   â””â”€â”€ algorithms/
â”œâ”€â”€ web/                  # JavaScript UI
â”‚   â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ workers/
â”‚   â””â”€â”€ wasm-bindings/    # Wasm å°è£…
â”œâ”€â”€ build/
â”‚   â”œâ”€â”€ emscripten.sh     # æ„å»ºè„šæœ¬
â”‚   â””â”€â”€ optimize.sh       # ä¼˜åŒ–æµæ°´çº¿
â””â”€â”€ tests/
    â”œâ”€â”€ unit/             # C++ å•å…ƒæµ‹è¯•
    â””â”€â”€ integration/      # JS + Wasm é›†æˆæµ‹è¯•
```

### å…³é”®æŒ‡æ ‡

**å¼€å‘æˆæœ¬**ï¼š

- å·¥ç¨‹å¸ˆï¼š15 äºº
- æ—¶é—´ï¼š18 ä¸ªæœˆ
- ä»£ç å¤ç”¨ï¼š**85%**ï¼ˆC++ æ ¸å¿ƒä»£ç ï¼‰

**è¿è¡Œæ€§èƒ½**ï¼š

| æ“ä½œ | æ¡Œé¢ç‰ˆ | Web ç‰ˆ | æ¯”ç‡ |
|------|-------|--------|------|
| æ‰“å¼€æ–‡ä»¶ | 5s | 8s | 0.63 |
| æ¸²æŸ“åœºæ™¯ | 16ms | 22ms | 0.73 |
| å‡ ä½•è¿ç®— | 100% | 92% | 0.92 |

**æ‰¹åˆ¤**ï¼š
> AutoCAD Web è¯æ˜äº†å¤æ‚æ¡Œé¢åº”ç”¨å¯ä»¥è¿ç§»åˆ° Webï¼Œä½†æ€§èƒ½ä»æœ‰ 10-40% æŸå¤±ã€‚å¯¹äºä¸“ä¸šç”¨æˆ·ï¼Œæ¡Œé¢ç‰ˆä»æ˜¯é¦–é€‰ã€‚

---

## æ¡ˆä¾‹ 3: Zoom - è§†é¢‘ä¼šè®®èƒŒæ™¯è™šåŒ–

### æŠ€æœ¯æŒ‘æˆ˜

**å®æ—¶è¦æ±‚**ï¼š

- 1080p @ 30fps
- å»¶è¿Ÿ < 33ms/å¸§
- CPU å ç”¨ < 50%

**ç®—æ³•å¤æ‚åº¦**ï¼š

- è¯­ä¹‰åˆ†å‰²ï¼ˆäººåƒæŠ å›¾ï¼‰
- è¾¹ç¼˜ç¾½åŒ–
- èƒŒæ™¯æ›¿æ¢/æ¨¡ç³Š

### æŠ€æœ¯æ–¹æ¡ˆ

**æ¶æ„**ï¼š

```text
Video Stream â†’ Wasm (AI æ¨ç†) â†’ Canvas (åˆæˆ) â†’ Output
```

**Wasm æ¨¡å—**ï¼š

```cpp
// TensorFlow Lite â†’ Wasm
class BackgroundSegmenter {
private:
    // tflite is the TensorFlow Lite C++ namespace
    std::unique_ptr<tflite::Interpreter> interpreter_;

public:
    void process_frame(const uint8_t* rgba, uint8_t* mask) {
        // 1. é¢„å¤„ç†
        auto input = preprocess(rgba);

        // 2. æ¨ç†
        interpreter_->SetInputs({input});
        interpreter_->Invoke();
        auto output = interpreter_->GetOutput(0);

        // 3. åå¤„ç†
        postprocess(output, mask);
    }

private:
    Tensor preprocess(const uint8_t* rgba) {
        // RGB å½’ä¸€åŒ–åˆ° [-1, 1]
        Tensor input(1, 256, 256, 3);
        for (int i = 0; i < input.size(); i++) {
            input[i] = (rgba[i] / 255.0f - 0.5f) * 2.0f;
        }
        return input;
    }
};
```

**WebGL åŠ é€Ÿ**ï¼š

```javascript
// è¾¹ç¼˜ç¾½åŒ–ï¼ˆGPUï¼‰
const featherShader = `
  precision highp float;
  uniform sampler2D mask;
  uniform vec2 resolution;
  varying vec2 vUv;

  void main() {
    vec2 texel = 1.0 / resolution;
    float sum = 0.0;

    // Gaussian blur
    for (int x = -2; x <= 2; x++) {
      for (int y = -2; y <= 2; y++) {
        vec2 offset = vec2(float(x), float(y)) * texel;
        sum += texture2D(mask, vUv + offset).r * kernel[abs(x)][abs(y)];
      }
    }

    gl_FragColor = vec4(sum, sum, sum, 1.0);
  }
`;
```

### æ€§èƒ½ä¼˜åŒ–2

**é—®é¢˜: CPU å ç”¨è¿‡é«˜**:

**Profile ç»“æœ**ï¼š

```text
Total: 45ms/frame (æ— æ³•è¾¾åˆ° 30fps)
â”œâ”€ AI æ¨ç†: 28ms (62%)
â”œâ”€ å›¾åƒæ‹·è´: 10ms (22%)
â”œâ”€ è¾¹ç¼˜å¤„ç†: 5ms (11%)
â””â”€ åˆæˆ: 2ms (5%)
```

**ä¼˜åŒ–ç­–ç•¥**ï¼š

1. **é™é‡‡æ ·**ï¼š

   ```cpp
   // ä» 1080p é™åˆ° 256Ã—144 æ¨ç†
   auto downsampled = resize(input, 256, 144);
   auto mask_low = segment(downsampled);
   auto mask_high = upsample(mask_low, 1920, 1080);
   ```

2. **SIMD åŠ é€Ÿ**ï¼š

   ```cpp
   // ä½¿ç”¨ Wasm SIMD
   #include <wasm_simd128.h>

   void process_pixels_simd(const uint8_t* src, uint8_t* dst, size_t len) {
       for (size_t i = 0; i < len; i += 16) {
           v128_t pixels = wasm_v128_load(&src[i]);
           v128_t processed = wasm_i8x16_add_sat_u(pixels, wasm_i8x16_splat(10));
           wasm_v128_store(&dst[i], processed);
       }
   }
   ```

3. **å¤šçº¿ç¨‹**ï¼š

   ```javascript
   // 4 ä¸ª Worker å¹¶è¡Œå¤„ç†
   const workers = createWorkerPool(4);

   async function processFrame(frame) {
       const tiles = splitIntoTiles(frame, 2, 2);  // 2Ã—2 ç½‘æ ¼
       const results = await Promise.all(
           tiles.map((tile, i) => workers[i].process(tile))
       );
       return mergeResults(results);
   }
   ```

**æœ€ç»ˆæ€§èƒ½**ï¼š

- å¤„ç†æ—¶é—´ï¼š**18ms/frame**
- CPU å ç”¨ï¼š**35%**
- è¾¾åˆ° 30fps è¦æ±‚ âœ…

### éƒ¨ç½²æŒ‘æˆ˜

**é—®é¢˜: æ¨¡å‹æ–‡ä»¶è¿‡å¤§**:

**åˆç‰ˆ**ï¼š

- æ¨¡å‹å¤§å°ï¼š15 MB
- é¦–æ¬¡åŠ è½½ï¼š8 ç§’ï¼ˆä¸å¯æ¥å—ï¼‰

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

```bash
# æ¨¡å‹é‡åŒ–ï¼ˆFloat32 â†’ Int8ï¼‰
python quantize_model.py --input model.tflite --output model_q.tflite

# å¤§å°å¯¹æ¯”
# model.tflite:    15 MB
# model_q.tflite:   4 MB  (73% å‡å°‘)

# ç²¾åº¦æŸå¤±ï¼š< 2%ï¼ˆå¯æ¥å—ï¼‰
```

**æ¸è¿›å¼åŠ è½½**ï¼š

```javascript
// å…ˆåŠ è½½ä½è´¨é‡æ¨¡å‹
const quickModel = await loadModel('model_quick.wasm');  // 1 MB
startProcessing(quickModel);

// åå°åŠ è½½é«˜è´¨é‡æ¨¡å‹
loadModel('model_full.wasm').then(fullModel => {
  replaceModel(fullModel);  // æ— ç¼åˆ‡æ¢
});
```

### ç»éªŒæ€»ç»“

âœ… **æˆåŠŸç‚¹**ï¼š

1. SIMD æŒ‡ä»¤å¸¦æ¥ 2-3Ã— æå‡
2. é™é‡‡æ ·æ˜¾è‘—é™ä½è®¡ç®—é‡
3. é‡åŒ–æ¨¡å‹å¹³è¡¡äº†å¤§å°ä¸ç²¾åº¦

âš ï¸ **æ•™è®­**ï¼š

1. åˆæœŸè¿‡åº¦ä¼˜åŒ–æ¨¡å‹ç²¾åº¦ï¼ˆç”¨æˆ·æ„ŸçŸ¥ä¸åˆ°ï¼‰
2. ä½ä¼°äº†å¤šçº¿ç¨‹åŒæ­¥å¼€é”€
3. æœªè€ƒè™‘ä½ç«¯è®¾å¤‡æ€§èƒ½

---

## æ¡ˆä¾‹ 4: Shopify - å›¾ç‰‡å‹ç¼©æœåŠ¡

### ä¸šåŠ¡èƒŒæ™¯

**è§„æ¨¡**ï¼š

- å¤„ç†é‡ï¼šæ¯å¤© 1 äº¿+ å›¾ç‰‡
- å›¾ç‰‡å¤§å°ï¼šå¹³å‡ 5 MB
- å­˜å‚¨æˆæœ¬ï¼šæ¯æœˆ $50,000+

**ç›®æ ‡**ï¼š

- åœ¨å®¢æˆ·ç«¯å‹ç¼©ï¼ˆèŠ‚çœå¸¦å®½ï¼‰
- å‹ç¼©æ¯” > 70%
- è§†è§‰è´¨é‡æŸå¤± < 5%

### æŠ€æœ¯å®ç°

**Wasm å‹ç¼©åº“**ï¼š

```cpp
// MozJPEG â†’ Wasm
class ImageCompressor {
public:
    std::vector<uint8_t> compress(
        const uint8_t* rgba,
        int width,
        int height,
        int quality
    ) {
        // MozJPEG å‹ç¼©
        jpeg_compress_struct cinfo;
        jpeg_create_compress(&cinfo);

        // é…ç½®
        cinfo.image_width = width;
        cinfo.image_height = height;
        cinfo.input_components = 3;
        cinfo.in_color_space = JCS_RGB;

        jpeg_set_defaults(&cinfo);
        jpeg_set_quality(&cinfo, quality, TRUE);

        // å‹ç¼©
        jpeg_start_compress(&cinfo, TRUE);
        // ... å‹ç¼©é€»è¾‘
        jpeg_finish_compress(&cinfo);

        return output;
    }
};
```

**å‰ç«¯é›†æˆ**ï¼š

```javascript
// æ–‡ä»¶ä¸Šä¼ æ—¶è‡ªåŠ¨å‹ç¼©
document.getElementById('upload').addEventListener('change', async (e) => {
  const file = e.target.files[0];
  console.log(`Original: ${(file.size / 1024 / 1024).toFixed(2)} MB`);

  // Wasm å‹ç¼©
  const compressed = await wasmCompressor.compress(file, { quality: 85 });
  console.log(`Compressed: ${(compressed.size / 1024 / 1024).toFixed(2)} MB`);

  // ä¸Šä¼ å‹ç¼©åçš„æ–‡ä»¶
  uploadToServer(compressed);
});
```

### æˆæœ¬èŠ‚çœ

**å¯¹æ¯”åˆ†æ**ï¼š

| æ–¹æ¡ˆ | å¸¦å®½æˆæœ¬ | å­˜å‚¨æˆæœ¬ | æ€»æˆæœ¬/æœˆ |
|------|---------|---------|----------|
| åŸå§‹æ–¹æ¡ˆ | $80,000 | $50,000 | **$130,000** |
| æœåŠ¡ç«¯å‹ç¼© | $50,000 | $15,000 | **$65,000** |
| å®¢æˆ·ç«¯ Wasm | $15,000 | $15,000 | **$30,000** |

**ROI**ï¼š

- èŠ‚çœï¼š**$100,000/æœˆ**
- å¼€å‘æˆæœ¬ï¼š$80,000ï¼ˆå·¥ç¨‹å¸ˆ 2äºº Ã— 2æœˆï¼‰
- å›æœ¬å‘¨æœŸï¼š**< 1ä¸ªæœˆ**

### é‡åˆ°çš„æŒ‘æˆ˜

**é—®é¢˜: ç§»åŠ¨è®¾å¤‡æ€§èƒ½ä¸è¶³**:

**ç—‡çŠ¶**ï¼š

- iPhone 6 å‹ç¼© 5MB å›¾ç‰‡éœ€ 15 ç§’
- å¯¼è‡´åº”ç”¨æ— å“åº”

**è§£å†³æ–¹æ¡ˆ**ï¼š

```javascript
// è®¾å¤‡è‡ªé€‚åº”
function getCompressionQuality() {
  const memory = navigator.deviceMemory || 4;
  const cores = navigator.hardwareConcurrency || 2;

  if (memory < 2 || cores < 2) {
    return 70;  // ä½ç«¯è®¾å¤‡ï¼šå¿«é€Ÿå‹ç¼©
  } else if (memory < 4) {
    return 80;  // ä¸­ç«¯è®¾å¤‡ï¼šå¹³è¡¡
  } else {
    return 90;  // é«˜ç«¯è®¾å¤‡ï¼šé«˜è´¨é‡
  }
}

// Web Worker é˜²æ­¢ UI é˜»å¡
const worker = new Worker('compressor-worker.js');
worker.postMessage({ image, quality: getCompressionQuality() });
```

---

## é€šç”¨ç»éªŒæ€»ç»“

### æˆåŠŸæ¨¡å¼

**1. è®¡ç®—å¯†é›†å‹åœºæ™¯**:

- å›¾åƒ/è§†é¢‘å¤„ç†
- æ•°æ®å‹ç¼©/è§£å‹
- ç§‘å­¦è®¡ç®—
- æ¸¸æˆç‰©ç†å¼•æ“

**2. ä»£ç å¤ç”¨åœºæ™¯**:

- æ¡Œé¢åº”ç”¨è¿ç§»
- è·¨å¹³å°ä¸€è‡´æ€§
- ç®—æ³•åº“ç§»æ¤

**3. æ€§èƒ½å…³é”®åœºæ™¯**:

- å®æ—¶æ¸²æŸ“
- å¤§æ•°æ®å¤„ç†
- æœºå™¨å­¦ä¹ æ¨ç†

### å¤±è´¥æ¡ˆä¾‹

**åæ¨¡å¼ 1: è¿‡åº¦å·¥ç¨‹åŒ–**:

**æ¡ˆä¾‹**ï¼šæŸå…¬å¸å°†æ•´ä¸ª Node.js åº”ç”¨ç¼–è¯‘ä¸º Wasm

**é—®é¢˜**ï¼š

- æ–‡ä»¶å¤§å°ï¼š120 MBï¼ˆä¸å¯æ¥å—ï¼‰
- å¯åŠ¨æ—¶é—´ï¼š30 ç§’
- è°ƒè¯•å›°éš¾

**æ•™è®­**ï¼š
> Wasm ä¸æ˜¯ä¸‡èƒ½è¯ã€‚ç®€å•çš„ä¸šåŠ¡é€»è¾‘ç”¨ JavaScript æ›´åˆé€‚ã€‚

**åæ¨¡å¼ 2: å¿½ç•¥ JS â†” Wasm è¾¹ç•Œå¼€é”€**:

**æ¡ˆä¾‹**ï¼šé¢‘ç¹è°ƒç”¨ Wasm å‡½æ•°å¤„ç†å°æ•°æ®

```javascript
// âŒ é”™è¯¯ï¼šé¢‘ç¹è·¨è¾¹ç•Œ
for (let i = 0; i < 1000000; i++) {
  result[i] = wasmModule.process(data[i]);  // æ¯æ¬¡è°ƒç”¨ 1Î¼s å¼€é”€
}
// æ€»å¼€é”€ï¼š1 ç§’ï¼ˆçº¯ç²¹æµªè´¹åœ¨è°ƒç”¨ä¸Šï¼‰

// âœ… æ­£ç¡®ï¼šæ‰¹é‡å¤„ç†
const result = wasmModule.processBatch(data);  // å•æ¬¡è°ƒç”¨
```

**åæ¨¡å¼ 3: ç›²ç›®ä½¿ç”¨ Wasm**:

**æ¡ˆä¾‹**ï¼šä¸€ä¸ªç®€å•çš„è¡¨å•éªŒè¯é€»è¾‘ä¹Ÿç”¨ Wasm

**é—®é¢˜**ï¼š

- å¢åŠ äº† 200 KB æ–‡ä»¶å¤§å°
- æ€§èƒ½åè€Œä¸‹é™ï¼ˆåŠ è½½å¼€é”€ï¼‰
- ç»´æŠ¤æˆæœ¬å¢åŠ 

**æ•™è®­**ï¼š
> å…ˆ profileï¼Œè¯æ˜ç“¶é¢ˆï¼Œå†é‡å†™ã€‚ä¸è¦ä¸ºäº† Wasm è€Œ Wasmã€‚

---

## å†³ç­–æ ‘

### ä½•æ—¶ä½¿ç”¨ Wasmï¼Ÿ

```text
æ˜¯å¦è®¡ç®—å¯†é›†å‹ï¼Ÿ
â”œâ”€ å¦ â†’ ä½¿ç”¨ JavaScript
â””â”€ æ˜¯ â†’ æ˜¯å¦é¢‘ç¹è·¨è¾¹ç•Œï¼Ÿ
    â”œâ”€ æ˜¯ â†’ é‡æ–°è®¾è®¡æ¥å£ or ä½¿ç”¨ JavaScript
    â””â”€ å¦ â†’ æ˜¯å¦æœ‰ç°æˆ C/C++/Rust ä»£ç ï¼Ÿ
        â”œâ”€ æ˜¯ â†’ âœ… ä½¿ç”¨ Wasm
        â””â”€ å¦ â†’ æ€§èƒ½æ”¶ç›Š > å¼€å‘æˆæœ¬ï¼Ÿ
            â”œâ”€ æ˜¯ â†’ âœ… ä½¿ç”¨ Wasm
            â””â”€ å¦ â†’ ä½¿ç”¨ JavaScript
```

---

## æœ€ä½³å®è·µæ¸…å•

### æ¶æ„è®¾è®¡

- [ ] æœ€å°åŒ– JS â†” Wasm è¾¹ç•Œè·¨è¶Š
- [ ] ä½¿ç”¨ SharedArrayBuffer å…±äº«å¤§å—æ•°æ®
- [ ] Web Worker éš”ç¦»è®¡ç®—å¯†é›†å‹ä»»åŠ¡
- [ ] æ¸è¿›å¼åŠ è½½ï¼ˆå…ˆå°æ¨¡å—å†å¤§æ¨¡å—ï¼‰

### æ€§èƒ½ä¼˜åŒ–1

- [ ] Profile é©±åŠ¨ä¼˜åŒ–ï¼ˆä¸è¦çŒœæµ‹ï¼‰
- [ ] SIMD åŠ é€Ÿå…³é”®å¾ªç¯
- [ ] é¢„åˆ†é…å†…å­˜é¿å…è¿è¡Œæ—¶å¢é•¿
- [ ] å¤šçº¿ç¨‹å¹¶è¡Œï¼ˆå¦‚æœä»»åŠ¡å¯åˆ†è§£ï¼‰

### å¼€å‘æµç¨‹

- [ ] è°ƒè¯•æ„å»º vs å‘å¸ƒæ„å»ºåˆ†ç¦»
- [ ] è‡ªåŠ¨åŒ–æµ‹è¯•è¦†ç›– Wasm æ¨¡å—
- [ ] CI/CD é›†æˆ wasm-validate
- [ ] ç›‘æ§ç”Ÿäº§ç¯å¢ƒæ€§èƒ½æŒ‡æ ‡

### éƒ¨ç½²ç­–ç•¥

- [ ] ä½¿ç”¨ Brotli å‹ç¼© Wasm æ–‡ä»¶
- [ ] CDN åˆ†å‘ï¼ˆå‡å°‘å»¶è¿Ÿï¼‰
- [ ] ç‰ˆæœ¬åŒ– URLï¼ˆç¼“å­˜å‹å¥½ï¼‰
- [ ] é™çº§æ–¹æ¡ˆï¼ˆWasm ä¸å¯ç”¨æ—¶ï¼‰

---

## å‚è€ƒæ–‡çŒ®

1. **[Figma]** Evan Wallace. "WebAssembly at Figma" (2020)
2. **[Autodesk]** AutoCAD Web: Technical White Paper (2021)
3. **[Shopify]** "Client-Side Image Compression with WebAssembly" (2022)

---

## ç›¸å…³æ–‡æ¡£

- **[09.1 å¼€å‘å·¥å…·é“¾](09.1_Development_Toolchain.md)** - å·¥å…·é€‰å‹
- **[09.2 æµ‹è¯•ç­–ç•¥](09.2_Testing_Strategies.md)** - è´¨é‡ä¿è¯
- **[05 åº”ç”¨æ¨¡å¼](../05_Application_Patterns/)** - åº”ç”¨åœºæ™¯åˆ†ç±»
- **[07.3 æˆæœ¬æ”¶ç›Šåˆ†æ](../07_Engineering_Economics/07.3_Cost_Benefit_Analysis.md)** - ROI è®¡ç®—
