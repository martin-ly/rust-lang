# C12 WASM - 完整代码示例索引

> **文档类型**: 实践参考
> **文档定位**: 所有代码示例的索引和说明
> **项目状态**: ✅ 完整完成

**最后更新**: 2025-10-30
**适用版本**: Rust 1.90+ / Edition 2024, WASM 2.0 + WASI 0.2

---

## 📋 代码示例位置

### 1. 基础示例 (`src/lib.rs`)

包含以下模块：

- **basic_examples**: 基础函数示例
  - `add()` - 简单的加法函数
  - `greet()` - 字符串问候函数
  - `sum_array()` - 数组求和

- **complex_types**: 复杂类型示例
  - `Counter` - 计数器结构体
  - `Person` - 人员信息结构体

- **array_examples**: 数组操作示例
  - `calculate_average()` - 计算平均值
  - `find_max()` - 查找最大值
  - `reverse_array()` - 反转数组
  - `filter_even()` - 过滤偶数

- **string_examples**: 字符串操作示例
  - `reverse_string()` - 反转字符串
  - `is_palindrome()` - 检查回文
  - `count_words()` - 统计单词数
  - `to_uppercase()` - 转换为大写

- **performance_examples**: 性能优化示例
  - `process_bytes_optimized()` - 优化的字节处理（重用缓冲区）
  - `create_preallocated_vector()` - 预分配向量

- **error_examples**: 错误处理示例
  - `safe_divide()` - 安全的除法运算
  - `validate_string()` - 验证字符串长度

### 2. WASI 示例 (`src/wasi_examples.rs`)

包含以下模块：

- **file_operations**: 文件操作示例
  - `read_file()` - 读取文件
  - `write_file()` - 写入文件
  - `copy_file()` - 复制文件
  - `list_directory()` - 列出目录内容

- **cli_examples**: 命令行示例
  - `get_args()` - 获取命令行参数
  - `get_env_var()` - 获取环境变量
  - `get_current_dir()` - 获取当前目录

- **text_processor**: 文本处理示例
  - `count_lines()` - 统计行数
  - `count_words()` - 统计单词数
  - `count_chars()` - 统计字符数
  - `to_uppercase()` / `to_lowercase()` - 大小写转换

### 3. WASI 应用程序 (`src/bin/wasi_app.rs`)

完整的 WASI 应用程序示例，展示了如何：

- 读取命令行参数
- 读取文件
- 处理文本
- 输出结果

### 3. 生态库示例 (`src/ecosystem_examples.rs`) ⭐ NEW

包含以下模块：

- **rust_190_features**: Rust 1.90 新特性示例
  - `process_data_with_let_else()` - let-else 模式示例
  - `get_filtered_numbers()` - return-position impl Trait 示例

- **design_patterns**: 设计模式示例
  - **factory**: 工厂模式（渲染器创建）
  - **builder**: 建造者模式（配置构建）
  - **singleton**: 单例模式（使用 OnceLock）
  - **observer**: 观察者模式（事件通知）
  - **strategy**: 策略模式（排序算法）
  - **adapter**: 适配器模式（数据格式转换）

每个设计模式都包含：

- Rust 实现代码
- WASM 绑定代码
- JavaScript 使用示例
- 测试用例

### 4. WasmEdge 示例 (`src/wasmedge_examples.rs`) ⭐ NEW

包含以下模块：

- **wasmedge_advanced**: WasmEdge 高级特性
  - `run_http_server()` - HTTP 服务器示例
  - `process_large_file()` - 高性能文件处理（零拷贝）
  - `efficient_data_processing()` - 内存管理优化

- **wasi_nn_examples**: WASI-NN AI 推理示例
  - `ImageClassifier` - 图像分类器
  - `TextProcessor` - 文本处理器（AI 模型）

- **wasi_crypto_examples**: WASI-Crypto 示例
  - `encrypt_data()` - 数据加密
  - `hash_data()` - 数据哈希
  - `sign_data()` - 数字签名
  - `verify_signature()` - 签名验证

- **threading_examples**: 多线程 WASM 示例
  - `parallel_process()` - 并行数据处理
  - `ThreadPool` - 线程池实现

- **performance_examples**: WasmEdge 性能优化
  - `process_with_reuse()` - 缓冲区重用
  - `batch_process()` - 批量处理

- **cloud_native_examples**: 云原生应用示例
  - `edge_function()` - 边缘计算函数
  - `Microservice` - 微服务示例

每个示例都包含：

- 详细的文档注释
- WasmEdge 运行命令
- 性能说明
- 使用场景说明

---

### 1. 编译为 WASM（浏览器）

```bash
# 编译库
wasm-pack build --target web

# 在 JavaScript 中使用
import { add, greet, Counter } from './pkg/c12_wasm.js';
```

### 2. 编译为 WASI（本地运行）

```bash
# 添加 WASI 目标
rustup target add wasm32-wasi

# 编译 WASI 应用程序
cargo build --target wasm32-wasi --release

# 使用 WasmEdge 运行
wasmedge target/wasm32-wasi/release/wasi-app.wasm input.txt
```

### 3. 运行生态库示例

```bash
# 查看生态库示例代码
cat src/ecosystem_examples.rs

# 运行设计模式测试
cargo test design_patterns

# 运行 Rust 1.90 特性测试
cargo test rust_190_features
```

### 4. 运行 WasmEdge 示例

```bash
# 查看 WasmEdge 示例代码
cat src/wasmedge_examples.rs

# 编译到 WASI
cargo build --target wasm32-wasi --release

# 使用 WasmEdge 运行（启用 WASI-NN）
wasmedge --enable-wasi-nn \
  --enable-wasi-nn-tensorflow \
  target/wasm32-wasi/release/app.wasm

# 使用 WasmEdge 运行（启用多线程）
wasmedge --enable-threads app.wasm

# 使用 WasmEdge 运行（启用 WASI-Crypto）
wasmedge --enable-wasi-crypto app.wasm
```

---

- ✅ 详细的文档注释
- ✅ 参数说明
- ✅ 返回值说明
- ✅ 使用示例
- ✅ 性能说明（如适用）
- ✅ 错误处理示例

---

**文档维护**: Documentation Team
**创建日期**: 2025-10-30
**适用版本**: Rust 1.90+ / Edition 2024, WASM 2.0 + WASI 0.2
