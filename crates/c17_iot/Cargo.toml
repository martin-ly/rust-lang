[package]
name = "c17_iot"
edition = "2024"
resolver = "3"
rust-version = "1.89"

[dependencies]
serde = { workspace = true }
serde_json = { workspace = true }
thiserror = { workspace = true }
tokio = { workspace = true }
uuid = { workspace = true }
chrono = { workspace = true }
async-trait = "0.1"
rdkafka = { version = "0.38.0", optional = true, features = ["tokio", "cmake-build"] }
influxdb2 = { version = "0.4.0", optional = true }
openssl = { version = "0.10.0", optional = true, features = ["vendored"] }

[dev-dependencies]
rumqttc = "0.25.0"
coap-lite = "0.13.0"
opentelemetry = { workspace = true }
opentelemetry_sdk = { workspace = true }
opentelemetry-stdout = { workspace = true }
opentelemetry-otlp = { workspace = true }
tonic = { workspace = true }
tower = { workspace = true }
anyhow = { workspace = true }
sha2 = { workspace = true }
hex = { workspace = true }
hyper = { workspace = true, features = ["full"] }
hyper-util = { workspace = true }
http = { workspace = true }
prometheus = { workspace = true }
rustls = { workspace = true }
rustls-pemfile = { workspace = true }

[features]
default = []
kafka = ["dep:rdkafka"]
influx = ["dep:influxdb2"]
openssl-examples = ["dep:openssl"]

[[example]]
name = "kafka_producer"
path = "examples/kafka_producer.rs"
required-features = ["kafka"]

[[example]]
name = "influx_write"
path = "examples/influx_write.rs"
required-features = ["influx"]

[[example]]
name = "coap_dtls_openssl"
path = "examples/coap_dtls_openssl.rs"
required-features = ["openssl-examples"]

[[example]]
name = "coap_dtls"
path = "examples/coap_dtls.rs"