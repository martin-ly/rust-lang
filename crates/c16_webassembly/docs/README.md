# Rust WebAssembly ç³»ç»Ÿæ–‡æ¡£ä¸­å¿ƒ

## ğŸ“‹ æ¨¡å—æ¦‚è¿°

c16_webassembly æ˜¯ä¸€ä¸ªåŸºäº Rust 1.89 ç‰¹æ€§çš„ WebAssembly 2.0 é›†æˆé¡¹ç›®ï¼Œæä¾›äº†å®Œæ•´çš„ WebAssembly è¿è¡Œæ—¶å®ç°ï¼Œæ”¯æŒæœ€æ–°çš„è¯­è¨€ç‰¹æ€§å’Œæ ‡å‡†ï¼ŒåŒ…æ‹¬æ‰¹é‡å†…å­˜æ“ä½œã€å°¾è°ƒç”¨ä¼˜åŒ–ã€å®¿ä¸»ç»‘å®šç­‰ WebAssembly 2.0 æ–°ç‰¹æ€§ã€‚

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### Rust 1.89 è¯­è¨€ç‰¹æ€§é›†æˆ

- **å¸¸é‡æ³›å‹æ¨æ–­** - ä½¿ç”¨ `_` è®©ç¼–è¯‘å™¨è‡ªåŠ¨æ¨æ–­å¸¸é‡æ³›å‹å‚æ•°ï¼Œç®€åŒ–æ•°ç»„åˆ›å»º
- **ç”Ÿå‘½å‘¨æœŸè¯­æ³•æ£€æŸ¥** - æ”¹è¿›çš„ç”Ÿå‘½å‘¨æœŸè¯­æ³•æ£€æŸ¥å’Œé”™è¯¯æç¤ºï¼Œæé«˜ä»£ç è´¨é‡
- **FFI æ”¹è¿›** - æ”¯æŒ `i128` å’Œ `u128` ç±»å‹åœ¨ `extern "C"` å‡½æ•°ä¸­å®‰å…¨ä½¿ç”¨
- **è·¨å¹³å°æ–‡æ¡£æµ‹è¯•** - æ”¯æŒé’ˆå¯¹ç‰¹å®šå¹³å°çš„æ–‡æ¡£æµ‹è¯•ï¼Œæé«˜ä»£ç è´¨é‡
- **API ç¨³å®šåŒ–** - `Result::flatten` å’Œæ–‡ä»¶é”ç›¸å…³ API çš„ç¨³å®šåŒ–

### WebAssembly 2.0 æ–°ç‰¹æ€§æ”¯æŒ

- **æ‰¹é‡å†…å­˜æ“ä½œ** - æ”¯æŒé«˜æ•ˆçš„å†…å­˜å¤åˆ¶å’Œå¡«å……æ“ä½œï¼Œæå‡æ€§èƒ½
- **å°¾è°ƒç”¨ä¼˜åŒ–** - å‡å°‘é€’å½’å‡½æ•°çš„è°ƒç”¨æ ˆæ·±åº¦ï¼Œä¼˜åŒ–å†…å­˜ä½¿ç”¨
- **å®¿ä¸»ç»‘å®š** - ç›´æ¥æ“ä½œ JavaScript/DOM å¯¹è±¡ï¼Œç®€åŒ–è·¨è¯­è¨€äº¤äº’
- **æ¥å£ç±»å‹** - æ”¯æŒæ›´ä¸°å¯Œçš„ç±»å‹ç³»ç»Ÿï¼ˆå­—ç¬¦ä¸²ã€è®°å½•ã€å˜ä½“ç­‰ï¼‰
- **SIMD æ“ä½œ** - æ”¯æŒ 128 ä½å‘é‡æ“ä½œï¼Œæå‡è®¡ç®—æ€§èƒ½
- **ECMAScript æ¨¡å—é›†æˆ** - é€šè¿‡ ESM å¯¼å…¥æ–¹å¼åŠ è½½ Wasm æ¨¡å—

### å®Œæ•´ WebAssembly è¿è¡Œæ—¶

- **è™šæ‹Ÿæœºå®ç°** - å®Œæ•´çš„ WebAssembly è™šæ‹Ÿæœºå®ç°
- **å†…å­˜ç®¡ç†** - é«˜æ•ˆçš„çº¿æ€§å†…å­˜ç®¡ç†å’Œæ‰¹é‡æ“ä½œ
- **å®‰å…¨æ²™ç®±** - å®Œæ•´çš„æ²™ç®±éš”ç¦»å’Œå®‰å…¨æœºåˆ¶
- **è·¨è¯­è¨€äº’æ“ä½œ** - ä¸ JavaScriptã€C/C++ ç­‰è¯­è¨€çš„äº’æ“ä½œæ”¯æŒ
- **æ€§èƒ½ä¼˜åŒ–** - å³æ—¶ç¼–è¯‘å’Œæ€§èƒ½ä¼˜åŒ–æŠ€æœ¯

## ğŸ“š æ–‡æ¡£å¯¼èˆª

### Rust WebAssembly è§†å›¾

- [Rust 1.89 ç‰¹æ€§è¯¦è§£](./rust_webassembly/view01.md) - Rust 1.89 æ–°ç‰¹æ€§åœ¨ WebAssembly ä¸­çš„åº”ç”¨
- [WebAssembly 2.0 æ–°ç‰¹æ€§](./rust_webassembly/view02.md) - WebAssembly 2.0 æ–°ç‰¹æ€§è¯¦è§£
- [é›†æˆç¤ºä¾‹å’Œæœ€ä½³å®è·µ](./rust_webassembly/view03.md) - ç»¼åˆé›†æˆç¤ºä¾‹å’Œæœ€ä½³å®è·µ
- [è§†å›¾æ–‡æ¡£](./rust_webassembly/view04.md) - å¤šè§’åº¦ WebAssembly æŠ€æœ¯è§†å›¾

### é¡¶å±‚ä¸ç¤ºä¾‹

- [é¡¹ç›®è¯´æ˜](../README.md) - é¡¹ç›®æ¦‚è¿°å’Œå¿«é€Ÿå¼€å§‹æŒ‡å—
- [ç« èŠ‚å¼•å¯¼](../12_webassembly.md) - å®Œæ•´çš„ WebAssembly 2.0 ä¸ Rust 1.89 é›†æˆæŒ‡å—
- [æºç å®ç°](../src/) - å®Œæ•´çš„ WebAssembly è¿è¡Œæ—¶å®ç°

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

```bash
# Rust 1.89+
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# wasm-pack 0.12+
curl https://rustwasm.github.io/wasm-pack/installer/init.sh -sSf | sh

# Node.js 16+ (ç”¨äº WebAssembly æµ‹è¯•)
```

### 2. åŸºç¡€ WebAssembly æ“ä½œ

```rust
use c16_webassembly::*;

// åˆ›å»º WebAssembly è™šæ‹Ÿæœº
let mut vm = WasmVM::new();

// åŠ è½½ WebAssembly æ¨¡å—
let module = vm.load_module(wasm_bytes)?;

// åˆ›å»ºå®ä¾‹
let instance = vm.create_instance(module)?;

// è°ƒç”¨å‡½æ•°
let result = vm.call_function(&instance, "add", &[Value::I32(5), Value::I32(3)])?;
println!("ç»“æœ: {:?}", result);
```

### 3. ä½¿ç”¨ Rust 1.89 ç‰¹æ€§

```rust
use c16_webassembly::rust189::*;

// ä½¿ç”¨å¸¸é‡æ³›å‹æ¨æ–­
let buffer: [u8; 1024] = create_wasm_buffer(); // ç¼–è¯‘å™¨è‡ªåŠ¨æ¨æ–­å¤§å°

// ä½¿ç”¨æ”¹è¿›çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†
let module_ref = process_wasm_module(&module);

// ä½¿ç”¨ç¨³å®šçš„ API
let result = wasm_operation().flatten();
```

### 4. WebAssembly 2.0 æ–°ç‰¹æ€§

```rust
use c16_webassembly::wasm2::*;

// æ‰¹é‡å†…å­˜æ“ä½œ
let mut memory_manager = BulkMemoryManager::new(1024);
memory_manager.bulk_copy(0, 100, 50)?;
memory_manager.bulk_fill(200, 0xFF, 25)?;

// å°¾è°ƒç”¨ä¼˜åŒ–
let mut optimizer = TailCallOptimizer::new();
let args = vec![Value::I32(42), Value::I64(123)];
let result = optimizer.execute_tail_call(0, args)?;

// å®¿ä¸»ç»‘å®š
let mut binding_manager = HostBindingManager::new();
binding_manager.register_binding("console.log".to_string(), HostBindingType::JavaScriptFunction);
let result = binding_manager.call_javascript_function("console.log", args)?;
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```text
c16_webassembly/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs                 # ä¸»ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ types.rs                # æ ¸å¿ƒç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ vm.rs                   # è™šæ‹Ÿæœºå®ç°
â”‚   â”œâ”€â”€ runtime.rs              # è¿è¡Œæ—¶ç¯å¢ƒ
â”‚   â”œâ”€â”€ security.rs             # å®‰å…¨æ¨¡å‹
â”‚   â”œâ”€â”€ tools.rs                # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ rust_189_features.rs    # Rust 1.89 ç‰¹æ€§é›†æˆ
â”œâ”€â”€ docs/                       # è¯¦ç»†æ–‡æ¡£
â”‚   â”œâ”€â”€ rust_webassembly/       # Rust WebAssembly è§†å›¾æ–‡æ¡£
â”‚   â””â”€â”€ README.md               # æ–‡æ¡£ä¸­å¿ƒ
â”œâ”€â”€ examples/                   # ç¤ºä¾‹ä»£ç 
â”œâ”€â”€ tests/                      # æµ‹è¯•ä»£ç 
â”œâ”€â”€ benches/                    # åŸºå‡†æµ‹è¯•
â”œâ”€â”€ Cargo.toml                  # é¡¹ç›®é…ç½®
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
â””â”€â”€ 12_webassembly.md           # å®Œæ•´é›†æˆæŒ‡å—
```

## ğŸ§ª æµ‹è¯•ä¸åŸºå‡†æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cargo test

# è¿è¡Œç‰¹å®šæµ‹è¯•
cargo test rust_189_features
cargo test wasm_2_0
cargo test integration
```

### è¿è¡Œç¤ºä¾‹

```bash
# è¿è¡Œä¸»ç¨‹åº
cargo run

# æ„å»º WebAssembly æ¨¡å—
wasm-pack build --target web

# è¿è¡Œ WebAssembly æµ‹è¯•
wasm-pack test --headless --firefox
```

### è¿è¡ŒåŸºå‡†æµ‹è¯•

```bash
cargo bench --features bench
```

## ğŸ” å®‰å…¨ç‰¹æ€§

### æ²™ç®±æœºåˆ¶

- **å†…å­˜éš”ç¦»** - ä¸¥æ ¼çš„çº¿æ€§å†…å­˜è¾¹ç•Œæ£€æŸ¥
- **æƒé™æ§åˆ¶** - ç»†ç²’åº¦çš„å†…å­˜è®¿é—®æƒé™ç®¡ç†
- **æ‰§è¡Œé™åˆ¶** - é˜²æ­¢æ¶æ„ä»£ç æ‰§è¡Œ
- **èµ„æºé™åˆ¶** - é™åˆ¶ CPU å’Œå†…å­˜ä½¿ç”¨

### å®‰å…¨éªŒè¯

- **ç±»å‹å®‰å…¨** - ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
- **å†…å­˜å®‰å…¨** - è¿è¡Œæ—¶å†…å­˜è®¿é—®éªŒè¯
- **æ§åˆ¶æµå®‰å…¨** - é˜²æ­¢æ§åˆ¶æµåŠ«æŒ
- **æ•°æ®å®Œæ•´æ€§** - ç¡®ä¿æ•°æ®ä¸è¢«ç¯¡æ”¹

## ğŸŒ è·¨è¯­è¨€äº’æ“ä½œ

### JavaScript é›†æˆ

- **wasm-bindgen** - è‡ªåŠ¨ç”Ÿæˆ JavaScript ç»‘å®š
- **å®¿ä¸»ç»‘å®š** - ç›´æ¥è°ƒç”¨ JavaScript å‡½æ•°
- **DOM æ“ä½œ** - å®‰å…¨çš„ DOM å…ƒç´ æ“ä½œ
- **äº‹ä»¶å¤„ç†** - å®Œæ•´çš„äº‹ä»¶ç³»ç»Ÿæ”¯æŒ

### C/C++ é›†æˆ

- **FFI æ”¯æŒ** - å®Œæ•´çš„ C å‡½æ•°è°ƒç”¨æ”¯æŒ
- **128ä½æ•´æ•°** - æ”¯æŒ i128/u128 ç±»å‹
- **å†…å­˜å…±äº«** - é«˜æ•ˆçš„å†…å­˜å…±äº«æœºåˆ¶
- **ç±»å‹è½¬æ¢** - è‡ªåŠ¨ç±»å‹è½¬æ¢å’ŒéªŒè¯

### å…¶ä»–è¯­è¨€æ”¯æŒ

- **Python ç»‘å®š** - é€šè¿‡ PyO3 æ”¯æŒ Python é›†æˆ
- **Go ç»‘å®š** - é€šè¿‡ CGO æ”¯æŒ Go è¯­è¨€é›†æˆ
- **Rust åŸç”Ÿ** - å®Œæ•´çš„ Rust ç”Ÿæ€ç³»ç»Ÿæ”¯æŒ

## ğŸš€ æ€§èƒ½ç‰¹æ€§

### å³æ—¶ç¼–è¯‘ (JIT)

- **åŠ¨æ€ç¼–è¯‘** - è¿è¡Œæ—¶å­—èŠ‚ç åˆ°æœºå™¨ç ç¼–è¯‘
- **ä¼˜åŒ–ç­–ç•¥** - å¤šç§ç¼–è¯‘ä¼˜åŒ–ç­–ç•¥
- **ç¼“å­˜æœºåˆ¶** - æ™ºèƒ½çš„ç¼–è¯‘ç»“æœç¼“å­˜
- **æ€§èƒ½åˆ†æ** - è¯¦ç»†çš„æ€§èƒ½åˆ†æå·¥å…·

### å†…å­˜ä¼˜åŒ–

- **æ‰¹é‡æ“ä½œ** - é«˜æ•ˆçš„æ‰¹é‡å†…å­˜æ“ä½œ
- **å†…å­˜æ± ** - æ™ºèƒ½çš„å†…å­˜æ± ç®¡ç†
- **åƒåœ¾å›æ”¶** - å¯é€‰çš„å†…å­˜åƒåœ¾å›æ”¶
- **å‹ç¼©æŠ€æœ¯** - å†…å­˜å‹ç¼©å’Œä¼˜åŒ–

### å¹¶å‘æ”¯æŒ

- **å¤šçº¿ç¨‹** - æ”¯æŒå¤šçº¿ç¨‹æ‰§è¡Œ
- **å¼‚æ­¥æ“ä½œ** - å¼‚æ­¥ I/O å’Œç½‘ç»œæ“ä½œ
- **é”æœºåˆ¶** - é«˜æ•ˆçš„é”å’ŒåŒæ­¥æœºåˆ¶
- **ä»»åŠ¡è°ƒåº¦** - æ™ºèƒ½çš„ä»»åŠ¡è°ƒåº¦ç®—æ³•

## ğŸ“ æ•™è‚²ä»·å€¼

### å­¦ä¹ è·¯å¾„

1. **åŸºç¡€æ¦‚å¿µ** - ä» WebAssembly åŸºæœ¬æ¦‚å¿µå¼€å§‹
2. **Rust é›†æˆ** - å­¦ä¹  Rust ä¸ WebAssembly çš„é›†æˆ
3. **æ–°ç‰¹æ€§åº”ç”¨** - æŒæ¡ Rust 1.89 å’Œ WebAssembly 2.0 æ–°ç‰¹æ€§
4. **å®è·µé¡¹ç›®** - é€šè¿‡å®é™…é¡¹ç›®åŠ æ·±ç†è§£

### å®è·µé¡¹ç›®

- **ç®€å•è®¡ç®—å™¨** - å®ç°åŸºæœ¬çš„æ•°å­¦è¿ç®—
- **å›¾åƒå¤„ç†** - é«˜æ€§èƒ½çš„å›¾åƒå¤„ç†ç®—æ³•
- **æ¸¸æˆå¼•æ“** - 2D/3D æ¸¸æˆå¼•æ“å¼€å‘
- **ç§‘å­¦è®¡ç®—** - æ•°å€¼è®¡ç®—å’Œç§‘å­¦è®¡ç®—

### å‚è€ƒèµ„æ–™

- **å®˜æ–¹æ–‡æ¡£** - WebAssembly å®˜æ–¹è§„èŒƒæ–‡æ¡£
- **Rust æ–‡æ¡£** - Rust WebAssembly å¼€å‘æŒ‡å—
- **ä»£ç ç¤ºä¾‹** - å®Œæ•´çš„å¯è¿è¡Œä»£ç ç¤ºä¾‹
- **æ€§èƒ½åˆ†æ** - è¯¦ç»†çš„æ€§èƒ½åŸºå‡†æµ‹è¯•

## ğŸŒŸ åˆ›æ–°äº®ç‚¹

### æŠ€æœ¯åˆ›æ–°

- **Rust 1.89 ç‰¹æ€§é›†æˆ** - ä¸šç•Œé¦–ä¸ªå……åˆ†åˆ©ç”¨ Rust 1.89 ç‰¹æ€§çš„ WebAssembly å®ç°
- **WebAssembly 2.0 æ”¯æŒ** - å®Œæ•´çš„ WebAssembly 2.0 æ–°ç‰¹æ€§æ”¯æŒ
- **è·¨è¯­è¨€äº’æ“ä½œ** - å¼ºå¤§çš„è·¨è¯­è¨€äº’æ“ä½œèƒ½åŠ›
- **å®‰å…¨æ²™ç®±** - å®Œæ•´çš„å®‰å…¨æ²™ç®±æœºåˆ¶

### æ¶æ„åˆ›æ–°

- **æ¨¡å—åŒ–è®¾è®¡** - é«˜åº¦æ¨¡å—åŒ–å’Œå¯æ‰©å±•çš„æ¶æ„
- **ç±»å‹å®‰å…¨** - å……åˆ†åˆ©ç”¨ Rust çš„ç±»å‹ç³»ç»Ÿä¿è¯å®‰å…¨
- **æ€§èƒ½ä¼˜åŒ–** - å¤šç§æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯
- **è·¨å¹³å°å…¼å®¹** - æ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿå’Œæ¶æ„

### ç”Ÿæ€åˆ›æ–°

- **å·¥å…·é“¾é›†æˆ** - å®Œæ•´çš„å¼€å‘å·¥å…·é“¾æ”¯æŒ
- **ç¤¾åŒºé©±åŠ¨** - åŸºäºç¤¾åŒºåé¦ˆçš„æŒç»­æ”¹è¿›
- **æ ‡å‡†å…¼å®¹** - éµå¾ª WebAssembly æ ‡å‡†å’Œæœ€ä½³å®è·µ
- **æ•™è‚²å‹å¥½** - ä¸“ä¸ºæ•™è‚²åœºæ™¯ä¼˜åŒ–çš„è®¾è®¡

## ğŸ“ æ”¯æŒä¸è´¡çŒ®

### è·å–æ”¯æŒ

- é—®é¢˜æŠ¥å‘Š: [GitHub Issues](https://github.com/rust-lang/c16_webassembly/issues)
- è®¨è®ºåŒº: [GitHub Discussions](https://github.com/rust-lang/c16_webassembly/discussions)
- æ–‡æ¡£: [GitHub Wiki](https://github.com/rust-lang/c16_webassembly/wiki)

### è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. ç¼–å†™ä»£ç å’Œæµ‹è¯•
4. æäº¤ Pull Request
5. å‚ä¸ä»£ç å®¡æŸ¥

### è´¡çŒ®ç±»å‹

- åŠŸèƒ½å¼€å‘ - æ–°åŠŸèƒ½çš„å®ç°
- æ€§èƒ½ä¼˜åŒ– - æ€§èƒ½æ”¹è¿›å’Œä¼˜åŒ–
- æ–‡æ¡£å®Œå–„ - æ–‡æ¡£çš„æ”¹è¿›å’Œè¡¥å……
- æµ‹è¯•å¢å¼º - æµ‹è¯•è¦†ç›–ç‡çš„æé«˜
- å®‰å…¨æ”¹è¿› - å®‰å…¨æœºåˆ¶çš„å¢å¼º

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT æˆ– Apache-2.0 åŒè®¸å¯è¯ã€‚è¯¦æƒ…è¯·å‚è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

**Rust WebAssembly ç³»ç»Ÿ** - è®© WebAssembly å¼€å‘æ›´ç®€å•ã€æ›´å®‰å…¨ã€æ›´é«˜æ•ˆï¼

**Rust WebAssembly System** - Making WebAssembly development simpler, safer, and more efficient!
