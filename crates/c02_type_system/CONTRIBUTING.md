# 贡献指南 (Contributing Guide)

> **欢迎！** 感谢您对 C02 类型系统学习模块的兴趣！  
> **文档版本**: v2.1.0  
> **最后更新**: 2025-10-22

---

## 📋 目录

- [贡献指南 (Contributing Guide)](#贡献指南-contributing-guide)
  - [📋 目录](#-目录)
  - [🚀 快速开始](#-快速开始)
    - [贡献前须知](#贡献前须知)
    - [贡献流程概览](#贡献流程概览)
  - [🎯 贡献类型](#-贡献类型)
    - [1. 📚 文档贡献](#1--文档贡献)
    - [2. 💻 代码贡献](#2--代码贡献)
    - [3. 🎨 可视化贡献](#3--可视化贡献)
    - [4. 🐛 问题报告](#4--问题报告)
    - [5. 💡 功能建议](#5--功能建议)
  - [🔧 开发环境设置](#-开发环境设置)
    - [系统要求](#系统要求)
    - [安装 Rust](#安装-rust)
    - [克隆项目](#克隆项目)
    - [安装依赖](#安装依赖)
  - [📖 文档贡献](#-文档贡献)
    - [文档结构](#文档结构)
    - [文档编写标准](#文档编写标准)
      - [文档格式](#文档格式)
      - [代码示例标准](#代码示例标准)
      - [技术术语规范](#技术术语规范)
    - [文档质量检查](#文档质量检查)
    - [文档审查标准](#文档审查标准)
  - [💻 代码贡献](#-代码贡献)
    - [代码结构](#代码结构)
    - [代码风格](#代码风格)
    - [代码示例要求](#代码示例要求)
      - [完整性](#完整性)
      - [可测试性](#可测试性)
      - [注释清晰](#注释清晰)
    - [性能考虑](#性能考虑)
  - [📝 示例贡献](#-示例贡献)
    - [示例类型](#示例类型)
    - [示例模板](#示例模板)
  - [✅ 质量标准](#-质量标准)
    - [文档质量检查清单](#文档质量检查清单)
    - [代码质量检查清单](#代码质量检查清单)
  - [📦 提交规范](#-提交规范)
    - [Commit Message 格式](#commit-message-格式)
      - [类型 (Type)](#类型-type)
      - [范围 (Scope)](#范围-scope)
      - [示例](#示例)
    - [分支命名](#分支命名)
    - [Pull Request 标题](#pull-request-标题)
  - [🔍 审查流程](#-审查流程)
    - [PR 审查标准](#pr-审查标准)
      - [必须满足](#必须满足)
      - [审查重点](#审查重点)
    - [审查流程](#审查流程)
    - [审查时间](#审查时间)
    - [获得快速审查的技巧](#获得快速审查的技巧)
  - [🤝 社区准则](#-社区准则)
    - [行为准则](#行为准则)
    - [期望行为](#期望行为)
    - [不可接受的行为](#不可接受的行为)
    - [报告问题](#报告问题)
  - [💬 获取帮助](#-获取帮助)
    - [提问渠道](#提问渠道)
    - [提问技巧](#提问技巧)
      - [好的问题](#好的问题)
    - [常见问题](#常见问题)
  - [📚 学习资源](#-学习资源)
    - [推荐阅读](#推荐阅读)
    - [工具资源](#工具资源)
  - [🎉 致谢](#-致谢)
    - [如何出现在贡献者列表](#如何出现在贡献者列表)
  - [📝 许可证](#-许可证)
  - [📞 联系方式](#-联系方式)

---

## 🚀 快速开始

### 贡献前须知

1. **阅读文档**: 先浏览 [README.md](./README.md) 和 [00_MASTER_INDEX.md](./docs/00_MASTER_INDEX.md)
2. **了解结构**: 熟悉项目的文档体系和代码组织
3. **遵循规范**: 确保您的贡献符合我们的标准
4. **开放沟通**: 有任何问题随时在 Issues 中提出

### 贡献流程概览

```text
1. Fork 项目 → 2. 创建分支 → 3. 进行修改 → 
4. 测试验证 → 5. 提交 PR → 6. 代码审查 → 
7. 合并到主分支
```

---

## 🎯 贡献类型

我们欢迎以下类型的贡献：

### 1. 📚 文档贡献

- **改进现有文档**: 修正错误、增加说明、优化表达
- **新增文档**: 补充缺失的主题或深化某个概念
- **翻译工作**: 英文翻译、多语言支持
- **示例补充**: 添加更多实用的代码示例

### 2. 💻 代码贡献

- **示例代码**: 提供新的示例实现
- **测试用例**: 增加测试覆盖
- **性能优化**: 改进示例代码的性能
- **Bug修复**: 修复示例代码中的错误

### 3. 🎨 可视化贡献

- **思维导图**: 创建或改进可视化图表
- **流程图**: 添加流程说明图
- **架构图**: 补充架构设计图
- **对比表格**: 制作技术对比表

### 4. 🐛 问题报告

- **文档错误**: 报告文档中的错误
- **代码问题**: 指出示例代码的问题
- **建议反馈**: 提出改进建议
- **用户体验**: 反馈学习体验

### 5. 💡 功能建议

- **新主题建议**: 提出需要补充的主题
- **工具建议**: 推荐有用的学习工具
- **资源推荐**: 分享优秀的学习资源
- **社区活动**: 组织学习活动

---

## 🔧 开发环境设置

### 系统要求

```bash
# Rust 工具链
- Rust 1.90+ (推荐最新稳定版)
- Cargo (随 Rust 安装)
- rustfmt (代码格式化)
- clippy (代码检查)

# 文档工具
- mdBook (可选，用于生成文档)
- PlantUML (可选，用于图表)

# 版本控制
- Git 2.x+
```

### 安装 Rust

```bash
# Linux / macOS
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# Windows
# 访问 https://rustup.rs/ 下载安装程序
```

### 克隆项目

```bash
# Fork 项目后克隆
git clone https://github.com/YOUR_USERNAME/rust-lang.git
cd rust-lang/crates/c02_type_system

# 添加上游仓库
git remote add upstream https://github.com/ORIGINAL_OWNER/rust-lang.git
```

### 安装依赖

```bash
# 构建项目
cargo build

# 运行测试
cargo test

# 检查代码
cargo clippy
```

---

## 📖 文档贡献

### 文档结构

我们的文档采用分层架构：

```text
docs/
├── 01_theory/          # 理论基础 (4文档, 6,530行)
├── 02_core/            # 核心概念 (11文档, 8,930行)
├── 03_advanced/        # 高级特性 (4文档, 3,192行)
├── 04_safety/          # 安全优化 (6文档, 4,539行)
├── 05_practice/        # 实践应用 (4文档, 3,913行)
├── 06_rust_features/   # Rust特性 (7文档, 1,987行)
├── 07_cargo_package_management/  # Cargo (20文档, 9,800行)
├── knowledge_system/   # 知识体系 (28文档, 19,300行)
└── theory_enhanced/    # 理论增强 (5文档, 2,631行)
```

### 文档编写标准

#### 文档格式

```markdown
    # 标题 (h1 - 每个文档只有一个)

    > **文档类型**: [教程/参考/指南/理论]  
    > **难度等级**: [初级/中级/高级]  
    > **预计时间**: [阅读时长]  
    > **最后更新**: YYYY-MM-DD

    ---

    ## 📋 目录

    - [章节1](#章节1)
    - [章节2](#章节2)

    ---

    ## 🎯 文档概述

    简短描述文档的目标和内容。

    ---

    ## 章节1

    ### 小节1.1

    内容...

    ```rust
    // 代码示例
    fn example() {
        // 代码注释要清晰
    }
    ```

    ---

    ## 📚 参考资源

    - [相关链接]
    - [延伸阅读]

    ---

    **最后更新**: YYYY-MM-DD  
    **维护者**: [姓名]

```

#### 代码示例标准

```rust
// ✅ 好的示例：完整、可运行、有注释
fn good_example<T: Display>(value: T) {
    // 说明这段代码的目的
    println!("Value: {}", value);
    
    // 说明重要的细节
    let result = process(value);
    
    // 说明返回值的含义
    result
}

// ❌ 避免的情况：不完整、无注释、过于复杂
fn bad_example(x) { x + 1 }  // 类型不明确，缺少说明
```

#### 技术术语规范

- **一致性**: 使用统一的技术术语
- **中英对照**: 首次出现时提供中英文对照
- **术语表**: 新术语添加到 [Glossary.md](./docs/Glossary.md)

**示例**:

```markdown
**泛型 (Generics)**: 参数化类型的编程机制...

在后续使用时可以只用中文："泛型系统..."
```

### 文档质量检查

提交前请确保：

- [ ] **格式正确**: Markdown 语法无误
- [ ] **链接有效**: 所有内部链接可访问
- [ ] **代码可运行**: 示例代码经过测试
- [ ] **拼写检查**: 无明显错别字
- [ ] **逻辑清晰**: 内容组织合理
- [ ] **引用准确**: 参考资料正确标注

### 文档审查标准

| 标准 | 要求 | 示例 |
|------|------|------|
| **准确性** | 技术内容准确无误 | 类型理论概念正确 |
| **完整性** | 覆盖主题的关键方面 | GAT 的定义、使用、限制都有说明 |
| **清晰性** | 表达简洁易懂 | 避免过于学术化的表达 |
| **实用性** | 提供可操作的指导 | 包含实际代码示例 |
| **一致性** | 与现有文档风格一致 | 遵循文档模板 |

---

## 💻 代码贡献

### 代码结构

```text
src/
├── type_constructor/   # 类型构造器
├── type_inference/     # 类型推断
├── variance/           # 型变
└── ... (其他模块)

examples/
├── generics_examples.rs    # 泛型示例
├── traits_examples.rs      # Trait示例
├── lifetimes_examples.rs   # 生命周期示例
└── ... (其他示例)

tests/
├── generics_tests.rs       # 泛型测试
└── ... (其他测试)
```

### 代码风格

我们遵循 Rust 官方编码规范:

```bash
# 格式化代码
cargo fmt

# 检查代码
cargo clippy -- -D warnings

# 运行测试
cargo test
```

### 代码示例要求

#### 完整性

```rust
// ✅ 好：包含必要的 use 语句和完整的函数签名
use std::fmt::Display;

fn print_value<T: Display>(value: T) {
    println!("{}", value);
}

fn main() {
    print_value(42);
}

// ❌ 差：缺少上下文
fn print_value(value) {
    println!("{}", value);
}
```

#### 可测试性

```rust
// ✅ 好：包含文档测试
/// 计算两个数的和
///
/// # 示例
///
/// ```
/// use c02_type_system::add;
/// assert_eq!(add(2, 3), 5);
/// ```
pub fn add(a: i32, b: i32) -> i32 {
    a + b
}

// ❌ 差：无测试
pub fn add(a: i32, b: i32) -> i32 {
    a + b
}
```

#### 注释清晰

```rust
// ✅ 好：注释说明了"为什么"
fn process_data<T>(data: T) -> Result<T, Error> 
where
    T: Clone + Send
{
    // Clone 是必需的，因为我们需要在多个线程中使用数据
    // Send 确保可以安全地在线程间传递
    let cloned = data.clone();
    thread::spawn(move || {
        // 处理克隆的数据...
    });
    Ok(data)
}

// ❌ 差：注释只是重复代码
fn process_data<T>(data: T) -> Result<T, Error> {
    // 克隆数据
    let cloned = data.clone();
    // 创建线程
    thread::spawn(move || {
        // ...
    });
    Ok(data)
}
```

### 性能考虑

```rust
// ✅ 好：使用迭代器避免不必要的分配
fn sum_squares(numbers: &[i32]) -> i32 {
    numbers.iter()
        .map(|&n| n * n)
        .sum()
}

// ❌ 差：创建了中间 Vec
fn sum_squares(numbers: &[i32]) -> i32 {
    let squares: Vec<_> = numbers.iter()
        .map(|&n| n * n)
        .collect();
    squares.iter().sum()
}
```

---

## 📝 示例贡献

### 示例类型

我们需要以下类型的示例：

1. **基础示例**: 展示核心概念
2. **实战示例**: 解决实际问题
3. **对比示例**: 展示不同实现方式
4. **反例示例**: 说明常见错误

### 示例模板

```rust
//! # 示例名称
//!
//! **难度**: [初级/中级/高级]
//! **主题**: [泛型/Trait/生命周期/...]
//! **目标**: 简短说明这个示例的目的
//!
//! ## 概述
//!
//! 详细说明...
//!
//! ## 关键概念
//!
//! - 概念1
//! - 概念2
//!
//! ## 使用方法
//!
//! ```bash
//! cargo run --example example_name
//! ```

use std::marker::PhantomData;

// 示例代码...

fn main() {
    // 主要演示逻辑...
    
    // 输出说明
    println!("示例演示了...");
}

#[cfg(test)]
mod tests {
    use super::*;
    
    #[test]
    fn test_example() {
        // 测试代码...
    }
}
```

---

## ✅ 质量标准

### 文档质量检查清单

- [ ] **技术准确**: 内容符合 Rust 规范
- [ ] **代码可用**: 所有示例可编译运行
- [ ] **格式规范**: 遵循 Markdown 格式
- [ ] **链接有效**: 内部链接正确无误
- [ ] **术语一致**: 使用统一的技术术语
- [ ] **示例完整**: 代码示例包含必要上下文
- [ ] **注释清晰**: 代码注释说明关键逻辑
- [ ] **测试覆盖**: 重要代码有测试

### 代码质量检查清单

- [ ] **Rust 规范**: 遵循 Rust API 指南
- [ ] **格式化**: 通过 `cargo fmt`
- [ ] **Clippy**: 通过 `cargo clippy`
- [ ] **编译**: 无警告通过编译
- [ ] **测试**: 所有测试通过
- [ ] **文档**: 公共 API 有文档注释
- [ ] **示例**: 文档包含使用示例
- [ ] **错误处理**: 正确使用 Result/Option

---

## 📦 提交规范

### Commit Message 格式

我们使用 [Conventional Commits](https://www.conventionalcommits.org/) 规范：

```text
<类型>(<范围>): <描述>

[可选的正文]

[可选的脚注]
```

#### 类型 (Type)

- **feat**: 新功能
- **fix**: Bug修复
- **docs**: 文档更新
- **style**: 格式调整（不影响代码逻辑）
- **refactor**: 重构（不是新功能也不是Bug修复）
- **perf**: 性能优化
- **test**: 测试相关
- **chore**: 构建过程或辅助工具变动

#### 范围 (Scope)

- `theory`: 理论基础
- `core`: 核心概念
- `advanced`: 高级特性
- `safety`: 安全优化
- `practice`: 实践应用
- `examples`: 示例代码
- `tests`: 测试
- `docs`: 文档
- `cargo`: Cargo 相关

#### 示例

```bash
# 新增文档
git commit -m "docs(advanced): 添加 GAT 详细说明"

# 修复示例
git commit -m "fix(examples): 修正泛型示例的类型错误"

# 新增功能
git commit -m "feat(core): 实现类型推断算法示例"

# 性能优化
git commit -m "perf(examples): 优化大型数据结构示例性能"

# 文档改进
git commit -m "docs(theory): 改进范畴论章节的表达"
```

### 分支命名

```bash
# 功能分支
feature/add-gat-examples

# Bug修复
fix/generics-example-error

# 文档更新
docs/improve-trait-guide

# 重构
refactor/reorganize-examples
```

### Pull Request 标题

```bash
# 格式
[类型] 简短描述

# 示例
[Docs] 添加 Rust 1.90 特性文档
[Fix] 修正生命周期示例中的错误
[Feat] 新增类型推断实战示例
```

---

## 🔍 审查流程

### PR 审查标准

#### 必须满足

1. **通过 CI/CD**: 所有自动检查通过
2. **代码质量**: 符合代码规范
3. **测试覆盖**: 关键功能有测试
4. **文档完整**: 新功能有相应文档
5. **无冲突**: 与主分支无冲突

#### 审查重点

- **技术准确性**: 内容是否正确
- **代码质量**: 是否遵循最佳实践
- **可维护性**: 是否易于理解和维护
- **一致性**: 是否与现有代码/文档一致
- **完整性**: 是否完整解决问题

### 审查流程

```text
1. 提交 PR
   ↓
2. 自动检查 (CI/CD)
   ↓
3. 代码审查 (至少1位审查者)
   ↓
4. 讨论和修改 (如需要)
   ↓
5. 批准
   ↓
6. 合并到主分支
   ↓
7. 自动部署 (如适用)
```

### 审查时间

- **简单PR**: 1-2个工作日
- **中等PR**: 3-5个工作日
- **复杂PR**: 1-2周

### 获得快速审查的技巧

- ✅ **小而专注**: 每个PR只做一件事
- ✅ **清晰描述**: PR描述说明了what、why、how
- ✅ **自我审查**: 提交前自己先审查一遍
- ✅ **遵循规范**: 符合所有编码和文档规范
- ✅ **及时响应**: 快速响应审查意见

---

## 🤝 社区准则

### 行为准则

我们承诺为所有人提供友好、安全、热情的环境，无论：

- 经验水平
- 性别认同和表达
- 性取向
- 残疾
- 外貌
- 体型
- 种族
- 年龄
- 宗教
- 国籍

### 期望行为

- ✅ 使用友好和包容的语言
- ✅ 尊重不同的观点和经验
- ✅ 优雅地接受建设性批评
- ✅ 关注对社区最有利的事情
- ✅ 对其他社区成员表示同理心

### 不可接受的行为

- ❌ 使用性暗示的语言或图像
- ❌ 人身攻击或侮辱/贬损评论
- ❌ 公开或私下骚扰
- ❌ 未经明确许可发布他人私人信息
- ❌ 其他不道德或不专业的行为

### 报告问题

如果您遇到不当行为，请联系项目维护者。我们会认真对待所有投诉。

---

## 💬 获取帮助

### 提问渠道

1. **GitHub Issues**: 报告 Bug 或请求功能
2. **GitHub Discussions**: 一般性讨论和问题
3. **邮件**: [维护者邮箱]
4. **社区论坛**: Rust 中文社区

### 提问技巧

#### 好的问题

```markdown
    **标题**: [类型] 简短描述问题

    **环境**:
    - Rust版本: 1.90.0
    - 操作系统: Ubuntu 22.04
    - 相关文档: docs/02_core/01_type_definition.md

    **问题描述**:
    清晰描述遇到的问题...

    **预期行为**:
    说明您期望的结果...

    **实际行为**:
    说明实际发生了什么...

    **复现步骤**:
    1. 步骤1
    2. 步骤2
    3. ...

    **相关代码**:
    ```rust
    // 相关代码片段
    ```

    **已尝试的解决方法**:

    - 尝试了...
    - 查阅了...

```

### 常见问题

**Q: 我是新手，可以贡献吗？**  
A: 当然可以！我们欢迎所有水平的贡献。可以从简单的任务开始，如修正文档错误、改进注释等。

**Q: 我不会写代码，怎么贡献？**  
A: 文档贡献同样重要！您可以改进文档、提供反馈、报告问题等。

**Q: 提交PR需要多长时间？**  
A: 取决于PR的复杂度。简单的PR通常1-2天内会得到反馈。

**Q: 我的PR被拒绝了，怎么办？**  
A: 不要气馁！审查者会说明拒绝的原因。您可以根据反馈进行修改后重新提交。

**Q: 如何选择贡献的内容？**  
A: 查看 GitHub Issues 中标记为 `good first issue` 或 `help wanted` 的问题。

---

## 📚 学习资源

### 推荐阅读

- **Rust 官方文档**: [doc.rust-lang.org](https://doc.rust-lang.org)
- **Rust By Example**: [doc.rust-lang.org/rust-by-example](https://doc.rust-lang.org/rust-by-example/)
- **The Rust Reference**: [doc.rust-lang.org/reference](https://doc.rust-lang.org/reference/)
- **Rust API Guidelines**: [rust-lang.github.io/api-guidelines](https://rust-lang.github.io/api-guidelines/)

### 工具资源

- **Rust Playground**: 在线运行Rust代码
- **Compiler Explorer**: 查看编译结果
- **Mermaid**: 制作流程图
- **mdBook**: 生成文档书籍

---

## 🎉 致谢

感谢所有贡献者！您的贡献让这个项目变得更好。

### 如何出现在贡献者列表

- 提交被合并的 PR
- 报告有价值的 Issue
- 参与 PR 审查
- 帮助解答他人问题
- 推广和分享项目

---

## 📝 许可证

本项目采用 MIT 许可证。贡献代码即表示您同意将您的贡献置于相同许可证下。

---

## 📞 联系方式

- **项目维护者**: Rust 学习社区
- **GitHub**: [项目仓库](https://github.com/rust-lang/rust-lang)
- **邮件**: [rust-learning@example.com]
- **社区**: Rust 中文社区

---

**文档版本**: v2.1.0  
**最后更新**: 2025-10-22  
**维护模式**: 持续更新

---

**再次感谢您的贡献！让我们一起构建更好的 Rust 学习资源！** 🦀✨
