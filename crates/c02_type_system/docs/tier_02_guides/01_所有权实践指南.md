# 2.1 Rust ç±»å‹ç³»ç»Ÿ - æ‰€æœ‰æƒå®è·µæŒ‡å—

> **æ–‡æ¡£ç±»å‹**: Tier 2 - æŒ‡å—å±‚
> **æ–‡æ¡£å®šä½**: ç±»å‹ç³»ç»Ÿä¸­çš„æ‰€æœ‰æƒå®è·µ
> **é€‚ç”¨å¯¹è±¡**: ä¸­çº§å¼€å‘è€…
> **å‰ç½®çŸ¥è¯†**: [åŸºç¡€ç±»å‹æŒ‡å—](./01_åŸºç¡€ç±»å‹æŒ‡å—.md)
> **é¢„è®¡å­¦ä¹ æ—¶é—´**: 6-8 å°æ—¶
> **æœ€åæ›´æ–°**: 2025-12-11
> **Rustç‰ˆæœ¬**: 1.92.0+

---

## ğŸ“‹ ç›®å½•

- [2.1 Rust ç±»å‹ç³»ç»Ÿ - æ‰€æœ‰æƒå®è·µæŒ‡å—](#21-rust-ç±»å‹ç³»ç»Ÿ---æ‰€æœ‰æƒå®è·µæŒ‡å—)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [ğŸ¯ å­¦ä¹ ç›®æ ‡](#-å­¦ä¹ ç›®æ ‡)
  - [ğŸ“Š ç« èŠ‚æ¦‚è§ˆ](#-ç« èŠ‚æ¦‚è§ˆ)
  - [1. ç±»å‹ç³»ç»Ÿä¸­çš„æ‰€æœ‰æƒ](#1-ç±»å‹ç³»ç»Ÿä¸­çš„æ‰€æœ‰æƒ)
    - [1.1 æ‰€æœ‰æƒä¸ç±»å‹ç³»ç»Ÿ](#11-æ‰€æœ‰æƒä¸ç±»å‹ç³»ç»Ÿ)
    - [1.2 ç±»å‹çº§åˆ«çš„æ‰€æœ‰æƒä¿è¯](#12-ç±»å‹çº§åˆ«çš„æ‰€æœ‰æƒä¿è¯)
    - [1.3 æ‰€æœ‰æƒç±»å‹è®¾è®¡](#13-æ‰€æœ‰æƒç±»å‹è®¾è®¡)
  - [2. ç»“æ„ä½“ä¸­çš„æ‰€æœ‰æƒ](#2-ç»“æ„ä½“ä¸­çš„æ‰€æœ‰æƒ)
    - [2.1 æ‹¥æœ‰å­—æ®µ](#21-æ‹¥æœ‰å­—æ®µ)
    - [2.2 å¼•ç”¨å­—æ®µ](#22-å¼•ç”¨å­—æ®µ)
    - [2.3 æ‰€æœ‰æƒè½¬ç§»æ¨¡å¼](#23-æ‰€æœ‰æƒè½¬ç§»æ¨¡å¼)
  - [3. æšä¸¾ä¸­çš„æ‰€æœ‰æƒ](#3-æšä¸¾ä¸­çš„æ‰€æœ‰æƒ)
    - [3.1 æ‹¥æœ‰æ•°æ®çš„æšä¸¾](#31-æ‹¥æœ‰æ•°æ®çš„æšä¸¾)
    - [3.2 å¼•ç”¨æ•°æ®çš„æšä¸¾](#32-å¼•ç”¨æ•°æ®çš„æšä¸¾)
    - [3.3 æ‰€æœ‰æƒæ¨¡å¼åŒ¹é…](#33-æ‰€æœ‰æƒæ¨¡å¼åŒ¹é…)
  - [4. æ³›å‹ä¸æ‰€æœ‰æƒ](#4-æ³›å‹ä¸æ‰€æœ‰æƒ)
    - [4.1 æ³›å‹å‚æ•°çš„æ‰€æœ‰æƒ](#41-æ³›å‹å‚æ•°çš„æ‰€æœ‰æƒ)
    - [4.2 æ‰€æœ‰æƒçº¦æŸ](#42-æ‰€æœ‰æƒçº¦æŸ)
    - [4.3 ç§»åŠ¨è¯­ä¹‰ä¸æ³›å‹](#43-ç§»åŠ¨è¯­ä¹‰ä¸æ³›å‹)
  - [5. æ™ºèƒ½æŒ‡é’ˆä¸æ‰€æœ‰æƒ](#5-æ™ºèƒ½æŒ‡é’ˆä¸æ‰€æœ‰æƒ)
    - [5.1 Box çš„æ‰€æœ‰æƒè¯­ä¹‰](#51-box-çš„æ‰€æœ‰æƒè¯­ä¹‰)
    - [5.2 Rc ä¸å…±äº«æ‰€æœ‰æƒ](#52-rc-ä¸å…±äº«æ‰€æœ‰æƒ)
    - [5.3 Arc ä¸çº¿ç¨‹å®‰å…¨çš„æ‰€æœ‰æƒ](#53-arc-ä¸çº¿ç¨‹å®‰å…¨çš„æ‰€æœ‰æƒ)
  - [6. é›†åˆç±»å‹çš„æ‰€æœ‰æƒ](#6-é›†åˆç±»å‹çš„æ‰€æœ‰æƒ)
    - [6.1 Vec çš„æ‰€æœ‰æƒç®¡ç†](#61-vec-çš„æ‰€æœ‰æƒç®¡ç†)
    - [6.2 HashMap çš„æ‰€æœ‰æƒ](#62-hashmap-çš„æ‰€æœ‰æƒ)
    - [6.3 é›†åˆçš„æ‰€æœ‰æƒä¼ é€’](#63-é›†åˆçš„æ‰€æœ‰æƒä¼ é€’)
  - [7. å‡½æ•°ç­¾åä¸æ‰€æœ‰æƒ](#7-å‡½æ•°ç­¾åä¸æ‰€æœ‰æƒ)
    - [7.1 å‚æ•°æ‰€æœ‰æƒè®¾è®¡](#71-å‚æ•°æ‰€æœ‰æƒè®¾è®¡)
    - [7.2 è¿”å›å€¼æ‰€æœ‰æƒ](#72-è¿”å›å€¼æ‰€æœ‰æƒ)
    - [7.3 æ‰€æœ‰æƒæœ€ä½³å®è·µ](#73-æ‰€æœ‰æƒæœ€ä½³å®è·µ)
  - [8. å®æˆ˜æ¡ˆä¾‹](#8-å®æˆ˜æ¡ˆä¾‹)
    - [8.1 æ¡ˆä¾‹1: é…ç½®ç®¡ç†ç³»ç»Ÿ](#81-æ¡ˆä¾‹1-é…ç½®ç®¡ç†ç³»ç»Ÿ)
    - [8.2 æ¡ˆä¾‹2: èµ„æºç®¡ç†å™¨](#82-æ¡ˆä¾‹2-èµ„æºç®¡ç†å™¨)
    - [8.3 æ¡ˆä¾‹3: æ•°æ®ç®¡é“](#83-æ¡ˆä¾‹3-æ•°æ®ç®¡é“)
  - [9. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](#9-å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ)
    - [é—®é¢˜1: æ‰€æœ‰æƒè½¬ç§»åæ— æ³•ä½¿ç”¨](#é—®é¢˜1-æ‰€æœ‰æƒè½¬ç§»åæ— æ³•ä½¿ç”¨)
    - [é—®é¢˜2: ç»“æ„ä½“å­—æ®µæ‰€æœ‰æƒ](#é—®é¢˜2-ç»“æ„ä½“å­—æ®µæ‰€æœ‰æƒ)
    - [é—®é¢˜3: å¾ªç¯ä¸­çš„æ‰€æœ‰æƒ](#é—®é¢˜3-å¾ªç¯ä¸­çš„æ‰€æœ‰æƒ)
  - [10. æ€»ç»“ä¸æœ€ä½³å®è·µ](#10-æ€»ç»“ä¸æœ€ä½³å®è·µ)
    - [æ ¸å¿ƒåŸåˆ™](#æ ¸å¿ƒåŸåˆ™)
    - [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
    - [ä¸‹ä¸€æ­¥å­¦ä¹ ](#ä¸‹ä¸€æ­¥å­¦ä¹ )

---

## ğŸ¯ å­¦ä¹ ç›®æ ‡

å®Œæˆæœ¬æ–‡æ¡£åï¼Œä½ å°†èƒ½å¤Ÿï¼š

- âœ… ç†è§£ç±»å‹ç³»ç»Ÿå¦‚ä½•ä¿è¯æ‰€æœ‰æƒå®‰å…¨
- âœ… æŒæ¡ç»“æ„ä½“å’Œæšä¸¾ä¸­çš„æ‰€æœ‰æƒè®¾è®¡
- âœ… ç†è§£æ³›å‹ä¸æ‰€æœ‰æƒçš„äº¤äº’
- âœ… æŒæ¡æ™ºèƒ½æŒ‡é’ˆçš„æ‰€æœ‰æƒè¯­ä¹‰
- âœ… è®¾è®¡åˆç†çš„å‡½æ•°æ‰€æœ‰æƒç­¾å
- âœ… è§£å†³å¸¸è§çš„æ‰€æœ‰æƒç›¸å…³é—®é¢˜

---

## ğŸ“Š ç« èŠ‚æ¦‚è§ˆ

| ç« èŠ‚ | å†…å®¹ | éš¾åº¦ | é¢„è®¡æ—¶é—´ |
| --- | --- | --- | --- |
| 1. ç±»å‹ç³»ç»Ÿä¸­çš„æ‰€æœ‰æƒ | åŸºç¡€æ¦‚å¿µ | â­â­ | 1h |
| 2. ç»“æ„ä½“ä¸­çš„æ‰€æœ‰æƒ | å®è·µåº”ç”¨ | â­â­â­ | 1.5h |
| 3. æšä¸¾ä¸­çš„æ‰€æœ‰æƒ | å®è·µåº”ç”¨ | â­â­â­ | 1h |
| 4. æ³›å‹ä¸æ‰€æœ‰æƒ | é«˜çº§ä¸»é¢˜ | â­â­â­â­ | 1.5h |
| 5. æ™ºèƒ½æŒ‡é’ˆä¸æ‰€æœ‰æƒ | å®è·µåº”ç”¨ | â­â­â­ | 1h |
| 6. é›†åˆç±»å‹çš„æ‰€æœ‰æƒ | å®è·µåº”ç”¨ | â­â­â­ | 1h |
| 7. å‡½æ•°ç­¾åä¸æ‰€æœ‰æƒ | æœ€ä½³å®è·µ | â­â­â­ | 1h |
| 8. å®æˆ˜æ¡ˆä¾‹ | ç»¼åˆåº”ç”¨ | â­â­â­â­ | 2h |
| 9. å¸¸è§é—®é¢˜ | é—®é¢˜è§£å†³ | â­â­ | 0.5h |
| 10. æ€»ç»“ | çŸ¥è¯†æ•´åˆ | â­ | 0.5h |

---

## 1. ç±»å‹ç³»ç»Ÿä¸­çš„æ‰€æœ‰æƒ

### 1.1 æ‰€æœ‰æƒä¸ç±»å‹ç³»ç»Ÿ

Rust çš„ç±»å‹ç³»ç»Ÿåœ¨ç¼–è¯‘æœŸä¿è¯æ‰€æœ‰æƒè§„åˆ™ï¼Œè¿™æ˜¯ Rust å†…å­˜å®‰å…¨çš„æ ¸å¿ƒã€‚

**æ ¸å¿ƒåŸåˆ™**:

```rust
// æ¯ä¸ªå€¼éƒ½æœ‰å”¯ä¸€çš„æ‰€æœ‰è€…
let s = String::from("hello");  // s æ˜¯ "hello" çš„æ‰€æœ‰è€…

// æ‰€æœ‰æƒè½¬ç§»
let s2 = s;  // s çš„æ‰€æœ‰æƒè½¬ç§»åˆ° s2
// println!("{}", s);  // âŒ ç¼–è¯‘é”™è¯¯ï¼šs ä¸å†æ‹¥æœ‰æ•°æ®
```

**ç±»å‹ç³»ç»Ÿä¿è¯**:

```rust
fn take_ownership(s: String) {
    // s è¿›å…¥å‡½æ•°ï¼Œæ‰€æœ‰æƒè½¬ç§»
    println!("{}", s);
} // s ç¦»å¼€ä½œç”¨åŸŸï¼Œè‡ªåŠ¨é‡Šæ”¾

fn main() {
    let s = String::from("hello");
    take_ownership(s);
    // println!("{}", s);  // âŒ ç¼–è¯‘é”™è¯¯ï¼šs å·²ç§»åŠ¨
}
```

### 1.2 ç±»å‹çº§åˆ«çš„æ‰€æœ‰æƒä¿è¯

ç±»å‹ç³»ç»Ÿåœ¨ç¼–è¯‘æœŸæ£€æŸ¥æ‰€æœ‰æƒè§„åˆ™ï¼š

```rust
// ç¼–è¯‘æœŸæ£€æŸ¥ï¼šç¡®ä¿å¼•ç”¨æœ‰æ•ˆ
fn borrow_string(s: &String) -> &str {
    &s[..]  // è¿”å›çš„å¼•ç”¨ç”Ÿå‘½å‘¨æœŸä¸å‚æ•°ç»‘å®š
}

fn main() {
    let s = String::from("hello");
    let slice = borrow_string(&s);
    println!("{}", slice);  // âœ… s ä»ç„¶æœ‰æ•ˆ
}
```

### 1.3 æ‰€æœ‰æƒç±»å‹è®¾è®¡

è®¾è®¡ç±»å‹æ—¶è€ƒè™‘æ‰€æœ‰æƒï¼š

```rust
// æ‹¥æœ‰æ•°æ®çš„ç»“æ„ä½“
struct Config {
    name: String,      // æ‹¥æœ‰ String
    value: Vec<i32>,   // æ‹¥æœ‰ Vec
}

// å¼•ç”¨æ•°æ®çš„ç»“æ„ä½“ï¼ˆéœ€è¦ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼‰
struct ConfigRef<'a> {
    name: &'a str,     // å€Ÿç”¨å­—ç¬¦ä¸²åˆ‡ç‰‡
    value: &'a [i32],  // å€Ÿç”¨æ•°ç»„åˆ‡ç‰‡
}
```

---

## 2. ç»“æ„ä½“ä¸­çš„æ‰€æœ‰æƒ

### 2.1 æ‹¥æœ‰å­—æ®µ

ç»“æ„ä½“å¯ä»¥æ‹¥æœ‰æ•°æ®ï¼š

```rust
struct Person {
    name: String,
    age: u32,
    hobbies: Vec<String>,
}

fn main() {
    let person = Person {
        name: String::from("Alice"),
        age: 30,
        hobbies: vec![String::from("reading"), String::from("coding")],
    };

    // person æ‹¥æœ‰æ‰€æœ‰å­—æ®µ
    println!("{} is {} years old", person.name, person.age);
} // person åŠå…¶æ‰€æœ‰å­—æ®µè¢«é‡Šæ”¾
```

### 2.2 å¼•ç”¨å­—æ®µ

ç»“æ„ä½“å¯ä»¥åŒ…å«å¼•ç”¨ï¼Œä½†éœ€è¦ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼š

```rust
struct PersonRef<'a> {
    name: &'a str,
    age: &'a u32,
}

fn main() {
    let name = String::from("Alice");
    let age = 30;

    let person = PersonRef {
        name: &name,
        age: &age,
    };

    println!("{} is {} years old", person.name, person.age);
} // person è¢«é‡Šæ”¾ï¼Œä½† name å’Œ age ä»ç„¶æœ‰æ•ˆ
```

### 2.3 æ‰€æœ‰æƒè½¬ç§»æ¨¡å¼

ç»“æ„ä½“çš„æ‰€æœ‰æƒè½¬ç§»ï¼š

```rust
struct Data {
    value: String,
}

fn take_data(d: Data) {
    println!("{}", d.value);
} // d è¢«é‡Šæ”¾

fn main() {
    let data = Data {
        value: String::from("hello"),
    };

    take_data(data);  // data çš„æ‰€æœ‰æƒè½¬ç§»
    // println!("{}", data.value);  // âŒ ç¼–è¯‘é”™è¯¯
}
```

---

## 3. æšä¸¾ä¸­çš„æ‰€æœ‰æƒ

### 3.1 æ‹¥æœ‰æ•°æ®çš„æšä¸¾

æšä¸¾å˜ä½“å¯ä»¥æ‹¥æœ‰æ•°æ®ï¼š

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}

fn process_message(msg: Message) {
    match msg {
        Message::Write(s) => {
            println!("Writing: {}", s);
            // s åœ¨è¿™é‡Œè¢«ä½¿ç”¨
        }
        Message::Move { x, y } => {
            println!("Moving to ({}, {})", x, y);
        }
        _ => {}
    }
} // msg åŠå…¶æ•°æ®è¢«é‡Šæ”¾
```

### 3.2 å¼•ç”¨æ•°æ®çš„æšä¸¾

æšä¸¾ä¹Ÿå¯ä»¥åŒ…å«å¼•ç”¨ï¼š

```rust
enum MessageRef<'a> {
    Text(&'a str),
    Number(&'a i32),
}

fn main() {
    let text = String::from("hello");
    let num = 42;

    let msg1 = MessageRef::Text(&text);
    let msg2 = MessageRef::Number(&num);

    match msg1 {
        MessageRef::Text(s) => println!("{}", s),
        _ => {}
    }
}
```

### 3.3 æ‰€æœ‰æƒæ¨¡å¼åŒ¹é…

æ¨¡å¼åŒ¹é…æ—¶çš„æ‰€æœ‰æƒï¼š

```rust
enum Option<T> {
    Some(T),
    None,
}

fn take_option(o: Option<String>) {
    match o {
        Option::Some(s) => {
            // s çš„æ‰€æœ‰æƒè½¬ç§»åˆ°è¿™ä¸ªåˆ†æ”¯
            println!("Got: {}", s);
        }
        Option::None => {
            println!("Nothing");
        }
    }
    // s åœ¨è¿™é‡Œå·²è¢«é‡Šæ”¾
}
```

---

## 4. æ³›å‹ä¸æ‰€æœ‰æƒ

### 4.1 æ³›å‹å‚æ•°çš„æ‰€æœ‰æƒ

æ³›å‹ç±»å‹éµå¾ªæ‰€æœ‰æƒè§„åˆ™ï¼š

```rust
struct Container<T> {
    value: T,
}

impl<T> Container<T> {
    fn new(value: T) -> Self {
        Container { value }
    }

    fn get(self) -> T {
        self.value  // æ‰€æœ‰æƒè½¬ç§»
    }
}

fn main() {
    let container = Container::new(String::from("hello"));
    let value = container.get();  // container çš„æ‰€æœ‰æƒè½¬ç§»
    println!("{}", value);
}
```

### 4.2 æ‰€æœ‰æƒçº¦æŸ

ä½¿ç”¨ trait çº¦æŸæ§åˆ¶æ‰€æœ‰æƒï¼š

```rust
use std::fmt::Display;

fn print_and_drop<T: Display>(value: T) {
    println!("{}", value);
} // value è¢«é‡Šæ”¾

fn main() {
    let s = String::from("hello");
    print_and_drop(s);
    // println!("{}", s);  // âŒ ç¼–è¯‘é”™è¯¯
}
```

### 4.3 ç§»åŠ¨è¯­ä¹‰ä¸æ³›å‹

æ³›å‹å‡½æ•°ä¸­çš„ç§»åŠ¨è¯­ä¹‰ï¼š

```rust
fn move_value<T>(value: T) -> T {
    value  // è¿”å›æ‰€æœ‰æƒ
}

fn main() {
    let s = String::from("hello");
    let s2 = move_value(s);  // s çš„æ‰€æœ‰æƒè½¬ç§»
    println!("{}", s2);
}
```

---

## 5. æ™ºèƒ½æŒ‡é’ˆä¸æ‰€æœ‰æƒ

### 5.1 Box çš„æ‰€æœ‰æƒè¯­ä¹‰

`Box<T>` æ‹¥æœ‰å †ä¸Šæ•°æ®çš„æ‰€æœ‰æƒï¼š

```rust
fn main() {
    let boxed = Box::new(String::from("hello"));
    // boxed æ‹¥æœ‰å †ä¸Š String çš„æ‰€æœ‰æƒ

    let s = *boxed;  // è§£å¼•ç”¨è·å–æ‰€æœ‰æƒ
    println!("{}", s);
    // boxed ä¸å†æœ‰æ•ˆ
}
```

### 5.2 Rc ä¸å…±äº«æ‰€æœ‰æƒ

`Rc<T>` æä¾›å…±äº«æ‰€æœ‰æƒï¼š

```rust
use std::rc::Rc;

fn main() {
    let data = Rc::new(String::from("hello"));

    let data1 = Rc::clone(&data);
    let data2 = Rc::clone(&data);

    // data, data1, data2 å…±äº«æ‰€æœ‰æƒ
    println!("{}", data);
    println!("{}", data1);
    println!("{}", data2);
} // æ‰€æœ‰å¼•ç”¨è®¡æ•°å½’é›¶æ—¶ï¼Œæ•°æ®è¢«é‡Šæ”¾
```

### 5.3 Arc ä¸çº¿ç¨‹å®‰å…¨çš„æ‰€æœ‰æƒ

`Arc<T>` æä¾›çº¿ç¨‹å®‰å…¨çš„å…±äº«æ‰€æœ‰æƒï¼š

```rust
use std::sync::Arc;
use std::thread;

fn main() {
    let data = Arc::new(String::from("hello"));

    let data1 = Arc::clone(&data);
    let handle = thread::spawn(move || {
        println!("Thread: {}", data1);
    });

    println!("Main: {}", data);
    handle.join().unwrap();
}
```

---

## 6. é›†åˆç±»å‹çš„æ‰€æœ‰æƒ

### 6.1 Vec çš„æ‰€æœ‰æƒç®¡ç†

`Vec<T>` æ‹¥æœ‰å…¶å…ƒç´ çš„æ‰€æœ‰æƒï¼š

```rust
fn main() {
    let mut vec = Vec::new();
    vec.push(String::from("hello"));
    vec.push(String::from("world"));

    // vec æ‹¥æœ‰æ‰€æœ‰ String çš„æ‰€æœ‰æƒ
    for s in vec {
        println!("{}", s);
        // s çš„æ‰€æœ‰æƒåœ¨æ¯æ¬¡è¿­ä»£ä¸­è½¬ç§»
    }
    // vec ä¸å†æœ‰æ•ˆ
}
```

### 6.2 HashMap çš„æ‰€æœ‰æƒ

`HashMap<K, V>` æ‹¥æœ‰é”®å’Œå€¼çš„æ‰€æœ‰æƒï¼š

```rust
use std::collections::HashMap;

fn main() {
    let mut map = HashMap::new();
    map.insert(String::from("key"), String::from("value"));

    // map æ‹¥æœ‰é”®å’Œå€¼çš„æ‰€æœ‰æƒ
    for (k, v) in map {
        println!("{}: {}", k, v);
    }
}
```

### 6.3 é›†åˆçš„æ‰€æœ‰æƒä¼ é€’

é›†åˆçš„æ‰€æœ‰æƒè½¬ç§»ï¼š

```rust
fn take_vec(v: Vec<String>) {
    for s in v {
        println!("{}", s);
    }
}

fn main() {
    let vec = vec![String::from("a"), String::from("b")];
    take_vec(vec);  // vec çš„æ‰€æœ‰æƒè½¬ç§»
    // println!("{:?}", vec);  // âŒ ç¼–è¯‘é”™è¯¯
}
```

---

## 7. å‡½æ•°ç­¾åä¸æ‰€æœ‰æƒ

### 7.1 å‚æ•°æ‰€æœ‰æƒè®¾è®¡

è®¾è®¡å‡½æ•°æ—¶è€ƒè™‘æ‰€æœ‰æƒï¼š

```rust
// æ‹¥æœ‰å‚æ•°ï¼šå‡½æ•°è·å¾—æ‰€æœ‰æƒ
fn process_owned(data: String) {
    println!("{}", data);
}

// å€Ÿç”¨å‚æ•°ï¼šå‡½æ•°å€Ÿç”¨æ•°æ®
fn process_borrowed(data: &String) {
    println!("{}", data);
}

// å¯å˜å€Ÿç”¨ï¼šå‡½æ•°å¯ä»¥ä¿®æ”¹æ•°æ®
fn process_mut(data: &mut String) {
    data.push_str(" world");
}
```

### 7.2 è¿”å›å€¼æ‰€æœ‰æƒ

è¿”å›å€¼çš„æ‰€æœ‰æƒï¼š

```rust
// è¿”å›æ‹¥æœ‰çš„å€¼
fn create_string() -> String {
    String::from("hello")
}

// è¿”å›å¼•ç”¨ï¼ˆéœ€è¦ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼‰
fn get_slice<'a>(s: &'a str) -> &'a str {
    &s[..]
}
```

### 7.3 æ‰€æœ‰æƒæœ€ä½³å®è·µ

**æ¨èæ¨¡å¼**:

1. **ä¼˜å…ˆä½¿ç”¨å€Ÿç”¨**: å¦‚æœä¸éœ€è¦æ‰€æœ‰æƒï¼Œä½¿ç”¨å¼•ç”¨
2. **æ˜ç¡®æ‰€æœ‰æƒè½¬ç§»**: ä½¿ç”¨ `move` å…³é”®å­—æ˜ç¡®è½¬ç§»
3. **è¿”å›æ‰€æœ‰æƒ**: éœ€è¦æ—¶è¿”å›æ‹¥æœ‰çš„å€¼

```rust
// âœ… æ¨èï¼šä½¿ç”¨å€Ÿç”¨
fn process(data: &String) {
    println!("{}", data);
}

// âœ… æ¨èï¼šéœ€è¦æ‰€æœ‰æƒæ—¶æ˜ç¡®è½¬ç§»
fn take_ownership(data: String) -> String {
    format!("Processed: {}", data)
}
```

---

## 8. å®æˆ˜æ¡ˆä¾‹

### 8.1 æ¡ˆä¾‹1: é…ç½®ç®¡ç†ç³»ç»Ÿ

```rust
struct Config {
    name: String,
    settings: Vec<String>,
}

impl Config {
    fn new(name: String) -> Self {
        Config {
            name,
            settings: Vec::new(),
        }
    }

    fn add_setting(&mut self, setting: String) {
        self.settings.push(setting);
    }

    fn into_settings(self) -> Vec<String> {
        self.settings  // è½¬ç§»æ‰€æœ‰æƒ
    }
}

fn main() {
    let mut config = Config::new(String::from("my_config"));
    config.add_setting(String::from("setting1"));

    let settings = config.into_settings();
    // config ä¸å†æœ‰æ•ˆï¼Œä½† settings å¯ç”¨
    println!("Settings: {:?}", settings);
}
```

### 8.2 æ¡ˆä¾‹2: èµ„æºç®¡ç†å™¨

```rust
struct Resource {
    id: String,
    data: Vec<u8>,
}

struct ResourceManager {
    resources: Vec<Resource>,
}

impl ResourceManager {
    fn new() -> Self {
        ResourceManager {
            resources: Vec::new(),
        }
    }

    fn add_resource(&mut self, resource: Resource) {
        self.resources.push(resource);
    }

    fn take_resource(&mut self, id: &str) -> Option<Resource> {
        let pos = self.resources.iter().position(|r| r.id == id)?;
        Some(self.resources.remove(pos))
    }
}

fn main() {
    let mut manager = ResourceManager::new();
    manager.add_resource(Resource {
        id: String::from("res1"),
        data: vec![1, 2, 3],
    });

    if let Some(resource) = manager.take_resource("res1") {
        println!("Got resource: {}", resource.id);
    }
}
```

### 8.3 æ¡ˆä¾‹3: æ•°æ®ç®¡é“

```rust
struct DataProcessor {
    data: Vec<String>,
}

impl DataProcessor {
    fn new(data: Vec<String>) -> Self {
        DataProcessor { data }
    }

    fn process(mut self) -> Vec<String> {
        self.data.iter_mut().for_each(|s| {
            s.push_str("_processed");
        });
        self.data  // è¿”å›å¤„ç†åçš„æ•°æ®
    }
}

fn main() {
    let processor = DataProcessor::new(vec![
        String::from("data1"),
        String::from("data2"),
    ]);

    let processed = processor.process();
    println!("{:?}", processed);
}
```

---

## 9. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### é—®é¢˜1: æ‰€æœ‰æƒè½¬ç§»åæ— æ³•ä½¿ç”¨

**é”™è¯¯ä»£ç **:

```rust
let s = String::from("hello");
let s2 = s;
println!("{}", s);  // âŒ ç¼–è¯‘é”™è¯¯
```

**è§£å†³æ–¹æ¡ˆ**:

```rust
let s = String::from("hello");
let s2 = s.clone();  // å…‹éš†æ•°æ®
println!("{}", s);   // âœ… ç°åœ¨å¯ä»¥äº†
```

### é—®é¢˜2: ç»“æ„ä½“å­—æ®µæ‰€æœ‰æƒ

**é”™è¯¯ä»£ç **:

```rust
struct Person {
    name: String,
}

let person = Person { name: String::from("Alice") };
let name = person.name;  // æ‰€æœ‰æƒè½¬ç§»
println!("{}", person.name);  // âŒ ç¼–è¯‘é”™è¯¯
```

**è§£å†³æ–¹æ¡ˆ**:

```rust
let name = person.name.clone();  // å…‹éš†
// æˆ–
let name = &person.name;  // å€Ÿç”¨
```

### é—®é¢˜3: å¾ªç¯ä¸­çš„æ‰€æœ‰æƒ

**é”™è¯¯ä»£ç **:

```rust
let vec = vec![String::from("a"), String::from("b")];
for s in vec {
    println!("{}", s);
}
println!("{:?}", vec);  // âŒ ç¼–è¯‘é”™è¯¯
```

**è§£å†³æ–¹æ¡ˆ**:

```rust
let vec = vec![String::from("a"), String::from("b")];
for s in &vec {  // å€Ÿç”¨
    println!("{}", s);
}
println!("{:?}", vec);  // âœ…
```

---

## 10. æ€»ç»“ä¸æœ€ä½³å®è·µ

### æ ¸å¿ƒåŸåˆ™

1. **æ¯ä¸ªå€¼æœ‰å”¯ä¸€æ‰€æœ‰è€…**: ç±»å‹ç³»ç»Ÿä¿è¯è¿™ä¸€ç‚¹
2. **æ‰€æœ‰æƒå¯ä»¥è½¬ç§»**: é€šè¿‡ç§»åŠ¨è¯­ä¹‰å®ç°
3. **å€Ÿç”¨é¿å…æ‰€æœ‰æƒè½¬ç§»**: ä½¿ç”¨å¼•ç”¨å…±äº«æ•°æ®
4. **ç”Ÿå‘½å‘¨æœŸä¿è¯å¼•ç”¨æœ‰æ•ˆ**: ç¼–è¯‘æœŸæ£€æŸ¥

### æœ€ä½³å®è·µ

1. **ä¼˜å…ˆä½¿ç”¨å€Ÿç”¨**: ä¸éœ€è¦æ‰€æœ‰æƒæ—¶ä½¿ç”¨ `&T`
2. **æ˜ç¡®æ‰€æœ‰æƒæ„å›¾**: éœ€è¦æ‰€æœ‰æƒæ—¶æ˜ç¡®è½¬ç§»
3. **åˆç†ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ**: `Rc`/`Arc` ç”¨äºå…±äº«æ‰€æœ‰æƒ
4. **è®¾è®¡æ¸…æ™°çš„API**: å‡½æ•°ç­¾åæ˜ç¡®æ‰€æœ‰æƒè¯­ä¹‰

### ä¸‹ä¸€æ­¥å­¦ä¹ 

- [å¼•ç”¨ä¸å€Ÿç”¨å®è·µæŒ‡å—](./02_å¼•ç”¨ä¸å€Ÿç”¨å®è·µ.md)
- [æ³›å‹ç¼–ç¨‹æŒ‡å—](./03_æ³›å‹ç¼–ç¨‹æŒ‡å—.md)
- [ç”Ÿå‘½å‘¨æœŸæŒ‡å—](./05_ç”Ÿå‘½å‘¨æœŸæŒ‡å—.md)

---

**æœ€åæ›´æ–°**: 2025-12-11
**Rustç‰ˆæœ¬**: 1.92.0+
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
