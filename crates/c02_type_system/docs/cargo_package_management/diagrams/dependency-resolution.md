# Cargo ä¾èµ–è§£ææµç¨‹å¯è§†åŒ–

## ğŸ“Š ç›®å½•

- [Cargo ä¾èµ–è§£ææµç¨‹å¯è§†åŒ–](#cargo-ä¾èµ–è§£ææµç¨‹å¯è§†åŒ–)
  - [ğŸ“Š ç›®å½•](#-ç›®å½•)
  - [ğŸ“Š Resolver 3 ä¾èµ–è§£ææµç¨‹](#-resolver-3-ä¾èµ–è§£ææµç¨‹)
    - [æ•´ä½“æµç¨‹å›¾](#æ•´ä½“æµç¨‹å›¾)
  - [ğŸ” è¯¦ç»†è§£ææ­¥éª¤](#-è¯¦ç»†è§£ææ­¥éª¤)
    - [1. ä¾èµ–å›¾æ„å»º](#1-ä¾èµ–å›¾æ„å»º)
    - [2. ç‰ˆæœ¬å†²çªè§£æ (Resolver 3)](#2-ç‰ˆæœ¬å†²çªè§£æ-resolver-3)
    - [3. ç‰¹æ€§ä¼ æ’­æµç¨‹](#3-ç‰¹æ€§ä¼ æ’­æµç¨‹)
    - [4. ä¾èµ–æ ‘ç¤ºä¾‹](#4-ä¾èµ–æ ‘ç¤ºä¾‹)
  - [ğŸ¯ Resolver ç‰ˆæœ¬å¯¹æ¯”](#-resolver-ç‰ˆæœ¬å¯¹æ¯”)
    - [Resolver 1 vs 2 vs 3](#resolver-1-vs-2-vs-3)
  - [ğŸ“ˆ æ€§èƒ½å¯¹æ¯”](#-æ€§èƒ½å¯¹æ¯”)
    - [è§£ææ—¶é—´å¯¹æ¯”](#è§£ææ—¶é—´å¯¹æ¯”)
    - [æ„å»ºç¼“å­˜å‘½ä¸­ç‡](#æ„å»ºç¼“å­˜å‘½ä¸­ç‡)
  - [ğŸ”§ é…ç½®ç¤ºä¾‹](#-é…ç½®ç¤ºä¾‹)
    - [å¯ç”¨ Resolver 3](#å¯ç”¨-resolver-3)
  - [ğŸ› å¸¸è§é—®é¢˜è¯Šæ–­](#-å¸¸è§é—®é¢˜è¯Šæ–­)
    - [é—®é¢˜ 1: ç‰ˆæœ¬å†²çª](#é—®é¢˜-1-ç‰ˆæœ¬å†²çª)
    - [é—®é¢˜ 2: ç‰¹æ€§å†²çª](#é—®é¢˜-2-ç‰¹æ€§å†²çª)
  - [ğŸ“š ç›¸å…³èµ„æº](#-ç›¸å…³èµ„æº)

**ç‰ˆæœ¬**: Rust 1.93.0+ / Cargo 1.93.0+ï¼ˆå…¼å®¹ Rust 1.90+ ç‰¹æ€§ï¼‰
**åˆ›å»ºæ—¥æœŸ**: 2025-10-19

---

## ğŸ“Š Resolver 3 ä¾èµ–è§£ææµç¨‹

### æ•´ä½“æµç¨‹å›¾

```mermaid
graph TD
    A[å¼€å§‹è§£æ] --> B[è¯»å– Cargo.toml]
    B --> C[æ„å»ºä¾èµ–å›¾]
    C --> D{æ£€æŸ¥ç‰ˆæœ¬å†²çª}
    D -->|æœ‰å†²çª| E[åº”ç”¨ Resolver 3 ç­–ç•¥]
    D -->|æ— å†²çª| F[ç‰¹æ€§ç»Ÿä¸€]
    E --> F
    F --> G[ç”Ÿæˆ Cargo.lock]
    G --> H[è§£æå®Œæˆ]

    style A fill:#e1f5ff
    style H fill:#c8e6c9
    style E fill:#fff9c4
```

---

## ğŸ” è¯¦ç»†è§£ææ­¥éª¤

### 1. ä¾èµ–å›¾æ„å»º

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ ¹åŒ… (Root)                        â”‚
â”‚                  my-project 1.0.0                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                         â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â–¼             â–¼           â–¼             â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ tokio  â”‚    â”‚ serde  â”‚  â”‚ reqwestâ”‚   â”‚ clap   â”‚
       â”‚ 1.48   â”‚    â”‚ 1.0    â”‚  â”‚ 0.12   â”‚   â”‚ 4.5    â”‚
       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚             â”‚           â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”      â”‚           â”œâ”€â”€â”€â”€â”€â”€â”
            â–¼      â–¼      â–¼           â–¼      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”
        â”‚ mio  â”‚â”‚libc  â”‚â”‚serdeâ”‚    â”‚tokioâ”‚â”‚http â”‚
        â”‚ 1.0  â”‚â”‚0.2   â”‚â”‚ 1.0 â”‚    â”‚ 1.48â”‚â”‚ 1.1 â”‚
        â””â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”˜
                        â–²                   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         (ç‰ˆæœ¬ç»Ÿä¸€)
```

**å…³é”®ç‚¹**:

- ç›¸åŒä¾èµ–ä¸åŒç‰ˆæœ¬ä¼šè¢«æ£€æµ‹
- Resolver 3 ä¼šå°è¯•ç»Ÿä¸€ç‰ˆæœ¬
- é¿å…ä¸å¿…è¦çš„é‡å¤ç¼–è¯‘

---

### 2. ç‰ˆæœ¬å†²çªè§£æ (Resolver 3)

```text
å†²çªåœºæ™¯:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Package A éœ€è¦ tokio ^1.40              â”‚
â”‚  Package B éœ€è¦ tokio ^1.48              â”‚
â”‚  å¦‚ä½•è§£å†³ï¼Ÿ                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Resolver 3 ç­–ç•¥:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. è®¡ç®—ç‰ˆæœ¬å…¼å®¹æ€§                         â”‚
â”‚    ^1.40 âˆ© ^1.48 = 1.48.0                â”‚
â”‚                                          â”‚
â”‚ 2. é€‰æ‹©æœ€æ–°å…¼å®¹ç‰ˆæœ¬                       â”‚
â”‚    âœ“ é€‰æ‹© tokio 1.48.0                   â”‚
â”‚                                          â”‚
â”‚ 3. éªŒè¯æ‰€æœ‰ä¾èµ–æ»¡è¶³                       â”‚
â”‚    âœ“ A: 1.48.0 â‰¥ 1.40.0 âœ…              â”‚
â”‚    âœ“ B: 1.48.0 â‰¥ 1.48.0 âœ…              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç»“æœ: ç»Ÿä¸€ä½¿ç”¨ tokio 1.48.0
```

---

### 3. ç‰¹æ€§ä¼ æ’­æµç¨‹

```mermaid
graph LR
    A[æ ¹åŒ…å¯ç”¨ tokio/full] --> B[tokio 1.48]
    B --> C{æ£€æŸ¥ç‰¹æ€§ä¾èµ–}
    C -->|éœ€è¦ mio| D[å¯ç”¨ mio]
    C -->|éœ€è¦ tokio-macros| E[å¯ç”¨ tokio-macros]
    C -->|éœ€è¦ signal| F[å¯ç”¨ signal]

    D --> G[ç‰¹æ€§ç»Ÿä¸€]
    E --> G
    F --> G
    G --> H[ç”Ÿæˆæœ€ç»ˆç‰¹æ€§é›†]

    style A fill:#e1f5ff
    style H fill:#c8e6c9
```

**Resolver 3 æ”¹è¿›**:

- æ›´ç²¾ç¡®çš„ç‰¹æ€§ä¼ æ’­
- é¿å…ä¸å¿…è¦çš„ç‰¹æ€§æ¿€æ´»
- å‡å°‘ç¼–è¯‘æ—¶é—´å’ŒäºŒè¿›åˆ¶å¤§å°

---

### 4. ä¾èµ–æ ‘ç¤ºä¾‹

```bash
$ cargo tree --depth 2

my-project v1.0.0 (E:\_src\my-project)
â”œâ”€â”€ clap v4.5.0
â”‚   â”œâ”€â”€ clap_builder v4.5.0
â”‚   â””â”€â”€ clap_derive v4.5.0
â”œâ”€â”€ reqwest v0.12.0
â”‚   â”œâ”€â”€ base64 v0.21.0
â”‚   â”œâ”€â”€ http v1.1.0
â”‚   â”œâ”€â”€ tokio v1.48.0 (*)
â”‚   â””â”€â”€ ...
â”œâ”€â”€ serde v1.0.0
â”‚   â””â”€â”€ serde_derive v1.0.0
â””â”€â”€ tokio v1.48.0
    â”œâ”€â”€ bytes v1.5.0
    â”œâ”€â”€ mio v1.0.0
    â”œâ”€â”€ pin-project-lite v0.2.0
    â””â”€â”€ ...

(*) è¡¨ç¤ºç‰ˆæœ¬ç»Ÿä¸€çš„ä¾èµ–
```

---

## ğŸ¯ Resolver ç‰ˆæœ¬å¯¹æ¯”

### Resolver 1 vs 2 vs 3

| ç‰¹æ€§         | Resolver 1 | Resolver 2 | Resolver 3  |
| ------------ | ---------- | ---------- | ----------- |
| **ç‰¹æ€§ç»Ÿä¸€** | âŒ ä¸ç»Ÿä¸€  | âœ… ç»Ÿä¸€    | âœ… æ™ºèƒ½ç»Ÿä¸€ |
| **ç‰ˆæœ¬é€‰æ‹©** | ä¿å®ˆ       | æ¿€è¿›       | å¹³è¡¡        |
| **æ€§èƒ½**     | åŸºå‡†       | +10%       | +15-20%     |
| **æ„å»ºç¼“å­˜** | åŸºç¡€       | æ”¹è¿›       | æ˜¾è‘—æ”¹è¿›    |
| **å†²çªæ£€æµ‹** | åŸºç¡€       | ä¸­ç­‰       | é«˜çº§        |
| **Edition**  | 2015/2018  | 2021       | 2024        |

---

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

### è§£ææ—¶é—´å¯¹æ¯”

```text
Resolver 1:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100% (åŸºå‡†)
Resolver 2:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    90%  (-10%)
Resolver 3:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ       75%  (-25%)

é¡¹ç›®è§„æ¨¡: 50+ ä¾èµ–
```

### æ„å»ºç¼“å­˜å‘½ä¸­ç‡

```text
Resolver 1:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      60%
Resolver 2:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  75%
Resolver 3:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 85%
```

---

## ğŸ”§ é…ç½®ç¤ºä¾‹

### å¯ç”¨ Resolver 3

```toml
# Cargo.toml
[package]
name = "my-project"
version = "1.0.0"
edition = "2024"
resolver = "3"  # ğŸ¯ å…³é”®é…ç½®

[dependencies]
tokio = { version = "1.48", features = ["full"] }
serde = { version = "1.0", features = ["derive"] }
```

---

## ğŸ› å¸¸è§é—®é¢˜è¯Šæ–­

### é—®é¢˜ 1: ç‰ˆæœ¬å†²çª

```bash
# æŸ¥çœ‹ä¾èµ–æ ‘
cargo tree --duplicates

# è¾“å‡ºç¤ºä¾‹:
tokio v1.40.0
â””â”€â”€ package-a v1.0.0

tokio v1.48.0
â””â”€â”€ package-b v2.0.0

# è§£å†³: æ›´æ–° Cargo.toml
[dependencies]
tokio = "1.48"  # ç»Ÿä¸€ç‰ˆæœ¬
```

### é—®é¢˜ 2: ç‰¹æ€§å†²çª

```bash
# æŸ¥çœ‹ç‰¹æ€§ä¼ æ’­
cargo tree --format "{p} {f}"

# è§£å†³ç­–ç•¥
[dependencies]
tokio = { version = "1.48", features = ["full"], default-features = false }
```

---

## ğŸ“š ç›¸å…³èµ„æº

- [Cargo Book - Dependency Resolution](https://doc.rust-lang.org/cargo/reference/resolver.html)
- [RFC 3537 - Resolver 3](https://github.com/rust-lang/rfcs/pull/3537)
- [ä¾èµ–ç®¡ç†è¯¦è§£](../03_ä¾èµ–ç®¡ç†è¯¦è§£.md)

---

**ç»´æŠ¤çŠ¶æ€**: ğŸŸ¢ æ´»è·ƒç»´æŠ¤ä¸­
**æœ€åæ›´æ–°**: 2026-01-26
