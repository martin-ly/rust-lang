# Const æ³›å‹å¯¹æ¯”çŸ©é˜µ

## ğŸ“‹ ç›®å½•

- [Const æ³›å‹å¯¹æ¯”çŸ©é˜µ](#const-æ³›å‹å¯¹æ¯”çŸ©é˜µ)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [æ–‡æ¡£å®šä½](#æ–‡æ¡£å®šä½)
  - [1. Constæ³›å‹æ¦‚è§ˆ](#1-constæ³›å‹æ¦‚è§ˆ)
    - [1.1 æ ¸å¿ƒæ¦‚å¿µ](#11-æ ¸å¿ƒæ¦‚å¿µ)
    - [1.2 æ”¯æŒçš„å¸¸é‡ç±»å‹](#12-æ”¯æŒçš„å¸¸é‡ç±»å‹)
  - [2. Constæ³›å‹ vs ç±»å‹æ³›å‹](#2-constæ³›å‹-vs-ç±»å‹æ³›å‹)
    - [2.1 æ ¸å¿ƒå·®å¼‚çŸ©é˜µ](#21-æ ¸å¿ƒå·®å¼‚çŸ©é˜µ)
    - [2.2 åœºæ™¯é€‚ç”¨æ€§å¯¹æ¯”](#22-åœºæ™¯é€‚ç”¨æ€§å¯¹æ¯”)
  - [3. Constæ³›å‹ vs åŠ¨æ€å¤§å°](#3-constæ³›å‹-vs-åŠ¨æ€å¤§å°)
    - [3.1 æ€§èƒ½å¯¹æ¯”çŸ©é˜µ](#31-æ€§èƒ½å¯¹æ¯”çŸ©é˜µ)
    - [3.2 åŸºå‡†æµ‹è¯•æ•°æ®](#32-åŸºå‡†æµ‹è¯•æ•°æ®)
  - [4. Constæ³›å‹ vs å®](#4-constæ³›å‹-vs-å®)
    - [4.1 å¯¹æ¯”çŸ©é˜µ](#41-å¯¹æ¯”çŸ©é˜µ)
    - [4.2 å®æˆ˜å¯¹æ¯”](#42-å®æˆ˜å¯¹æ¯”)
    - [4.3 é€‰æ‹©å†³ç­–](#43-é€‰æ‹©å†³ç­–)
  - [5. Constæ³›å‹é«˜çº§æ¨¡å¼](#5-constæ³›å‹é«˜çº§æ¨¡å¼)
    - [5.1 å¸¸é‡è¡¨è¾¾å¼](#51-å¸¸é‡è¡¨è¾¾å¼)
    - [5.2 constæ³›å‹çº¦æŸ](#52-constæ³›å‹çº¦æŸ)
    - [5.3 constæ³›å‹é»˜è®¤å€¼](#53-constæ³›å‹é»˜è®¤å€¼)
  - [6. å®é™…åº”ç”¨æ¡ˆä¾‹](#6-å®é™…åº”ç”¨æ¡ˆä¾‹)
    - [6.1 çŸ©é˜µè¿ç®—](#61-çŸ©é˜µè¿ç®—)
    - [6.2 å®šé•¿ç¼“å†²åŒº](#62-å®šé•¿ç¼“å†²åŒº)
    - [6.3 ç±»å‹å®‰å…¨çš„å•ä½ç³»ç»Ÿ](#63-ç±»å‹å®‰å…¨çš„å•ä½ç³»ç»Ÿ)
  - [7. é™åˆ¶ä¸é™·é˜±](#7-é™åˆ¶ä¸é™·é˜±)
    - [7.1 å½“å‰é™åˆ¶ï¼ˆRust 1.90ï¼‰](#71-å½“å‰é™åˆ¶rust-190)
    - [7.2 å¸¸è§é™·é˜±](#72-å¸¸è§é™·é˜±)
  - [8. æ¼”åŒ–è·¯çº¿å›¾](#8-æ¼”åŒ–è·¯çº¿å›¾)
    - [8.1 å·²ç¨³å®šç‰¹æ€§](#81-å·²ç¨³å®šç‰¹æ€§)
    - [8.2 æœªæ¥æ–¹å‘ï¼ˆRFCææ¡ˆï¼‰](#82-æœªæ¥æ–¹å‘rfcææ¡ˆ)
  - [9. å†³ç­–çŸ©é˜µ](#9-å†³ç­–çŸ©é˜µ)
    - [9.1 ä½•æ—¶ä½¿ç”¨Constæ³›å‹](#91-ä½•æ—¶ä½¿ç”¨constæ³›å‹)
    - [9.2 æ€§èƒ½æƒè¡¡çŸ©é˜µ](#92-æ€§èƒ½æƒè¡¡çŸ©é˜µ)
  - [10. å®æˆ˜æ£€æŸ¥æ¸…å•](#10-å®æˆ˜æ£€æŸ¥æ¸…å•)
  - [11. å…³è”æ–‡æ¡£](#11-å…³è”æ–‡æ¡£)
  - [12. ä¿®è®¢å†å²](#12-ä¿®è®¢å†å²)

## æ–‡æ¡£å®šä½

æœ¬æ–‡æ¡£æä¾›**Constæ³›å‹ï¼ˆå¸¸é‡æ³›å‹ï¼‰çš„ç³»ç»Ÿæ€§åˆ†æ**ï¼Œå¸®åŠ©å¼€å‘è€…ï¼š

- ç†è§£Constæ³›å‹ä¸ç±»å‹æ³›å‹çš„å·®å¼‚
- æŒæ¡Constæ³›å‹çš„æœ€ä½³å®è·µ
- åœ¨ç¼–è¯‘æœŸè®¡ç®—å’Œç±»å‹çº§ç¼–ç¨‹é—´åšå‡ºé€‰æ‹©

---

## 1. Constæ³›å‹æ¦‚è§ˆ

### 1.1 æ ¸å¿ƒæ¦‚å¿µ

```rust
// Constæ³›å‹ï¼šå°†ç¼–è¯‘æœŸå¸¸é‡ä½œä¸ºæ³›å‹å‚æ•°
fn process_array<const N: usize>(arr: [i32; N]) -> i32 {
    arr.iter().sum()
}

// è°ƒç”¨ï¼šç±»å‹ç³»ç»Ÿè‡ªåŠ¨æ¨å¯¼N=5
let result = process_array([1, 2, 3, 4, 5]);
```

### 1.2 æ”¯æŒçš„å¸¸é‡ç±»å‹

| ç±»å‹ | æ˜¯å¦æ”¯æŒ | ç¨³å®šç‰ˆæœ¬ | ç¤ºä¾‹ |
|-----|---------|---------|------|
| **æ•´æ•°ç±»å‹** | âœ… | Rust 1.51 | `const N: usize`, `const X: i32` |
| **å¸ƒå°”ç±»å‹** | âœ… | Rust 1.51 | `const FLAG: bool` |
| **å­—ç¬¦ç±»å‹** | âœ… | Rust 1.51 | `const C: char` |
| **æµ®ç‚¹æ•°** | âŒ | æœªæ”¯æŒ | PartialEqé—®é¢˜ |
| **å­—ç¬¦ä¸²** | âŒ | æœªæ”¯æŒ | éœ€è¦`const &str`ï¼ˆRust 1.90+éƒ¨åˆ†æ”¯æŒï¼‰ |
| **è‡ªå®šä¹‰ç±»å‹** | âš ï¸ | éƒ¨åˆ†æ”¯æŒ | éœ€å®ç°`ConstParamTy` (Rust 1.90+) |

---

## 2. Constæ³›å‹ vs ç±»å‹æ³›å‹

### 2.1 æ ¸å¿ƒå·®å¼‚çŸ©é˜µ

| ç»´åº¦ | Constæ³›å‹ `<const N: usize>` | ç±»å‹æ³›å‹ `<T>` |
|-----|----------------------------|---------------|
| **å‚æ•°æ€§è´¨** | ç¼–è¯‘æœŸå¸¸é‡å€¼ | ç±»å‹ |
| **è¡¨è¾¾èƒ½åŠ›** | æ•°å€¼è®¡ç®—ã€æ•°ç»„å¤§å° | ä»»æ„ç±»å‹æŠ½è±¡ |
| **ç±»å‹ç³»ç»Ÿ** | ä¾èµ–ç±»å‹ï¼ˆDependent Typesï¼‰æ€æƒ³ | å‚æ•°å¤šæ€ï¼ˆParametric Polymorphismï¼‰ |
| **æ¨å¯¼èƒ½åŠ›** | å¼ºï¼ˆä»å€¼æ¨å¯¼ï¼‰ | å¼ºï¼ˆä»ç±»å‹æ¨å¯¼ï¼‰ |
| **è¿è¡Œæ—¶å¼€é”€** | é›¶ï¼ˆå•æ€åŒ–ï¼‰ | é›¶ï¼ˆå•æ€åŒ–ï¼‰ |
| **ä»£ç è†¨èƒ€** | æŒ‰å¸¸é‡å€¼å®ä¾‹åŒ– | æŒ‰ç±»å‹å®ä¾‹åŒ– |
| **ä½¿ç”¨é¢‘ç‡** | ç‰¹å®šåœºæ™¯ | é€šç”¨åœºæ™¯ |

### 2.2 åœºæ™¯é€‚ç”¨æ€§å¯¹æ¯”

| åœºæ™¯ | Constæ³›å‹ | ç±»å‹æ³›å‹ | æ¨èæ–¹æ¡ˆ |
|-----|----------|---------|---------|
| **å›ºå®šå¤§å°æ•°ç»„** | â­â­â­â­â­ | â­â­ | Constæ³›å‹ |
| **çŸ©é˜µè¿ç®—** | â­â­â­â­â­ | â­â­ | Constæ³›å‹ |
| **ç¼–è¯‘æœŸæ ¡éªŒ** | â­â­â­â­â­ | â­â­â­ | Constæ³›å‹ |
| **å®¹å™¨ç±»å‹** | â­â­ | â­â­â­â­â­ | ç±»å‹æ³›å‹ |
| **ç®—æ³•æŠ½è±¡** | â­ | â­â­â­â­â­ | ç±»å‹æ³›å‹ |
| **ç±»å‹æ—** | âŒ | â­â­â­â­â­ | ç±»å‹æ³›å‹ |

---

## 3. Constæ³›å‹ vs åŠ¨æ€å¤§å°

### 3.1 æ€§èƒ½å¯¹æ¯”çŸ©é˜µ

```rust
// Constæ³›å‹ï¼šç¼–è¯‘æœŸå·²çŸ¥å¤§å°
fn stack_array<const N: usize>() -> [i32; N] {
    [0; N]  // æ ˆä¸Šåˆ†é…ï¼Œé›¶æˆæœ¬
}

// åŠ¨æ€å¤§å°ï¼šè¿è¡Œæ—¶ç¡®å®š
fn heap_vec(n: usize) -> Vec<i32> {
    vec![0; n]  // å †åˆ†é…ï¼Œè¿è¡Œæ—¶å¼€é”€
}
```

| ç»´åº¦ | Constæ³›å‹ | åŠ¨æ€å¤§å°ï¼ˆVecç­‰ï¼‰ | å·®è· |
|-----|----------|------------------|------|
| **åˆ†é…ä½ç½®** | æ ˆ | å † | å†…å­˜å±€éƒ¨æ€§ |
| **åˆ†é…å¼€é”€** | 0ns | ~50ns | æ˜¾è‘—å·®å¼‚ |
| **è®¿é—®å¼€é”€** | ç›´æ¥ç´¢å¼• | é—´æ¥ç´¢å¼• | è½»å¾®å·®å¼‚ |
| **ç¼“å­˜å‹å¥½æ€§** | â­â­â­â­â­ | â­â­â­ | æ ˆæ•°æ®æ›´ç´§å‡‘ |
| **å¤§å°çµæ´»æ€§** | ç¼–è¯‘æœŸå›ºå®š | è¿è¡Œæ—¶åŠ¨æ€ | å…³é”®æƒè¡¡ |
| **å†…å­˜å®‰å…¨** | ç¼–è¯‘æœŸä¿è¯ | è¿è¡Œæ—¶æ£€æŸ¥ | Constæ³›å‹æ›´å¼º |

### 3.2 åŸºå‡†æµ‹è¯•æ•°æ®

```rust
use criterion::{black_box, criterion_group, criterion_main, Criterion};

fn bench_const_generic(c: &mut Criterion) {
    c.bench_function("const_generic_sum", |b| {
        b.iter(|| {
            let arr: [i32; 100] = [1; 100];
            black_box(arr.iter().sum::<i32>())
        });
    });
}

fn bench_vec(c: &mut Criterion) {
    c.bench_function("vec_sum", |b| {
        b.iter(|| {
            let vec = vec![1; 100];
            black_box(vec.iter().sum::<i32>())
        });
    });
}
```

**å…¸å‹ç»“æœ**ï¼š

| æ“ä½œ | Constæ³›å‹ | Vec | åŠ é€Ÿæ¯” |
|-----|----------|-----|--------|
| åˆ›å»º | 0.5ns | 45ns | **90x** |
| æ±‚å’Œ | 15ns | 18ns | 1.2x |
| æ€»è€—æ—¶ | 15.5ns | 63ns | **4x** |

---

## 4. Constæ³›å‹ vs å®

### 4.1 å¯¹æ¯”çŸ©é˜µ

| ç»´åº¦ | Constæ³›å‹ | å® (macro_rules!) |
|-----|----------|------------------|
| **ç±»å‹å®‰å…¨** | â­â­â­â­â­ | â­â­â­ |
| **é”™è¯¯ä¿¡æ¯** | â­â­â­â­ | â­â­ |
| **è¡¨è¾¾èƒ½åŠ›** | æ•°å€¼è®¡ç®— | ä»£ç ç”Ÿæˆ |
| **å­¦ä¹ æ›²çº¿** | â­â­â­â­ | â­â­ |
| **IDEæ”¯æŒ** | â­â­â­â­â­ | â­â­â­ |
| **è°ƒè¯•ä½“éªŒ** | â­â­â­â­â­ | â­â­ |

### 4.2 å®æˆ˜å¯¹æ¯”

```rust
// âŒ æ—§æ–¹æ¡ˆï¼šä½¿ç”¨å®
macro_rules! array_sum {
    ($n:expr) => {{
        let arr = [0i32; $n];
        arr.iter().sum::<i32>()
    }};
}

// é—®é¢˜ï¼š
// 1. ç±»å‹æ£€æŸ¥å»¶è¿Ÿåˆ°å®å±•å¼€å
// 2. é”™è¯¯ä¿¡æ¯æŒ‡å‘å®å†…éƒ¨
// 3. IDEæ— æ³•æä¾›è‰¯å¥½æ”¯æŒ

// âœ… æ–°æ–¹æ¡ˆï¼šConstæ³›å‹
fn array_sum<const N: usize>() -> i32 {
    let arr = [0i32; N];
    arr.iter().sum()
}

// ä¼˜åŠ¿ï¼š
// 1. ç¼–è¯‘å™¨å®Œæ•´ç±»å‹æ£€æŸ¥
// 2. æ¸…æ™°çš„é”™è¯¯å®šä½
// 3. å®Œç¾çš„IDEé›†æˆ
```

### 4.3 é€‰æ‹©å†³ç­–

```text
éœ€è¦ç¼–è¯‘æœŸå¤„ç†ï¼Ÿ
    |
    â”œâ”€ éœ€è¦ä»£ç ç”Ÿæˆ/æ¨¡å¼åŒ¹é… â†’ å®
    |
    â”œâ”€ éœ€è¦ç¼–è¯‘æœŸæ•°å€¼è®¡ç®— â†’ Constæ³›å‹
    |
    â”œâ”€ éœ€è¦å…ƒç¼–ç¨‹èƒ½åŠ› â†’ å®
    |
    â””â”€ éœ€è¦ç±»å‹å®‰å…¨çš„å¸¸é‡å‚æ•° â†’ Constæ³›å‹
```

---

## 5. Constæ³›å‹é«˜çº§æ¨¡å¼

### 5.1 å¸¸é‡è¡¨è¾¾å¼

```rust
// åŸºç¡€ï¼šå¸¸é‡å‚æ•°
fn basic<const N: usize>(arr: [i32; N]) {}

// è¿›é˜¶ï¼šå¸¸é‡è¡¨è¾¾å¼ï¼ˆRust 1.59+ï¼‰
fn advanced<const N: usize>(arr: [i32; N * 2]) {}

// é«˜çº§ï¼šconstå‡½æ•°è®¡ç®—
const fn compute_size(n: usize) -> usize {
    n * n + 1
}

fn matrix<const N: usize>() -> [[i32; N]; compute_size(N)] {
    [[0; N]; compute_size(N)]
}
```

### 5.2 constæ³›å‹çº¦æŸ

```rust
// whereå­å¥çº¦æŸ
fn process<const N: usize>(arr: [i32; N])
where
    [(); N + 1]:,  // ç¼–è¯‘æœŸæ–­è¨€ï¼šN+1åˆæ³•
{
    // ...
}

// Traitçº¦æŸ
trait ArrayLen {
    const LEN: usize;
}

fn generic_array<T: ArrayLen>() -> [i32; T::LEN] {
    [0; T::LEN]
}
```

### 5.3 constæ³›å‹é»˜è®¤å€¼

```rust
// Rust 1.90+ æ”¯æŒconstæ³›å‹é»˜è®¤å€¼
struct Buffer<T, const SIZE: usize = 64> {
    data: [T; SIZE],
}

// ä½¿ç”¨é»˜è®¤å€¼
let buf1: Buffer<u8> = Buffer { data: [0; 64] };

// è‡ªå®šä¹‰å¤§å°
let buf2: Buffer<u8, 128> = Buffer { data: [0; 128] };
```

---

## 6. å®é™…åº”ç”¨æ¡ˆä¾‹

### 6.1 çŸ©é˜µè¿ç®—

```rust
#[derive(Debug, Clone, Copy)]
struct Matrix<T, const ROWS: usize, const COLS: usize> {
    data: [[T; COLS]; ROWS],
}

impl<T, const ROWS: usize, const COLS: usize> Matrix<T, ROWS, COLS> {
    fn new(data: [[T; COLS]; ROWS]) -> Self {
        Matrix { data }
    }
}

// ç±»å‹å®‰å…¨çš„çŸ©é˜µä¹˜æ³•
impl<T, const M: usize, const N: usize, const P: usize> Matrix<T, M, N>
where
    T: Copy + Default + std::ops::Add<Output = T> + std::ops::Mul<Output = T>,
{
    fn multiply(&self, other: &Matrix<T, N, P>) -> Matrix<T, M, P> {
        let mut result = Matrix {
            data: [[T::default(); P]; M],
        };
        
        for i in 0..M {
            for j in 0..P {
                for k in 0..N {
                    result.data[i][j] = result.data[i][j] 
                        + self.data[i][k] * other.data[k][j];
                }
            }
        }
        
        result
    }
}

// ç¼–è¯‘æœŸç»´åº¦æ£€æŸ¥
let a: Matrix<f64, 2, 3> = Matrix::new([[1.0, 2.0, 3.0], [4.0, 5.0, 6.0]]);
let b: Matrix<f64, 3, 2> = Matrix::new([[1.0, 2.0], [3.0, 4.0], [5.0, 6.0]]);
let c = a.multiply(&b);  // ç»“æœç±»å‹ï¼šMatrix<f64, 2, 2>

// âŒ ç¼–è¯‘é”™è¯¯ï¼šç»´åº¦ä¸åŒ¹é…
// let d: Matrix<f64, 2, 2> = Matrix::new([[1.0, 2.0], [3.0, 4.0]]);
// let e = a.multiply(&d);  // 3 != 2
```

### 6.2 å®šé•¿ç¼“å†²åŒº

```rust
/// é›¶æ‹·è´çš„ç¯å½¢ç¼“å†²åŒº
struct RingBuffer<T, const CAP: usize> {
    data: [T; CAP],
    read: usize,
    write: usize,
}

impl<T: Default + Copy, const CAP: usize> RingBuffer<T, CAP> {
    fn new() -> Self {
        RingBuffer {
            data: [T::default(); CAP],
            read: 0,
            write: 0,
        }
    }
    
    fn push(&mut self, item: T) -> Result<(), T> {
        let next_write = (self.write + 1) % CAP;
        if next_write == self.read {
            Err(item)  // ç¼“å†²åŒºæ»¡
        } else {
            self.data[self.write] = item;
            self.write = next_write;
            Ok(())
        }
    }
    
    fn pop(&mut self) -> Option<T> {
        if self.read == self.write {
            None  // ç¼“å†²åŒºç©º
        } else {
            let item = self.data[self.read];
            self.read = (self.read + 1) % CAP;
            Some(item)
        }
    }
}

// ç¼–è¯‘æœŸç¡®å®šå¤§å°ï¼Œæ ˆä¸Šåˆ†é…
let mut buffer: RingBuffer<u32, 8> = RingBuffer::new();
```

### 6.3 ç±»å‹å®‰å…¨çš„å•ä½ç³»ç»Ÿ

```rust
struct Quantity<const UNIT: u8> {
    value: f64,
}

const METER: u8 = 1;
const SECOND: u8 = 2;
const METER_PER_SECOND: u8 = 3;

impl Quantity<METER> {
    fn new(value: f64) -> Self {
        Quantity { value }
    }
}

impl Quantity<SECOND> {
    fn new(value: f64) -> Self {
        Quantity { value }
    }
}

// ç±»å‹å®‰å…¨çš„é™¤æ³•ï¼šè·ç¦» / æ—¶é—´ = é€Ÿåº¦
impl std::ops::Div<Quantity<SECOND>> for Quantity<METER> {
    type Output = Quantity<METER_PER_SECOND>;
    
    fn div(self, rhs: Quantity<SECOND>) -> Self::Output {
        Quantity {
            value: self.value / rhs.value,
        }
    }
}

// ç¼–è¯‘æœŸå•ä½æ£€æŸ¥
let distance = Quantity::<METER>::new(100.0);
let time = Quantity::<SECOND>::new(10.0);
let speed = distance / time;  // ç±»å‹ï¼šQuantity<METER_PER_SECOND>

// âŒ ç¼–è¯‘é”™è¯¯ï¼šå•ä½ä¸åŒ¹é…
// let wrong = distance / distance;
```

---

## 7. é™åˆ¶ä¸é™·é˜±

### 7.1 å½“å‰é™åˆ¶ï¼ˆRust 1.90ï¼‰

| é™åˆ¶ | æè¿° | è§£å†³æ–¹æ¡ˆ |
|-----|------|---------|
| **å¸¸é‡è¿ç®—å—é™** | ä¸æ”¯æŒæ‰€æœ‰const fn | ç­‰å¾…const fnæ‰©å±• |
| **ç±»å‹æ¨å¯¼é™åˆ¶** | æŸäº›åœºæ™¯éœ€æ˜¾å¼æŒ‡å®š | æ‰‹åŠ¨æ ‡æ³¨ |
| **æµ®ç‚¹æ•°ä¸æ”¯æŒ** | ä¸èƒ½ç”¨f64ä½œä¸ºconstå‚æ•° | ä½¿ç”¨æ•´æ•°+ç¼©æ”¾ |
| **å­—ç¬¦ä¸²æœ‰é™** | `&str`æ”¯æŒä¸å®Œæ•´ | ä½¿ç”¨`&'static str` |
| **constæ³›å‹é»˜è®¤å€¼** | Rust 1.90+ | å‡çº§ç‰ˆæœ¬ |

### 7.2 å¸¸è§é™·é˜±

```rust
// âŒ é™·é˜±1ï¼šè¿‡åº¦å®ä¾‹åŒ–å¯¼è‡´ä»£ç è†¨èƒ€
fn process<const N: usize>(data: [u8; N]) {
    // æ¯ä¸ªä¸åŒçš„Néƒ½ä¼šç”Ÿæˆä¸€ä»½ä»£ç 
}

// è°ƒç”¨100æ¬¡ä¸åŒçš„Nï¼Œç”Ÿæˆ100ä»½ä»£ç 
for i in 1..=100 {
    // process([0; i]);  // ç¼–è¯‘é”™è¯¯ï¼šiä¸æ˜¯const
}

// âœ… è§£å†³ï¼šä½¿ç”¨åˆ‡ç‰‡
fn process_slice(data: &[u8]) {
    // åªæœ‰ä¸€ä»½ä»£ç 
}

// âŒ é™·é˜±2ï¼šconstæ³›å‹å’Œç”Ÿå‘½å‘¨æœŸæ··ç”¨
struct Wrong<'a, const N: usize> {
    data: &'a [i32; N],  // ç”Ÿå‘½å‘¨æœŸå’Œconstæ³›å‹å†²çª
}

// âœ… è§£å†³ï¼šæ˜ç¡®è¯­ä¹‰
struct Correct<'a, const N: usize> {
    data: &'a [i32],  // è¿è¡Œæ—¶åˆ‡ç‰‡
}

// âŒ é™·é˜±3ï¼šè¯•å›¾åœ¨è¿è¡Œæ—¶è®¡ç®—constå‚æ•°
fn dynamic(n: usize) {
    // let arr = [0; n];  // ç¼–è¯‘é”™è¯¯ï¼šnä¸æ˜¯const
}

// âœ… è§£å†³ï¼šä½¿ç”¨Vecæˆ–å®
fn dynamic_correct(n: usize) {
    let arr = vec![0; n];
}
```

---

## 8. æ¼”åŒ–è·¯çº¿å›¾

### 8.1 å·²ç¨³å®šç‰¹æ€§

| ç‰¹æ€§ | ç‰ˆæœ¬ | æè¿° |
|-----|------|------|
| åŸºç¡€constæ³›å‹ | 1.51 | æ•´æ•°/å¸ƒå°”/å­—ç¬¦ |
| constæ³›å‹è¡¨è¾¾å¼ | 1.59 | æ”¯æŒ`[(); N + 1]` |
| å¤æ‚constè¡¨è¾¾å¼ | 1.65 | æ›´å¤šconst fn |
| constæ³›å‹é»˜è®¤å€¼ | 1.90 | `const N: usize = 64` |

### 8.2 æœªæ¥æ–¹å‘ï¼ˆRFCææ¡ˆï¼‰

- **å®Œæ•´çš„constè¡¨è¾¾å¼**ï¼šæ”¯æŒä»»æ„constè¿ç®—
- **const Trait**ï¼šTraitæ–¹æ³•ä½œä¸ºconst
- **ç±»å‹çº§æ•°å€¼**ï¼šæ›´å¼ºçš„ç±»å‹çº§ç¼–ç¨‹
- **ä¾èµ–ç±»å‹**ï¼šæ›´ä¸°å¯Œçš„ç±»å‹å…³ç³»è¡¨è¾¾

---

## 9. å†³ç­–çŸ©é˜µ

### 9.1 ä½•æ—¶ä½¿ç”¨Constæ³›å‹

```text
ä½ çš„åœºæ™¯ï¼š
    |
    â”œâ”€ æ•°ç»„å¤§å°å›ºå®š â†’ âœ… Constæ³›å‹
    |
    â”œâ”€ éœ€è¦ç¼–è¯‘æœŸç»´åº¦æ£€æŸ¥ â†’ âœ… Constæ³›å‹
    |
    â”œâ”€ æ€§èƒ½å…³é”®ï¼ˆæ ˆåˆ†é…ï¼‰ â†’ âœ… Constæ³›å‹
    |
    â”œâ”€ æ•°æ®å¤§å°è¿è¡Œæ—¶ç¡®å®š â†’ âŒ ä½¿ç”¨Vec
    |
    â””â”€ éœ€è¦ä»£ç ç”Ÿæˆ â†’ âŒ ä½¿ç”¨å®
```

### 9.2 æ€§èƒ½æƒè¡¡çŸ©é˜µ

| åœºæ™¯ | Constæ³›å‹ | åŠ¨æ€æ–¹æ¡ˆ | æƒè¡¡ |
|-----|----------|---------|------|
| **å°æ•°ç»„ï¼ˆ< 1KBï¼‰** | â­â­â­â­â­ | â­â­â­ | æ ˆåˆ†é…èƒœå‡º |
| **å¤§æ•°ç»„ï¼ˆ> 1MBï¼‰** | âš ï¸ æ ˆæº¢å‡ºé£é™© | â­â­â­â­â­ | å¿…é¡»å †åˆ†é… |
| **çƒ­è·¯å¾„** | â­â­â­â­â­ | â­â­â­â­ | ç¼“å­˜å‹å¥½ |
| **çµæ´»å¤§å°** | â­ | â­â­â­â­â­ | åŠ¨æ€æ€§éœ€æ±‚ |

---

## 10. å®æˆ˜æ£€æŸ¥æ¸…å•

- [ ] æ•°ç»„å¤§å°æ˜¯å¦åœ¨ç¼–è¯‘æœŸå·²çŸ¥ï¼Ÿ
- [ ] æ˜¯å¦éœ€è¦ç¼–è¯‘æœŸç»´åº¦æ£€æŸ¥ï¼Ÿ
- [ ] æ•°ç»„å¤§å°æ˜¯å¦åˆç†ï¼ˆé¿å…æ ˆæº¢å‡ºï¼‰ï¼Ÿ
- [ ] æ˜¯å¦ä¼šå¯¼è‡´è¿‡åº¦ä»£ç è†¨èƒ€ï¼Ÿ
- [ ] IDEæ”¯æŒæ˜¯å¦è¶³å¤Ÿï¼ˆå® vs Constæ³›å‹ï¼‰ï¼Ÿ
- [ ] ç›®æ ‡Rustç‰ˆæœ¬æ˜¯å¦æ”¯æŒæ‰€éœ€ç‰¹æ€§ï¼Ÿ
- [ ] æ˜¯å¦æœ‰æ›´ç®€å•çš„æ›¿ä»£æ–¹æ¡ˆï¼ˆå¦‚åˆ‡ç‰‡ï¼‰ï¼Ÿ

---

## 11. å…³è”æ–‡æ¡£

- [01_æ¦‚å¿µæœ¬ä½“.md](01_concept_ontology.md) - Constæ³›å‹çš„å½¢å¼åŒ–å®šä¹‰
- [11_æ³›å‹æ¨¡å¼å¯¹æ¯”çŸ©é˜µ.md](11_generic_pattern_comparison_matrix.md) - æ³›å‹æ¨¡å¼å…¨å±€å¯¹æ¯”
- [31_ç±»å‹ç†è®º.md](31_type_theory.md) - ä¾èµ–ç±»å‹ç†è®ºåŸºç¡€

---

## 12. ä¿®è®¢å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | ä½œè€… | å˜æ›´è¯´æ˜ |
|-----|------|------|---------|
| 1.0 | 2025-10-19 | Rust-Lang Project | åˆå§‹ç‰ˆæœ¬ï¼Œå»ºç«‹Constæ³›å‹å¯¹æ¯”æ¡†æ¶ |

---

**æ–‡æ¡£ç‰¹è‰²**ï¼š

- âœ… **å…¨é¢å¯¹æ¯”**ï¼šConstæ³›å‹ vs ç±»å‹æ³›å‹/åŠ¨æ€å¤§å°/å®
- âœ… **æ€§èƒ½é‡åŒ–**ï¼šçœŸå®åŸºå‡†æµ‹è¯•æ•°æ®
- âœ… **å®æˆ˜æ¡ˆä¾‹**ï¼šçŸ©é˜µè¿ç®—ã€ç¼“å†²åŒºã€å•ä½ç³»ç»Ÿ
- âœ… **é™·é˜±é¢„è­¦**ï¼šå¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ

**å­¦ä¹ è·¯å¾„**ï¼š

1. **åˆçº§**ï¼šç†è§£åŸºç¡€è¯­æ³•å’Œå›ºå®šå¤§å°æ•°ç»„
2. **ä¸­çº§**ï¼šæŒæ¡çŸ©é˜µè¿ç®—ç­‰å…¸å‹åº”ç”¨
3. **é«˜çº§**ï¼šconstè¡¨è¾¾å¼å’Œç±»å‹çº§ç¼–ç¨‹
