# 控制论（Control Theory）理论基础与形式化推理

```text
<think>
我注意到用户改变了请求，现在希望我关注控制论(Control Theory)而不是范畴论(Category Theory)。
我需要重新组织内容，全面介绍控制理论的核心概念、定理、形式化推理和证明等。

控制理论是工程和数学的一个分支，关注如何控制动态系统的行为。
我将从基础定义开始，
然后讨论主要的理论分支(如经典控制、现代控制、鲁棒控制等)，以及相关的数学工具、定理和形式化证明方法。

我需要保持以下重点：
1. 控制理论的核心数学基础和形式化表示
2. 关键定理及其严格证明
3. 理论推理和推论的逻辑过程
4. 各种控制方法的理论依据
5. 控制理论的形式化分析方法

我将使用中文撰写一个结构化的、全面的控制理论概述，侧重于其数学理论和形式化方法。</think>
```

## 目录

- [控制论（Control Theory）理论基础与形式化推理](#控制论control-theory理论基础与形式化推理)
  - [目录](#目录)
  - [1. 控制论基础](#1-控制论基础)
    - [1.1 系统表示与建模](#11-系统表示与建模)
    - [1.2 传递函数理论](#12-传递函数理论)
    - [1.3 状态空间表示](#13-状态空间表示)
    - [1.4 系统稳定性的数学定义](#14-系统稳定性的数学定义)
  - [2. 经典控制理论](#2-经典控制理论)
    - [2.1 根轨迹分析](#21-根轨迹分析)
    - [2.2 频率响应方法](#22-频率响应方法)
    - [2.3 稳定性判据](#23-稳定性判据)
    - [2.4 PID控制设计理论](#24-pid控制设计理论)
  - [3. 现代控制理论](#3-现代控制理论)
    - [3.1 可控性与可观测性](#31-可控性与可观测性)
    - [3.2 状态反馈控制](#32-状态反馈控制)
    - [3.3 最优控制理论](#33-最优控制理论)
    - [3.4 观测器设计](#34-观测器设计)
  - [4. 鲁棒控制理论](#4-鲁棒控制理论)
    - [4.1 不确定性建模](#41-不确定性建模)
    - [4.2 H∞控制理论](#42-h控制理论)
    - [4.3 μ分析与综合](#43-μ分析与综合)
    - [4.4 鲁棒稳定性定理](#44-鲁棒稳定性定理)
  - [5. 非线性控制理论](#5-非线性控制理论)
    - [5.1 李雅普诺夫稳定性理论](#51-李雅普诺夫稳定性理论)
    - [5.2 反馈线性化](#52-反馈线性化)
    - [5.3 滑模控制](#53-滑模控制)
    - [5.4 Backstepping方法](#54-backstepping方法)

## 1. 控制论基础

### 1.1 系统表示与建模

**定义 1.1.1**（动态系统）：动态系统是随时间变化的实体，可通过数学模型描述为：
\[ \dot{x}(t) = f(x(t), u(t), t) \]
\[ y(t) = h(x(t), u(t), t) \]
其中 \(x(t)\) 是状态向量，\(u(t)\) 是输入向量，\(y(t)\) 是输出向量，\(f\) 和 \(h\) 是描述系统动态和输出的函数。

**定义 1.1.2**（线性时不变系统，LTI）：线性时不变系统是特殊的动态系统，可表示为：
\[ \dot{x}(t) = Ax(t) + Bu(t) \]
\[ y(t) = Cx(t) + Du(t) \]
其中 \(A, B, C, D\) 是常数矩阵。

**定理 1.1.3**（叠加原理）：对于线性系统，输入的线性组合产生的响应等于各输入单独产生的响应的相同线性组合。

**证明**：考虑两个输入 \(u_1(t)\) 和 \(u_2(t)\) 及其对应状态 \(x_1(t)\) 和 \(x_2(t)\)，有：
\[ \dot{x}_1(t) = Ax_1(t) + Bu_1(t) \]
\[ \dot{x}_2(t) = Ax_2(t) + Bu_2(t) \]

对于输入 \(\alpha u_1(t) + \beta u_2(t)\)，设对应状态为 \(x(t)\)：
\[ \dot{x}(t) = Ax(t) + B(\alpha u_1(t) + \beta u_2(t)) \]

可验证 \(x(t) = \alpha x_1(t) + \beta x_2(t)\) 是此方程的解：
\[ \begin{align*}
\dot{x}(t) &= \alpha \dot{x}_1(t) + \beta \dot{x}_2(t) \\
&= \alpha[Ax_1(t) + Bu_1(t)] + \beta[Ax_2(t) + Bu_2(t)] \\
&= A[\alpha x_1(t) + \beta x_2(t)] + B[\alpha u_1(t) + \beta u_2(t)] \\
&= Ax(t) + B(\alpha u_1(t) + \beta u_2(t))
\end{align*} \]

这证明了叠加原理对状态方程成立。同理可证输出方程也满足叠加原理。

### 1.2 传递函数理论

**定义 1.2.1**（传递函数）：LTI系统的传递函数 \(G(s)\) 是输出拉普拉斯变换与输入拉普拉斯变换之比（假设初始状态为零）：
\[ G(s) = \frac{Y(s)}{U(s)} = C(sI-A)^{-1}B + D \]

**定理 1.2.2**（最终值定理）：如果 \(sF(s)\) 在 \(s=0\) 和 \(Re(s) \ge 0\) 处没有极点，则：
\[ \lim_{t \to \infty} f(t) = \lim_{s \to 0} sF(s) \]

**证明**：从拉普拉斯变换定义出发：
\[ F(s) = \int_0^{\infty} f(t)e^{-st} dt \]

微分得：
\[ \frac{dF(s)}{ds} = -\int_0^{\infty} tf(t)e^{-st} dt \]

当 \(s \to 0\) 时，若 \(f(t) \to f(\infty)\)，则：
\[ \lim_{s \to 0}sF(s) = \lim_{s \to 0}s\int_0^{\infty} f(t)e^{-st} dt \]

通过分部积分和极限交换（需要适当条件），可证明等于 \(f(\infty)\)。

**定理 1.2.3**（脉冲响应与传递函数关系）：系统的脉冲响应 \(g(t)\) 是传递函数 \(G(s)\) 的拉普拉斯逆变换：
\[ g(t) = \mathcal{L}^{-1}\{G(s)\} \]

**命题 1.2.4**：串联系统的传递函数是各子系统传递函数的乘积：
\[ G(s) = G_1(s)G_2(s)...G_n(s) \]

### 1.3 状态空间表示

**定义 1.3.1**（状态空间表示）：动态系统的状态空间表示是一组一阶微分方程：
\[ \dot{x}(t) = Ax(t) + Bu(t) \]
\[ y(t) = Cx(t) + Du(t) \]

**定理 1.3.2**（状态方程解）：给定初始状态 \(x(t_0) = x_0\)，LTI系统状态方程的解为：
\[ x(t) = e^{A(t-t_0)}x_0 + \int_{t_0}^{t} e^{A(t-\tau)}Bu(\tau)d\tau \]

**证明**：定义 \(\Phi(t, t_0) = e^{A(t-t_0)}\) 为状态转移矩阵。可验证 \(\frac{d\Phi(t,t_0)}{dt} = A\Phi(t,t_0)\)。

假设解形式为 \(x(t) = \Phi(t,t_0)z(t)\)，代入状态方程：
\[ \frac{d}{dt}[\Phi(t,t_0)z(t)] = A\Phi(t,t_0)z(t) + Bu(t) \]

展开左侧：
\[ \Phi(t,t_0)\frac{dz(t)}{dt} + A\Phi(t,t_0)z(t) = A\Phi(t,t_0)z(t) + Bu(t) \]

简化得：
\[ \Phi(t,t_0)\frac{dz(t)}{dt} = Bu(t) \]
\[ \frac{dz(t)}{dt} = \Phi(t,t_0)^{-1}Bu(t) = \Phi(t_0,t)Bu(t) \]

积分得：
\[ z(t) = z(t_0) + \int_{t_0}^{t} \Phi(t_0,\tau)Bu(\tau)d\tau \]

代回 \(x(t) = \Phi(t,t_0)z(t)\)，并注意 \(z(t_0) = x_0\)：
\[ x(t) = \Phi(t,t_0)x_0 + \Phi(t,t_0)\int_{t_0}^{t} \Phi(t_0,\tau)Bu(\tau)d\tau \]
\[ x(t) = e^{A(t-t_0)}x_0 + \int_{t_0}^{t} e^{A(t-\tau)}Bu(\tau)d\tau \]

**定理 1.3.3**（可对角化系统）：若矩阵 \(A\) 可对角化，即 \(A = P\Lambda P^{-1}\)，其中 \(\Lambda\) 是对角矩阵，则：
\[ e^{At} = Pe^{\Lambda t}P^{-1} \]

**证明**：使用矩阵指数函数的定义：
\[ e^{At} = I + At + \frac{A^2t^2}{2!} + \frac{A^3t^3}{3!} + ... \]

代入 \(A = P\Lambda P^{-1}\)：
\[ e^{At} = I + P\Lambda P^{-1}t + \frac{(P\Lambda P^{-1})^2t^2}{2!} + ... \]

注意 \((P\Lambda P^{-1})^n = P\Lambda^n P^{-1}\)，代入得：
\[ e^{At} = I + P\Lambda P^{-1}t + \frac{P\Lambda^2 P^{-1}t^2}{2!} + ... \]
\[ e^{At} = P(I + \Lambda t + \frac{\Lambda^2 t^2}{2!} + ...)P^{-1} \]
\[ e^{At} = Pe^{\Lambda t}P^{-1} \]

### 1.4 系统稳定性的数学定义

**定义 1.4.1**（BIBO稳定性）：如果对于任何有界输入，系统产生有界输出，则称系统是BIBO稳定的。

**定理 1.4.2**：LTI系统是BIBO稳定的，当且仅当其传递函数 \(G(s)\) 的所有极点都具有负实部。

**证明**：

1. 充分性：若所有极点实部为负，则脉冲响应 \(g(t) = \mathcal{L}^{-1}\{G(s)\}\) 满足 \(|g(t)| \leq Ke^{-\alpha t}\)，其中 \(K, \alpha > 0\)。

   对于有界输入 \(|u(t)| \leq M\)，输出为：
   \[ y(t) = \int_{0}^{t} g(t-\tau)u(\tau)d\tau \]

   因此：
   \[ |y(t)| \leq \int_{0}^{t} |g(t-\tau)||u(\tau)|d\tau \leq M\int_{0}^{t} Ke^{-\alpha(t-\tau)}d\tau = \frac{MK}{\alpha}(1-e^{-\alpha t}) \leq \frac{MK}{\alpha} \]

   这表明输出有界，系统是BIBO稳定的。

2. 必要性：使用反证法。假设存在极点 \(s_0\) 使得 \(Re(s_0) \geq 0\)，则可构造特定有界输入，使输出无界，与BIBO稳定性矛盾。

**定义 1.4.3**（李雅普诺夫稳定性）：平衡点 \(x_e\) 是李雅普诺夫稳定的，如果对于任意 \(\epsilon > 0\)，存在 \(\delta > 0\)，使得当 \(||x(0) - x_e|| < \delta\) 时，对所有 \(t \geq 0\)，有 \(||x(t) - x_e|| < \epsilon\)。

**定义 1.4.4**（渐近稳定性）：如果平衡点是李雅普诺夫稳定的，且对于某个 \(\delta > 0\)，当 \(||x(0) - x_e|| < \delta\) 时，有 \(\lim_{t \to \infty} ||x(t) - x_e|| = 0\)，则称平衡点是渐近稳定的。

**定理 1.4.5**：LTI系统 \(\dot{x} = Ax\) 是渐近稳定的，当且仅当矩阵 \(A\) 的所有特征值都具有负实部。

**证明**：

1. 充分性：若所有特征值实部为负，则存在正定矩阵 \(P\) 使得 \(A^TP + PA = -Q\)，其中 \(Q\) 是某个正定矩阵。定义李雅普诺夫函数 \(V(x) = x^TPx\)，则：
   \[ \dot{V}(x) = \dot{x}^TPx + x^TP\dot{x} = x^TA^TPx + x^TPAx = x^T(A^TP + PA)x = -x^TQx < 0 \]
   对于 \(x \neq 0\)。根据李雅普诺夫稳定性定理，原点是渐近稳定的。

2. 必要性：若系统渐近稳定，则所有状态趋于零，意味着状态转移矩阵 \(e^{At} \to 0\) 当 \(t \to \infty\)。这仅当所有特征值实部为负时成立。

## 2. 经典控制理论

### 2.1 根轨迹分析

**定义 2.1.1**（根轨迹）：根轨迹是闭环特征方程的根随着系统参数（通常是增益 \(K\)）变化的轨迹：
\[ 1 + KG(s) = 0 \]

**定理 2.1.2**（根轨迹起点和终点）：根轨迹起始于开环传递函数的极点（\(K=0\)），终止于开环传递函数的零点（\(K=\infty\)）。若零点数少于极点数，多余的根轨迹分支趋向无穷远。

**定理 2.1.3**（角度条件）：对于根轨迹上的点 \(s\)，有：
\[ \sum_{i=1}^{n} \angle(s-p_i) - \sum_{j=1}^{m} \angle(s-z_j) = (2k+1)\pi, \quad k = 0, \pm 1, \pm 2, ... \]
其中 \(p_i\) 是极点，\(z_j\) 是零点。

**证明**：根轨迹方程 \(1 + KG(s) = 0\) 可重写为 \(G(s) = -\frac{1}{K}\)。

对于有理函数 \(G(s) = \frac{N(s)}{D(s)} = \frac{\prod_{j=1}^{m} (s-z_j)}{\prod_{i=1}^{n} (s-p_i)}\)，取幅角得：
\[ \angle G(s) = \sum_{j=1}^{m} \angle(s-z_j) - \sum_{i=1}^{n} \angle(s-p_i) \]

而 \(\angle (-\frac{1}{K}) = (2k+1)\pi\) 对 \(K > 0\)，代入得：
\[ \sum_{j=1}^{m} \angle(s-z_j) - \sum_{i=1}^{n} \angle(s-p_i) = (2k+1)\pi \]

重排得出定理结论。

**定理 2.1.4**（幅值条件）：对于根轨迹上的点 \(s\)，增益值为：
\[ K = \frac{\prod_{i=1}^{n} |s-p_i|}{\prod_{j=1}^{m} |s-z_j|} \]

**命题 2.1.5**（渐近线）：当 \(n > m\)，根轨迹有 \(n-m\) 条渐近线，它们的交点（渐近线中心）为：
\[ \sigma_a = \frac{\sum_{i=1}^{n} p_i - \sum_{j=1}^{m} z_j}{n-m} \]
渐近线与实轴的夹角为：
\[ \phi_k = \frac{(2k+1)\pi}{n-m}, \quad k = 0, 1, ..., n-m-1 \]

### 2.2 频率响应方法

**定义 2.2.1**（频率响应）：LTI系统的频率响应是其传递函数在虚轴上的值：
\[ G(j\omega) = |G(j\omega)|e^{j\angle G(j\omega)} \]

**定理 2.2.2**（奈奎斯特稳定判据）：假设开环传递函数 \(G(s)\) 在右半平面有 \(P\) 个极点，则闭环系统稳定的充要条件是奈奎斯特曲线 \(G(j\omega)\) 绕 \(-1+j0\) 点按逆时针方向包围 \(P\) 次。

**证明**：应用复变函数论中的辐角原理。考虑闭环特征方程 \(1+G(s)=0\)，等价于 \(F(s) = 1+G(s)\) 的零点。

根据辐角原理，当 \(s\) 沿顺时针方向围绕奈奎斯特轮廓 \(\Gamma\) 一周时，\(F(s)\) 绕原点顺时针转动的圈数等于 \(F(s)\) 在 \(\Gamma\) 内部的零点数减去极点数：
\[ N = Z - P \]

其中 \(Z\) 是闭环系统特征方程在右半平面的零点数（不稳定极点数），\(P\) 是开环系统在右半平面的极点数。当 \(F(s) = 1+G(s)\)，\(F(s)\) 绕原点的圈数等于 \(G(s)\) 绕 \(-1\) 点的圈数。

对于稳定系统，需要 \(Z=0\)，因此：
\[ N = -P \]

这意味着 \(G(j\omega)\) 必须绕 \(-1\) 点逆时针方向旋转 \(P\) 次。

**定义 2.2.3**（相位裕度和幅值裕度）：

- 相位裕度 \(PM\) 是在幅值交叉频率 \(\omega_g\)（即 \(|G(j\omega_g)| = 1\)）处，相位曲线高于 \(-180^\circ\) 的角度。
- 幅值裕度 \(GM\) 是系统增益可以增加的因子，在相位交叉频率 \(\omega_p\)（即 \(\angle G(j\omega_p) = -180^\circ\)）处，表示为 \(1/|G(j\omega_p)|\)。

**定理 2.2.4**（相位裕度与阻尼比关系）：对于二阶系统，相位裕度 \(PM\) 与阻尼比 \(\zeta\) 近似关系为：
\[ PM \approx 100\zeta \text{ (度)} \]

**证明**：对于标准二阶系统 \(G(s) = \frac{\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}\)，在 \(|G(j\omega_g)| = 1\) 时，可计算 \(\angle G(j\omega_g)\) 并导出与 \(\zeta\) 的关系。

### 2.3 稳定性判据

**定理 2.3.1**（劳斯-赫尔维茨判据）：多项式 \(P(s) = a_n s^n + a_{n-1} s^{n-1} + ... + a_1 s + a_0\) 的所有根都具有负实部的充要条件是：劳斯表中第一列所有元素同号。

**劳斯表构造**：
\[ \begin{array}{ccccc}
s^n & a_n & a_{n-2} & a_{n-4} & \cdots \\
s^{n-1} & a_{n-1} & a_{n-3} & a_{n-5} & \cdots \\
s^{n-2} & b_1 & b_2 & b_3 & \cdots \\
s^{n-3} & c_1 & c_2 & c_3 & \cdots \\
\vdots & \vdots & \vdots & \vdots & \ddots \\
\end{array} \]

其中：
\[ b_1 = \frac{a_{n-1}a_{n-2} - a_n a_{n-3}}{a_{n-1}}, b_2 = \frac{a_{n-1}a_{n-4} - a_n a_{n-5}}{a_{n-1}}, \ldots \]
\[ c_1 = \frac{b_1 a_{n-3} - a_{n-1} b_2}{b_1}, c_2 = \frac{b_1 a_{n-5} - a_{n-1} b_3}{b_1}, \ldots \]

**定理 2.3.2**（奈奎斯特稳定判据）：见2.2.2

**定理 2.3.3**（李雅普诺夫稳定性定理）：如果存在正定函数 \(V(x)\)，使得其导数 \(\dot{V}(x) = \nabla V(x) \cdot f(x)\) 沿系统轨迹 \(\dot{x} = f(x)\) 是负半定的，则平衡点是稳定的；如果 \(\dot{V}(x)\) 是负定的，则平衡点是渐近稳定的。

**证明**：

1. 假设 \(V(x)\) 是正定的，\(\dot{V}(x)\) 是负半定的。在原点周围，存在李雅普诺夫函数 \(V(x)\) 的闭合水平曲面 \(V(x) = c\)。由于 \(\dot{V}(x) \leq 0\)，系统轨迹一旦进入这个闭合区域，就永远不会离开，证明了稳定性。

2. 如果 \(\dot{V}(x)\) 是负定的，则 \(V(x)\) 沿任何轨迹严格减小。由拉萨尔不变性原理，所有轨迹最终收敛到 \(\dot{V}(x) = 0\) 的最大不变集，即原点，证明了渐近稳定性。

### 2.4 PID控制设计理论

**定义 2.4.1**（PID控制器）：PID控制器的传递函数表示为：
\[ C(s) = K_p + \frac{K_i}{s} + K_d s \]
其中 \(K_p\)、\(K_i\) 和 \(K_d\) 分别是比例、积分和微分增益。

**定理 2.4.2**（齐格勒-尼科尔斯整定法）：根据系统的临界增益 \(K_u\) 和临界周期 \(T_u\)，PID参数可设置为：

- \(K_p = 0.6K_u\)
- \(K_i = 1.2K_u/T_u\)
- \(K_d = 0.075K_uT_u\)

**推导**：通过实验确定系统在纯比例控制下开始持续振荡的增益 \(K_u\) 和振荡周期 \(T_u\)，然后根据经验公式设置PID参数。

**定理 2.4.3**（PID控制系统稳定性）：对于最小相位系统 \(G(s)\)，存在PID参数 \((K_p, K_i, K_d)\) 使闭环系统稳定。

**证明**：通过根轨迹或频率响应方法，分析闭环特征方程 \(1 + C(s)G(s) = 0\) 的根分布，证明可选择合适参数使系统稳定。

## 3. 现代控制理论

### 3.1 可控性与可观测性

**定义 3.1.1**（可控性）：如果存在有界控制输入 \(u(t)\)，能在有限时间内将系统从任意初始状态 \(x(0)\) 转移到任意目标状态 \(x(T)\)，则称系统是完全可控的。

**定理 3.1.2**（可控性判据）：LTI系统 \((\dot{x} = Ax + Bu)\) 是完全可控的，当且仅当可控性矩阵
\[ \mathcal{C} = \begin{bmatrix} B & AB & A^2B & \cdots & A^{n-1}B \end{bmatrix} \]
满秩（即 \(\text{rank}(\mathcal{C}) = n\)）。

**证明**：状态方程的解为：
\[ x(T) = e^{AT}x(0) + \int_{0}^{T} e^{A(T-\tau)}Bu(\tau)d\tau \]

系统可控意味着对任意 \(x(0)\) 和 \(x(T)\)，方程：
\[ x(T) - e^{AT}x(0) = \int_{0}^{T} e^{A(T-\tau)}Bu(\tau)d\tau \]
有解 \(u(\tau)\)。

根据卡尤莱-汉密尔顿定理，\(e^{A(T-\tau)}\) 可表示为 \(A\) 的多项式。因此，积分右侧可重写为 \(\mathcal{C}\alpha\)，其中 \(\alpha\) 是某控制时间函数的积分。等式有解的充要条件是 \(\mathcal{C}\) 满秩。

**定义 3.1.3**（可观测性）：如果能通过有限时间内的系统输出 \(y(t)\) 唯一确定初始状态 \(x(0)\)，则称系统是完全可观测的。

**定理 3.1.4**（可观测性判据）：LTI系统 \((\dot{x} = Ax + Bu, y = Cx + Du)\) 是完全可观测的，当且仅当可观测性矩阵
\[ \mathcal{O} = \begin{bmatrix} C \\ CA \\ CA^2 \\ \vdots \\ CA^{n-1} \end{bmatrix} \]
满秩（即 \(\text{rank}(\mathcal{O}) = n\)）。

**证明**：类似于可控性的证明，通过分析输出响应方程推导。

**定理 3.1.5**（对偶原理）：系统 \((A, B, C, D)\) 是可控的，当且仅当对偶系统 \((A^T, C^T, B^T, D^T)\) 是可观测的。

**证明**：对偶系统的可观测性矩阵是：
\[ \mathcal{O}_d = \begin{bmatrix} B^T \\ B^T A^T \\ B^T (A^T)^2 \\ \vdots \\ B^T (A^T)^{n-1} \end{bmatrix} = \begin{bmatrix} B^T & (AB)^T & (A^2B)^T & \cdots & (A^{n-1}B)^T \end{bmatrix}^T \]

比较原系统的可控性矩阵 \(\mathcal{C}\)，有 \(\mathcal{O}_d = \mathcal{C}^T\)。矩阵与其转置有相同的秩，因此 \(\text{rank}(\mathcal{C}) = \text{rank}(\mathcal{O}_d)\)，证明了对偶性。

### 3.2 状态反馈控制

**定义 3.2.1**（状态反馈）：状态反馈控制律形式为 \(u = -Kx + r\)，其中 \(K\) 是反馈增益矩阵，\(r\) 是参考输入。

**定理 3.2.2**（极点配置）：如果系统是完全可控的，则存在状态反馈增益 \(K\)，使闭环系统 \(\dot{x} = (A-BK)x\) 具有任意预设的特征值（极点）。

**证明**：首先将系统转换为控制标准型（如果可控）。在此形式下，特征多项式的系数直接与反馈增益相关，可求解线性方程组确定 \(K\)。

**定理 3.2.3**（LQR控制）：对于代价函数
\[ J = \int_{0}^{\infty} (x^TQx + u^TRu) dt \]
其中 \(Q\) 半正定，\(R\) 正定，最优控制律为 \(u = -Kx\)，其中 \(K = R^{-1}B^TP\)，\(P\) 是Riccati方程
\[ A^TP + PA - PBR^{-1}B^TP + Q = 0 \]
的唯一正定解。

**证明**：使用动态规划或变分法。关键步骤是定义值函数 \(V(x) = x^TPx\)，代入Hamilton-Jacobi-Bellman方程，导出最优控制和Riccati方程。

### 3.3 最优控制理论

**定义 3.3.1**（最优控制问题）：给定系统动态方程和性能指标，找到使性能指标最小化的控制输入。

**定理 3.3.2**（极小值原理）：若 \(u^*(t)\) 是最优控制，\(x^*(t)\) 是相应轨迹，则存在非零共状态变量 \(p(t)\)，使得：

1. \(\dot{x}^* = \frac{\partial \mathcal{H}}{\partial p}\)
2. \(\dot{p} = -\frac{\partial \mathcal{H}}{\partial x}\)
3. \(\mathcal{H}(x^*, u^*, p) \leq \mathcal{H}(x^*, u, p)\) 对所有允许控制 \(u\)

其中 \(\mathcal{H}(x, u, p) = L(x, u) + p^Tf(x, u)\) 是Hamilton函数，\(L\) 是代价函数。

**证明**：使用变分法，考虑最优轨迹的微小扰动，导出必要条件。

**定理 3.3.3**（线性二次型调节器）：对于线性系统和二次型代价函数：
\[ \dot{x} = Ax + Bu \]
\[ J = \frac{1}{2}x^T(t_f)Sx(t_f) + \frac{1}{2}\int_{t_0}^{t_f} (x^TQx + u^TRu) dt \]

最优控制为 \(u(t) = -R^{-1}B^TP(t)x(t)\)，其中 \(P(t)\) 满足Riccati微分方程：
\[ \dot{P}(t) = -A^TP(t) - P(t)A + P(t)BR^{-1}B^TP(t) - Q \]
边界条件 \(P(t_f) = S\)。

**证明**：定义值函数 \(V(x, t) = \frac{1}{2}x^TP(t)x\)，应用Hamilton-Jacobi-Bellman方程：
\[ -\frac{\partial V}{\partial t} = \min_u \left[ \frac{1}{2}(x^TQx + u^TRu) + \frac{\partial V}{\partial x}(Ax + Bu) \right] \]

对 \(u\) 求最小值条件：
\[ Ru + B^T\frac{\partial V}{\partial x}^T = 0 \]

得出 \(u = -R^{-1}B^T\frac{\partial V}{\partial x}^T\)。代入：
\[ -\frac{1}{2}x^T\dot{P}(t)x = \frac{1}{2}x^TQx + \frac{1}{2}x^TP(t)BR^{-1}B^TP(t)x + x^TP(t)Ax \]

比较等式两边的系数，得到Riccati方程。

**定理 3.3.4**（无限时域LQR）：当 \(t_f \to \infty\)，若 \((A, B)\) 可控且 \((A, Q^{1/2})\) 可观测，则Riccati方程收敛到代数Riccati方程：
\[ A^TP + PA - PBR^{-1}B^TP + Q = 0 \]

且闭环系统渐近稳定。

**证明**：证明过程基于Riccati方程解的性质和李雅普诺夫稳定性理论。考虑闭环系统 \(\dot{x} = (A - BR^{-1}B^TP)x\)，定义李雅普诺夫函数 \(V(x) = x^TPx\)，可证明 \(\dot{V}(x) < 0\) 对所有 \(x \neq 0\)，证明系统渐近稳定。

### 3.4 观测器设计

**定义 3.4.1**（观测器）：状态观测器是一个动态系统，用于估计不可直接测量的状态变量：
\[ \dot{\hat{x}} = A\hat{x} + Bu + L(y - C\hat{x}) \]
其中 \(\hat{x}\) 是状态估计，\(L\) 是观测器增益矩阵。

**定理 3.4.2**（观测器设计）：如果系统是完全可观测的，则存在观测器增益 \(L\)，使误差动态 \(\dot{e} = (A - LC)e\)（其中 \(e = x - \hat{x}\)）具有任意预设的特征值。

**证明**：类似于极点配置定理，利用系统的可观测性，变换为可观测标准型，然后确定 \(L\) 以获得所需的特征多项式。

**定理 3.4.3**（卡尔曼滤波器）：对于具有过程噪声 \(w\) 和测量噪声 \(v\) 的线性系统：
\[ \dot{x} = Ax + Bu + w, \quad y = Cx + v \]
其中 \(w \sim \mathcal{N}(0, Q)\)，\(v \sim \mathcal{N}(0, R)\)，最优状态估计由卡尔曼滤波器给出：
\[ \dot{\hat{x}} = A\hat{x} + Bu + K(y - C\hat{x}) \]
其中卡尔曼增益 \(K = PC^TR^{-1}\)，\(P\) 满足Riccati方程：
\[ \dot{P} = AP + PA^T - PC^TR^{-1}CP + Q \]

**证明**：使用最小均方误差估计理论。定义估计误差协方差 \(P = E[(x-\hat{x})(x-\hat{x})^T]\)，推导出使 \(P\) 最小化的滤波器方程。

**定理 3.4.4**（分离原理）：对于线性系统，基于观测器的状态反馈控制 \(u = -K\hat{x}\) 的闭环特征值是状态反馈系统 \((A-BK)\) 和观测器 \((A-LC)\) 特征值的组合。

**证明**：考虑增广系统：
\[ \begin{bmatrix} \dot{x} \\ \dot{e} \end{bmatrix} = \begin{bmatrix} A-BK & BK \\ 0 & A-LC \end{bmatrix} \begin{bmatrix} x \\ e \end{bmatrix} \]
特征多项式为：
\[ \det(sI - (A-BK)) \cdot \det(sI - (A-LC)) \]
证明了闭环极点是状态反馈和观测器极点的组合。

## 4. 鲁棒控制理论

### 4.1 不确定性建模

**定义 4.1.1**（参数不确定性）：参数不确定性指系统模型中参数值的变动范围，可表示为：
\[ G(s, p) \]
其中 \(p\) 是参数向量，取值范围为 \(p \in \mathcal{P}\)。

**定义 4.1.2**（结构化不确定性）：结构化不确定性可表示为：
\[ G_{\Delta}(s) = G(s, \Delta) \]
其中 \(\Delta\) 是结构化不确定性块，通常有特定结构（如对角阵）。

**定义 4.1.3**（非结构化不确定性）：非结构化不确定性表示为：
\[ G_{\Delta}(s) = (I + \Delta W_1(s))G(s)(I + W_2(s)\Delta) \]
或
\[ G_{\Delta}(s) = G(s) + W(s)\Delta V(s) \]
其中 \(W(s)\)、\(W_1(s)\)、\(W_2(s)\) 和 \(V(s)\) 是权重函数，\(\Delta\) 满足 \(\|\Delta\|_{\infty} \leq 1\)。

**定理 4.1.4**（小增益定理）：对于不确定系统 \(G_{\Delta}(s) = G(s, \Delta)\)，如果
\[ \|G(s)\|_{\infty} \cdot \|\Delta\|_{\infty} < 1 \]
则反馈系统在所有满足 \(\|\Delta\|_{\infty} \leq 1/\|G(s)\|_{\infty}\) 的不确定性下稳定。

**证明**：使用小增益原理和反馈系统稳定性的基本结果。考虑反馈回路的传递函数 \(L(s) = G(s)\Delta\)，应用奈奎斯特稳定判据。

### 4.2 H∞控制理论

**定义 4.2.1**（H∞范数）：对于稳定传递函数 \(G(s)\)，其H∞范数定义为：
\[ \|G\|_{\infty} = \sup_{\omega} \sigma_{max}(G(j\omega)) \]
其中 \(\sigma_{max}\) 表示最大奇异值。

**定理 4.2.2**（H∞控制问题）：考虑广义控制系统：
\[ \begin{bmatrix} z \\ y \end{bmatrix} = \begin{bmatrix} P_{11}(s) & P_{12}(s) \\ P_{21}(s) & P_{22}(s) \end{bmatrix} \begin{bmatrix} w \\ u \end{bmatrix} \]
H∞控制问题是寻找控制器 \(K(s)\)，使闭环传递函数 \(T_{zw}(s)\) 的H∞范数最小化：
\[ \min_{K \text{ stabilizing}} \|T_{zw}(s)\|_{\infty} \]

**定理 4.2.3**（H∞子优控制）：对于稳定化问题，存在控制器使 \(\|T_{zw}(s)\|_{\infty} < \gamma\)，当且仅当存在正定矩阵 \(X_{\infty}\) 和 \(Y_{\infty}\)，满足以下两个Riccati方程：
\[ A^TX_{\infty} + X_{\infty}A + X_{\infty}(\gamma^{-2}B_1B_1^T - B_2B_2^T)X_{\infty} + C_1^TC_1 = 0 \]
\[ AY_{\infty} + Y_{\infty}A^T + Y_{\infty}(γ^{-2}C_1^TC_1 - C_2^TC_2)Y_{\infty} + B_1B_1^T = 0 \]
且 \(\rho(X_{\infty}Y_{\infty}) < \gamma^2\)，其中 \(\rho\) 表示谱半径。

**证明**：证明基于李雅普诺夫稳定性理论和Hamilton-Jacobi方程。关键是将H∞问题转化为求解特定代数Riccati方程和谱半径条件。

### 4.3 μ分析与综合

**定义 4.3.1**（结构化奇异值）：给定矩阵 \(M\) 和不确定性结构 \(\Delta\)，结构化奇异值 \(\mu_{\Delta}(M)\) 定义为：
\[ \mu_{\Delta}(M) = \frac{1}{\min\{k > 0 : \det(I - kM\Delta) \neq 0, \forall \Delta \in \boldsymbol{\Delta}, \|\Delta\| \leq 1\}} \]
除非不存在使 \(\det(I - M\Delta) = 0\) 的 \(\Delta \in \boldsymbol{\Delta}\)，\(\|\Delta\| \leq 1\)，此时 \(\mu_{\Delta}(M) = 0\)。

**定理 4.3.2**（μ稳定性判据）：对于不确定系统 \(M - \Delta\) 结构，系统在所有 \(\|\Delta\|_{\infty} \leq 1/\beta\) 下稳定，当且仅当：
\[ \sup_{\omega} \mu_{\Delta}(M(j\omega)) \leq \beta \]

**证明**：通过将问题转化为确定系统 \(M\) 和不确定块 \(\Delta\) 之间的互联，应用结构化奇异值的性质。

**定理 4.3.3**（μ综合）：μ综合问题是寻找控制器 \(K\)，使闭环系统对给定不确定性结构 \(\Delta\) 鲁棒稳定，同时最小化性能指标。形式上，寻找 \(K\) 使：
\[ \sup_{\omega} \mu_{\Delta}(F_l(P, K)(j\omega)) < 1 \]
其中 \(F_l(P, K)\) 是 \(P\) 和 \(K\) 的下线性分式变换。

**算法概述**：μ综合通常使用D-K迭代算法求解：
1. 固定缩放矩阵 \(D(j\omega)\)，求解H∞控制问题
2. 固定控制器 \(K\)，在频率点优化 \(D(j\omega)\)
3. 拟合 \(D(j\omega)\) 为稳定最小相位传递函数
4. 重复直至收敛

### 4.4 鲁棒稳定性定理

**定理 4.4.1**（乘性不确定性的鲁棒稳定性）：给定标称系统 \(G(s)\) 和乘性不确定性 \(G_{\Delta}(s) = G(s)(I + \Delta(s))\)，闭环系统对所有 \(\|\Delta\|_{\infty} \leq 1/\gamma\) 鲁棒稳定，当且仅当：
\[ \|T(s)\|_{\infty} < \gamma \]
其中 \(T(s) = GK(I + GK)^{-1}\) 是互补灵敏度函数。

**证明**：通过小增益定理，分析闭环系统的特征方程。

**定理 4.4.2**（加性不确定性的鲁棒稳定性）：给定标称系统 \(G(s)\) 和加性不确定性 \(G_{\Delta}(s) = G(s) + \Delta(s)\)，闭环系统对所有 \(\|\Delta\|_{\infty} \leq 1/\gamma\) 鲁棒稳定，当且仅当：
\[ \|K(I + GK)^{-1}\|_{\infty} < \gamma \]

**证明**：类似于乘性不确定性的证明，应用小增益定理。

**定理 4.4.3**（鲁棒性能）：系统满足鲁棒性能要求，当且仅当下列混合μ指标小于1：
\[ \sup_{\omega} \mu_{\hat{\Delta}}(N(j\omega)) < 1 \]
其中 \(N(s)\) 是闭环系统矩阵，\(\hat{\Delta}\) 包含不确定性块 \(\Delta\) 和性能块 \(\Delta_P\)。

**证明**：通过将性能指标转化为虚拟不确定性块，应用结构化奇异值理论。

## 5. 非线性控制理论

### 5.1 李雅普诺夫稳定性理论

**定义 5.1.1**（平衡点）：对于非线性系统 \(\dot{x} = f(x)\)，若 \(f(x^*) = 0\)，则 \(x^*\) 是系统的平衡点。

**定义 5.1.2**（李雅普诺夫稳定性）：平衡点 \(x^*\) 是李雅普诺夫稳定的，如果对于任意 \(\epsilon > 0\)，存在 \(\delta > 0\)，使得当 \(\|x(0) - x^*\| < \delta\) 时，对所有 \(t \geq 0\)，有 \(\|x(t) - x^*\| < \epsilon\)。

**定义 5.1.3**（渐近稳定性）：平衡点 \(x^*\) 是渐近稳定的，如果它是李雅普诺夫稳定的，且存在 \(\delta > 0\)，使得当 \(\|x(0) - x^*\| < \delta\) 时，\(\lim_{t \to \infty} \|x(t) - x^*\| = 0\)。

**定理 5.1.4**（李雅普诺夫直接法）：设 \(V: D \to \mathbb{R}\) 是包含原点邻域的连续可微函数，且：

1. \(V(0) = 0\) 且 \(V(x) > 0\) 对所有 \(x \in D \setminus \{0\}\)
2. \(\dot{V}(x) \leq 0\) 对所有 \(x \in D\)

则原点是稳定的。若 \(\dot{V}(x) < 0\) 对所有 \(x \in D \setminus \{0\}\)，则原点是渐近稳定的。

**证明**：

1. 对于第一部分（稳定性），任给 \(\epsilon > 0\)，选择 \(r > 0\) 使得闭球 \(B_r \subset D\)。在紧集 \(\{x : \|x\| = r\}\) 上，\(V\) 达到正最小值 \(\alpha\)。选择 \(0 < \delta < r\)，使得当 \(\|x\| < \delta\) 时，\(V(x) < \alpha\)。这保证从 \(\|x(0)\| < \delta\) 开始的轨迹满足 \(V(x(t)) \leq V(x(0)) < \alpha\)（因为 \(\dot{V} \leq 0\)），因此永远不会离开球 \(B_r\)。

2. 对于第二部分（渐近稳定性），证明 \(\lim_{t \to \infty} x(t) = 0\)。由于 \(V(x(t))\) 是非增的且有下界（0），它收敛到某个值 \(c \geq 0\)。可以证明 \(c = 0\)，否则轨迹将保持在集合 \(\{x : V(x) = c, \dot{V}(x) = 0\}\) 内，这与 \(\dot{V}(x) < 0\) 对 \(x \neq 0\) 矛盾。

**定理 5.1.5**（拉萨尔不变性原理）：设 \(V: D \to \mathbb{R}\) 是正定函数，其导数 \(\dot{V}\) 是负半定的（\(\dot{V} \leq 0\)）。定义集合 \(E = \{x \in D : \dot{V}(x) = 0\}\)，如果系统轨迹不恒定地保持在 \(E\) 的任何非零子集中，则原点是渐近稳定的。

**证明**：通过分析系统轨迹的极限行为，证明所有轨迹最终收敛到 \(E\) 中最大的不变集，在条件下，这只包含原点。

### 5.2 反馈线性化

**定义 5.2.1**（相对度）：非线性系统
\[ \dot{x} = f(x) + g(x)u \]
\[ y = h(x) \]
在点 \(x_0\) 的相对度 \(r\) 是输出 \(y\) 的导数首次显式包含输入 \(u\) 的最小阶数，即：
\[ \frac{d^r y}{dt^r} = L_f^r h(x) + L_g L_f^{r-1} h(x) u \]
其中 \(L_f h\) 和 \(L_g h\) 分别是函数 \(h\) 沿向量场 \(f\) 和 \(g\) 的李导数。

**定理 5.2.2**（输入-状态反馈线性化）：如果非线性系统具有相对度 \(n\)（系统阶数），则存在坐标变换和状态反馈：
\[ z = T(x) \]
\[ u = \alpha(x) + \beta(x)v \]
将系统转换为线性系统：
\[ \dot{z} = Az + Bv \]
\[ y = Cz \]
其中 \((A, B, C)\) 是可控标准型。

**证明**：定义新坐标 \(z_i = L_f^{i-1} h(x)\) 对 \(i = 1, 2, \ldots, n\)。在这些坐标下，系统动态变为：
\[ \dot{z}_i = z_{i+1}, \quad i = 1, 2, \ldots, n-1 \]
\[ \dot{z}_n = L_f^n h(x) + L_g L_f^{n-1} h(x) u \]

选择反馈律：
\[ u = \frac{1}{L_g L_f^{n-1} h(x)} (-L_f^n h(x) + v) \]

得到线性系统：
\[ \dot{z}_i = z_{i+1}, \quad i = 1, 2, \ldots, n-1 \]
\[ \dot{z}_n = v \]

这等价于线性系统 \(\dot{z} = Az + Bv\)，其中：
\[ A = \begin{bmatrix} 0 & 1 & 0 & \cdots & 0 \\ 0 & 0 & 1 & \cdots & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & 0 & \cdots & 1 \\ 0 & 0 & 0 & \cdots & 0 \end{bmatrix}, \quad B = \begin{bmatrix} 0 \\ 0 \\ \vdots \\ 0 \\ 1 \end{bmatrix} \]

**定理 5.2.3**（零动态）：对于相对度 \(r < n\) 的系统，存在 \(n-r\) 维的内部动态（零动态），即使输出为零时系统仍有动态行为。

**证明**：通过构造特殊的规范形式，显示系统可分解为外部动态（与输出直接相关）和内部动态。

### 5.3 滑模控制

**定义 5.3.1**（滑模面）：对于系统 \(\dot{x} = f(x, u, t)\)，滑模面定义为 \(s(x) = 0\)，其中 \(s: \mathbb{R}^n \to \mathbb{R}\) 是光滑函数。

**定理 5.3.2**（滑模存在条件）：如果存在控制律使得：
\[ s(x) \dot{s}(x) < 0 \]
对系统状态空间的某区域内所有 \(x\) 满足 \(s(x) \neq 0\)，则滑模将在有限时间内建立。

**证明**：定义李雅普诺夫函数 \(V(s) = \frac{1}{2} s^2\)，条件确保 \(\dot{V} < 0\) 对 \(s \neq 0\)，保证 \(s\) 在有限时间内达到零。

**定理 5.3.3**（等效控制）：一旦系统达到滑模面 \(s(x) = 0\)，等效控制 \(u_{eq}\) 可通过求解 \(\dot{s}(x) = 0\) 得到：
\[ \frac{\partial s}{\partial x} f(x, u_{eq}, t) = 0 \]

**证明**：在滑模面上，必须满足 \(s(x) = 0\) 和 \(\dot{s}(x) = 0\)，后者等价于 \(\frac{\partial s}{\partial x} \dot{x} = 0\)，代入动态方程得到等效控制。

**定理 5.3.4**（滑模控制律）：典型的滑模控制律形式为：
\[ u = u_{eq} - k \cdot \text{sgn}(s) \]
其中 \(k\) 是正增益，\(\text{sgn}\) 是符号函数。

**推论 5.3.5**（滑模的鲁棒性）：滑模控制对满足匹配条件的不确定性具有完全鲁棒性。

**证明**：对于系统 \(\dot{x} = f(x) + \Delta f(x) + (g(x) + \Delta g(x))u\)，如果不确定性 \(\Delta f\) 和 \(\Delta g\) 与控制输入通道匹配，则可设计足够大的增益 \(k\)，抵消这些不确定性的影响，保持滑模性质。

### 5.4 Backstepping方法

**定义 5.4.1**（三角形系统）：三角形系统是形式为：
\[ \dot{x}_1 = f_1(x_1) + g_1(x_1)x_2 \]
\[ \dot{x}_2 = f_2(x_1, x_2) + g_2(x_1, x_2)x_3 \]
\[ \vdots \]
\[ \dot{x}_n = f_n(x_1, \ldots, x_n) + g_n(x_1, \ldots, x_n)u \]

**定理 5.4.2**（Backstepping控制设计）：对于三角形系统，如果每个子系统 \(\dot{x}_i = f_i + g_i x_{i+1}\) 可稳定化，则整个系统可通过递归设计稳定化：

1. 设计虚拟控制 \(\alpha_1(x_1)\) 使子系统 \(\dot{x}_1 = f_1(x_1) + g_1(x_1)\alpha_1(x_1)\) 渐近稳定
2. 定义误差 \(z_2 = x_2 - \alpha_1(x_1)\)
3. 设计虚拟控制 \(\alpha_2(x_1, x_2)\) 使 \((x_1, z_2)\) 子系统稳定
4. 重复此过程直至最终控制输入 \(u\)

**证明**：通过递归构造李雅普诺夫函数。假设已知 \(V_1(x_1)\) 是第一个子系统的李雅普诺夫函数，对于第二步，定义 \(V_2(x_1, z_2) = V_1(x_1) + \frac{1}{2}z_2^2\)。通过适当选择 \(\alpha_2\)，确保 \(\dot{V}_2 < 0\)。递归应用此过程，最终证明整个系统稳定。

**定理 5.4.3**（基于控制李雅普诺夫函数的Backstepping）：如果存在控制李雅普诺夫函数 \(V(x)\) 和虚拟控制 \(\alpha(x)\)，使得：
\[ \frac{\partial V}{\partial x}[f(x) + g(x)\alpha(x)] < 0 \]
对所有 \(x \neq 0\)，则可以设计反馈控制器稳定整个系统。

**证明**：基于李雅普诺夫稳定性理论，通过递归过程构造合适的控制律。

控制论通过这些严格的数学定义、定理和证明，提供了分析和设计复杂控制系统的形式化框架。这些理论工具不仅能够指导实际系统的实现，还能保证系统的稳定性、性能和鲁棒性。从经典控制到现代控制再到非线性和鲁棒控制，这一演进展示了控制理论在应对越来越复杂系统挑战时的深刻洞察力和数学严谨性。
