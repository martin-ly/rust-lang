# 类型系统中的类型等价、类型相等、类型别名、新类型和类型定义

## 目录

- [类型系统中的类型等价、类型相等、类型别名、新类型和类型定义](#类型系统中的类型等价类型相等类型别名新类型和类型定义)
  - [目录](#目录)
  - [1. 类型定义](#1-类型定义)
  - [2. 类型别名](#2-类型别名)
  - [3. 新类型](#3-新类型)
  - [4. 类型等价](#4-类型等价)
  - [5. 类型的值相等](#5-类型的值相等)
  - [概念之间的联系](#概念之间的联系)

## 1. 类型定义

*类型定义*是指在语言中如何声明一个新的类型或为现有类型创建别名。

**Rust**
*类型定义*：Rust 中可以通过 struct、enum、union 等关键字定义新的类型。
*类型别名*：使用 type 关键字为现有类型创建别名。

```rust
type NanoSecond = u64; // 类型别名
struct Person { name: String, age: u32 }; // 新类型
struct NewType(u64); // 新类型
```

**Go**
*类型定义*：Go 中可以通过 struct、type 等关键字定义新的类型。
*类型别名*：Go 中的 type 关键字既可以定义新类型，也可以创建别名。

```go
type NanoSecond = int64 // 类型别名
type NewType int64 // 新类型
type Person struct { Name string; Age int } // 新类型
```

**C++**
*类型定义*：C++ 中可以通过 struct、class、enum 等关键字定义新的类型。
*类型别名*：使用 typedef 或 using 定义类型别名。

```cpp
typedef int NanoSecond; // 类型别名
struct Person { std::string name; int age; }; // 新类型
```

## 2. 类型别名

类型别名是为现有类型提供一个新名称，但不会创建一个全新的类型。

**Rust**
*定义*：使用 type 关键字。

```rust
type NanoSecond = u64;
```

*特点*：类型别名不会改变类型的语义，只是提供了一个新的名字。

**Go**
*定义*：使用 type 关键字。

```go
type NanoSecond = int64
```

*特点*：类型别名不会改变原始类型的行为或方法集。
类型别名在 Go 语言中通常用于提高代码的可读性，尤其是在处理复杂的类型时。

**C++**
*定义*：使用 typedef 或 using。

```cpp
typedef int NanoSecond;
using NanoSecond = int;
```

*特点*：类型别名不会改变类型的语义，只是提供了一个新的名字。

## 3. 新类型

*新类型*是指通过语言提供的机制定义一个全新的类型，而不是简单地为现有类型创建别名。

**Rust**
*定义*：使用 struct、enum、union 等关键字。
*特点*：新类型在类型系统中是独立的，有自己的内存布局和语义。
新类型可以定义新的方法，而原始类型不能定义新的方法。

```rust
struct Person { name: String, age: u32 }; // 新类型
struct NewType(u64); // 新类型
```

**Go**
*定义*：使用 struct 或 type 关键字。

```go
type Person struct { Name string; Age int } // 新类型
type NewType int64 // 新类型
```

*特点*：Go 中的 type 关键字可以定义新类型，也可以创建别名或者新类型。
如果定义了结构体字段，则是新类型。
新类型可以定义新的方法，而原始类型不能定义新的方法。

**C++**
*定义*：使用 struct、class、enum 等关键字。

```cpp
struct Person { std::string name; int age; };
```

*特点*：新类型在类型系统中是独立的，有自己的内存布局或者语义。
新类型可以定义新的方法，而原始类型不能定义新的方法。

## 4. 类型等价

*类型等价*是指两个类型在语义上是否可以被视为相同，主要用于类型转换和函数调用的兼容性。
类型等价见变量类型的变体性。[变体性和trait多态](./variant/variant.md)

**Rust**
*定义*：Rust 中的类型等价主要通过编译器的类型推导和类型检查来实现。
*特点*：Rust 的类型系统非常严格，类型等价通常需要显式的转换或通过 trait 实现隐式转换。

**Go**
*定义*：Go 的类型等价，主要基于结构体字段的名称和类型是否完全一致。
*特点*：Go 中的类型等价非常严格，即使是字段完全相同的结构体，如果字段顺序不同，也被视为不同的类型。

**C++**
*定义*：C++ 提供了结构等价和名字等价两种类型等价方式。
*特点*：结构等价是指两个类型在结构上完全相同，而名字等价是指两个类型在名字上完全相同。

## 5. 类型的值相等

类型值相等是指两个类型的值是否相等，这通常需要类型本身支持相等性比较。

**Rust**
*定义*：通过 PartialEq 和 Eq trait 来实现。

```rust
#[derive(PartialEq, Eq)]
struct Person { name: String, age: u32 };
```

*特点*：PartialEq 提供部分等价关系，Eq 提供完全等价关系。

**Go**
*定义*：Go 中的类型的值相等直接通过值比较实现。

```go
type Person struct { Name string; Age int }
p1 := Person{"Alice", 30}
p2 := Person{"Alice", 30}
if p1 == p2 {
    fmt.Println("Equal")
}
```

*特点*：Go 中的类型的值相等非常直观，只要字段值相等即可。

**C++**
*定义*：通过重载 == 和 != 运算符来实现。

```cpp
struct Person {
    std::string name;
    int age;
    bool operator==(const Person& other) const {
        return name == other.name && age == other.age;
    }
};
```

*特点*：C++ 中的类型的值相等需要显式定义，通过重载运算符实现。

## 概念之间的联系

**类型定义**是基础，通过它我们可以定义新的类型或为现有类型创建别名。
**类型别名**和**类型定义**是两种不同的概念，它们在语义上有所区别。
**类型别名** 和 **新类型**的区别在于是否创建了一个全新的类型。
**类型别名** - 是为现有类型创建一个别名，不会创建新的类型。
因此，**类型别名**所引用的类型与其原始类型在类型系统中是相同的，它们之间是*类型相等*。

**新类型** - 是为现有类型提供一个新名称，而新类型在类型系统中语义上是独立的。
比如可以为新类型定义新的方法，而原始类型不能定义新的方法。

**类型相等** - 是一个判断两个类型是否相同的标准，它要求两个类型的结构和布局,语义完全相同。
**类型等价** - 是一个判断两个类型是否可以被视为相同的标准，它要求两个类型在语义上可以被视为相同。
**类型等价**和**类型相等**都依赖于**类型定义**，因为它们的实现方式和语义都与*类型本身的定义*有关。

**类型值相等** - 是一个判断两个值是否相等的标准，它要求两个值的值完全相同。
**类型等价**用于判断类型是否可以被视为相同，而**类型值相等**用于判断两个值是否相等。

在实际编程中，这些概念的正确理解和使用可以帮助我们更好地设计代码，
提高代码的可读性和可维护性，同时避免类型相关的错误。
