# å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€ï¼ˆFunctional Programming Foundationsï¼‰

> **åˆ›å»ºæ—¥æœŸ**: 2025-11-15
> **æœ€åæ›´æ–°**: 2025-11-15
> **Rust ç‰ˆæœ¬**: 1.91.1+ (Edition 2024) âœ…
> **çŠ¶æ€**: âœ… å·²å®Œå–„

---

## ğŸ“Š ç›®å½•

- [å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€ï¼ˆFunctional Programming Foundationsï¼‰](#å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€functional-programming-foundations)
  - [ğŸ“Š ç›®å½•](#-ç›®å½•)
  - [æ¦‚è¿°](#æ¦‚è¿°)
  - [æ ¸å¿ƒåŸåˆ™](#æ ¸å¿ƒåŸåˆ™)
    - [1. ä¸å¯å˜æ€§ä¼˜å…ˆ](#1-ä¸å¯å˜æ€§ä¼˜å…ˆ)
    - [2. çº¯å‡½æ•°](#2-çº¯å‡½æ•°)
    - [3. å‡½æ•°ä½œä¸ºä¸€ç­‰å…¬æ°‘](#3-å‡½æ•°ä½œä¸ºä¸€ç­‰å…¬æ°‘)
  - [Rust ä¸­çš„å‡½æ•°å¼ç‰¹æ€§](#rust-ä¸­çš„å‡½æ•°å¼ç‰¹æ€§)
    - [è¿­ä»£å™¨ï¼ˆIteratorï¼‰](#è¿­ä»£å™¨iterator)
    - [é—­åŒ…ï¼ˆClosureï¼‰](#é—­åŒ…closure)
    - [æ¨¡å¼åŒ¹é…ï¼ˆPattern Matchingï¼‰](#æ¨¡å¼åŒ¹é…pattern-matching)
  - [ä¸å¯å˜æ€§](#ä¸å¯å˜æ€§)
    - [ä¸å¯å˜æ•°æ®ç»“æ„](#ä¸å¯å˜æ•°æ®ç»“æ„)
    - [ä¸å¯å˜å¼•ç”¨](#ä¸å¯å˜å¼•ç”¨)
  - [çº¯å‡½æ•°](#çº¯å‡½æ•°)
    - [çº¯å‡½æ•°çš„ä¼˜åŠ¿](#çº¯å‡½æ•°çš„ä¼˜åŠ¿)
    - [ç¤ºä¾‹](#ç¤ºä¾‹)
  - [é«˜é˜¶å‡½æ•°](#é«˜é˜¶å‡½æ•°)
  - [å‡½æ•°ç»„åˆ](#å‡½æ•°ç»„åˆ)
  - [æ¨¡å¼åŒ¹é…](#æ¨¡å¼åŒ¹é…)
  - [å®è·µç¤ºä¾‹](#å®è·µç¤ºä¾‹)
    - [ç¤ºä¾‹ 1ï¼šå‡½æ•°å¼æ•°æ®å¤„ç†](#ç¤ºä¾‹-1å‡½æ•°å¼æ•°æ®å¤„ç†)
    - [ç¤ºä¾‹ 2ï¼šå‡½æ•°å¼é”™è¯¯å¤„ç†](#ç¤ºä¾‹-2å‡½æ•°å¼é”™è¯¯å¤„ç†)
  - [å‚è€ƒèµ„æ–™](#å‚è€ƒèµ„æ–™)

---

## æ¦‚è¿°

å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œå¼ºè°ƒä½¿ç”¨å‡½æ•°è¿›è¡Œè®¡ç®—ï¼Œé¿å…å¯å˜çŠ¶æ€å’Œå‰¯ä½œç”¨ã€‚Rust è™½ç„¶ä¸æ˜¯çº¯å‡½æ•°å¼è¯­è¨€ï¼Œä½†æä¾›äº†å¼ºå¤§çš„å‡½æ•°å¼ç¼–ç¨‹ç‰¹æ€§ã€‚

## æ ¸å¿ƒåŸåˆ™

### 1. ä¸å¯å˜æ€§ä¼˜å…ˆ

Rust é»˜è®¤å˜é‡ä¸å¯å˜ï¼Œè¿™å¤©ç„¶æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹çš„ä¸å¯å˜æ€§åŸåˆ™ï¼š

```rust
// ä¸å¯å˜å˜é‡
let x = 5;
// x = 6; // ç¼–è¯‘é”™è¯¯

// å¯å˜å˜é‡éœ€è¦æ˜¾å¼å£°æ˜
let mut y = 5;
y = 6; // å…è®¸
```

### 2. çº¯å‡½æ•°

çº¯å‡½æ•°æ˜¯æŒ‡æ²¡æœ‰å‰¯ä½œç”¨ã€ç›¸åŒè¾“å…¥æ€»æ˜¯äº§ç”Ÿç›¸åŒè¾“å‡ºçš„å‡½æ•°ï¼š

```rust
// çº¯å‡½æ•°ç¤ºä¾‹
fn add(a: i32, b: i32) -> i32 {
    a + b  // æ— å‰¯ä½œç”¨ï¼Œç»“æœåªä¾èµ–äºè¾“å…¥
}

// éçº¯å‡½æ•°ç¤ºä¾‹
fn add_with_side_effect(a: i32, b: i32) -> i32 {
    println!("Adding {} and {}", a, b); // å‰¯ä½œç”¨ï¼šæ‰“å°
    a + b
}
```

### 3. å‡½æ•°ä½œä¸ºä¸€ç­‰å…¬æ°‘

åœ¨ Rust ä¸­ï¼Œå‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ã€ä½œä¸ºè¿”å›å€¼ï¼Œä¹Ÿå¯ä»¥å­˜å‚¨åœ¨å˜é‡ä¸­ï¼š

```rust
// å‡½æ•°ä½œä¸ºå‚æ•°
fn apply_twice<F>(f: F, x: i32) -> i32
where
    F: Fn(i32) -> i32,
{
    f(f(x))
}

// ä½¿ç”¨
let double = |x| x * 2;
let result = apply_twice(double, 5); // 20
```

## Rust ä¸­çš„å‡½æ•°å¼ç‰¹æ€§

### è¿­ä»£å™¨ï¼ˆIteratorï¼‰

Rust çš„è¿­ä»£å™¨æä¾›äº†å‡½æ•°å¼é£æ ¼çš„é›†åˆæ“ä½œï¼š

```rust
let numbers = vec![1, 2, 3, 4, 5];

// å‡½æ•°å¼é£æ ¼çš„é“¾å¼æ“ä½œ
let result: Vec<i32> = numbers
    .iter()
    .map(|x| x * 2)        // æ˜ å°„
    .filter(|&x| x > 5)    // è¿‡æ»¤
    .collect();            // æ”¶é›†

// ç»“æœ: [6, 8, 10]
```

### é—­åŒ…ï¼ˆClosureï¼‰

é—­åŒ…æ˜¯ Rust ä¸­å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒå·¥å…·ï¼š

```rust
// é—­åŒ…æ•è·ç¯å¢ƒå˜é‡
let multiplier = 3;
let multiply = |x| x * multiplier;

let result = multiply(5); // 15
```

### æ¨¡å¼åŒ¹é…ï¼ˆPattern Matchingï¼‰

æ¨¡å¼åŒ¹é…æ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­å¤„ç†æ•°æ®çš„é‡è¦å·¥å…·ï¼š

```rust
fn process_option(opt: Option<i32>) -> i32 {
    match opt {
        Some(x) => x * 2,
        None => 0,
    }
}
```

## ä¸å¯å˜æ€§

### ä¸å¯å˜æ•°æ®ç»“æ„

Rust é¼“åŠ±ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„ï¼š

```rust
// ä¸å¯å˜å‘é‡
let vec = vec![1, 2, 3];
// vec.push(4); // ç¼–è¯‘é”™è¯¯

// åˆ›å»ºæ–°å‘é‡è€Œä¸æ˜¯ä¿®æ”¹
let new_vec = {
    let mut v = vec.clone();
    v.push(4);
    v
};
```

### ä¸å¯å˜å¼•ç”¨

ä½¿ç”¨ä¸å¯å˜å¼•ç”¨é¿å…æ•°æ®ç«äº‰ï¼š

```rust
fn process_data(data: &Vec<i32>) -> i32 {
    data.iter().sum() // åªè¯»è®¿é—®
}
```

## çº¯å‡½æ•°

### çº¯å‡½æ•°çš„ä¼˜åŠ¿

1. **å¯æµ‹è¯•æ€§**ï¼šæ˜“äºæµ‹è¯•ï¼Œç»“æœå¯é¢„æµ‹
2. **å¯å¹¶è¡ŒåŒ–**ï¼šæ— å‰¯ä½œç”¨ï¼Œå¯ä»¥å®‰å…¨å¹¶è¡Œæ‰§è¡Œ
3. **å¯ç¼“å­˜**ï¼šç›¸åŒè¾“å…¥æ€»æ˜¯äº§ç”Ÿç›¸åŒè¾“å‡º
4. **æ˜“äºæ¨ç†**ï¼šå‡½æ•°è¡Œä¸ºåªä¾èµ–äºè¾“å…¥

### ç¤ºä¾‹

```rust
// çº¯å‡½æ•°ï¼šè®¡ç®—å¹³æ–¹
fn square(x: i32) -> i32 {
    x * x
}

// çº¯å‡½æ•°ï¼šè®¡ç®—é˜¶ä¹˜
fn factorial(n: u64) -> u64 {
    match n {
        0 | 1 => 1,
        _ => n * factorial(n - 1),
    }
}
```

## é«˜é˜¶å‡½æ•°

é«˜é˜¶å‡½æ•°æ˜¯æ¥å—å‡½æ•°ä½œä¸ºå‚æ•°æˆ–è¿”å›å‡½æ•°çš„å‡½æ•°ï¼š

```rust
// æ¥å—å‡½æ•°ä½œä¸ºå‚æ•°
fn map<F, T, U>(f: F, items: Vec<T>) -> Vec<U>
where
    F: Fn(T) -> U,
{
    items.into_iter().map(f).collect()
}

// è¿”å›å‡½æ•°
fn make_adder(x: i32) -> impl Fn(i32) -> i32 {
    move |y| x + y
}

let add_five = make_adder(5);
let result = add_five(3); // 8
```

## å‡½æ•°ç»„åˆ

å‡½æ•°ç»„åˆæ˜¯å°†å¤šä¸ªå‡½æ•°ç»„åˆæˆä¸€ä¸ªæ–°å‡½æ•°ï¼š

```rust
// å‡½æ•°ç»„åˆ
fn compose<F, G, A, B, C>(f: F, g: G) -> impl Fn(A) -> C
where
    F: Fn(B) -> C,
    G: Fn(A) -> B,
{
    move |x| f(g(x))
}

// ä½¿ç”¨
let double = |x: i32| x * 2;
let add_one = |x: i32| x + 1;
let double_then_add = compose(add_one, double);

let result = double_then_add(5); // 11
```

## æ¨¡å¼åŒ¹é…

æ¨¡å¼åŒ¹é…æ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­å¤„ç†æ•°æ®çš„é‡è¦å·¥å…·ï¼š

```rust
// åŒ¹é…æšä¸¾
enum Color {
    Red,
    Green,
    Blue,
    RGB(u8, u8, u8),
}

fn color_to_string(color: Color) -> String {
    match color {
        Color::Red => "çº¢è‰²".to_string(),
        Color::Green => "ç»¿è‰²".to_string(),
        Color::Blue => "è“è‰²".to_string(),
        Color::RGB(r, g, b) => format!("RGB({}, {}, {})", r, g, b),
    }
}

// åŒ¹é… Option
fn process_result(result: Result<i32, String>) -> i32 {
    match result {
        Ok(value) => value * 2,
        Err(e) => {
            eprintln!("é”™è¯¯: {}", e);
            0
        }
    }
}
```

## å®è·µç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šå‡½æ•°å¼æ•°æ®å¤„ç†

```rust
fn process_numbers(numbers: Vec<i32>) -> Vec<i32> {
    numbers
        .into_iter()
        .filter(|&x| x > 0)           // è¿‡æ»¤æ­£æ•°
        .map(|x| x * x)                // å¹³æ–¹
        .filter(|&x| x < 100)          // è¿‡æ»¤å°äº100çš„æ•°
        .collect()
}
```

### ç¤ºä¾‹ 2ï¼šå‡½æ•°å¼é”™è¯¯å¤„ç†

```rust
fn safe_divide(a: f64, b: f64) -> Option<f64> {
    if b != 0.0 {
        Some(a / b)
    } else {
        None
    }
}

// é“¾å¼æ“ä½œ
fn calculate(numbers: Vec<f64>) -> Option<f64> {
    numbers
        .into_iter()
        .try_fold(1.0, |acc, x| safe_divide(acc, x))
}
```

## å‚è€ƒèµ„æ–™

- [Rust è¿­ä»£å™¨æ–‡æ¡£](https://doc.rust-lang.org/std/iter/)
- [Rust é—­åŒ…æ–‡æ¡£](https://doc.rust-lang.org/book/ch13-01-closures.html)
- [å‡½æ•°å¼ç¼–ç¨‹æœ€ä½³å®è·µ](../../../crates/c04_generic/examples/)

---

**å¯¼èˆª**:

- è¿”å›ç´¢å¼•: [`00_index.md`](./00_index.md)
- è¿”å›ç¼–ç¨‹èŒƒå¼: [`../00_index.md`](../00_index.md)
