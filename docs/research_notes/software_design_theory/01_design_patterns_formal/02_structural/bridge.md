# Bridge å½¢å¼åŒ–åˆ†æ

> **åˆ›å»ºæ—¥æœŸ**: 2026-02-12
> **æœ€åæ›´æ–°**: 2026-02-20
> **Rust ç‰ˆæœ¬**: 1.93.0+ (Edition 2024)
> **çŠ¶æ€**: âœ… å·²å®Œæˆ
> **åˆ†ç±»**: ç»“æ„å‹
> **å®‰å…¨è¾¹ç•Œ**: çº¯ Safe
> **23 æ¨¡å¼çŸ©é˜µ**: [README Â§23 æ¨¡å¼å¤šç»´å¯¹æ¯”çŸ©é˜µ](../README.md#23-æ¨¡å¼å¤šç»´å¯¹æ¯”çŸ©é˜µ) ç¬¬ 7 è¡Œï¼ˆBridgeï¼‰
> **è¯æ˜æ·±åº¦**: L3ï¼ˆå®Œæ•´è¯æ˜ï¼‰

---

## ğŸ“Š ç›®å½•

- [Bridge å½¢å¼åŒ–åˆ†æ](#bridge-å½¢å¼åŒ–åˆ†æ)
  - [ğŸ“Š ç›®å½•](#-ç›®å½•)
  - [å½¢å¼åŒ–å®šä¹‰](#å½¢å¼åŒ–å®šä¹‰)
    - [Def 1.1ï¼ˆBridge ç»“æ„ï¼‰](#def-11bridge-ç»“æ„)
    - [Axiom BR1ï¼ˆè§£è€¦å…¬ç†ï¼‰](#axiom-br1è§£è€¦å…¬ç†)
    - [Axiom BR2ï¼ˆå§”æ‰˜å€Ÿç”¨å…¬ç†ï¼‰](#axiom-br2å§”æ‰˜å€Ÿç”¨å…¬ç†)
    - [å®šç† BR-T1ï¼ˆtrait ç±»å‹å®‰å…¨å®šç†ï¼‰](#å®šç†-br-t1trait-ç±»å‹å®‰å…¨å®šç†)
    - [å®šç† BR-T2ï¼ˆç»„åˆä¼˜äºç»§æ‰¿å®šç†ï¼‰](#å®šç†-br-t2ç»„åˆä¼˜äºç»§æ‰¿å®šç†)
    - [æ¨è®º BR-C1ï¼ˆçº¯ Safe Bridgeï¼‰](#æ¨è®º-br-c1çº¯-safe-bridge)
    - [æ¦‚å¿µå®šä¹‰-å±æ€§å…³ç³»-è§£é‡Šè®ºè¯ å±‚æ¬¡æ±‡æ€»](#æ¦‚å¿µå®šä¹‰-å±æ€§å…³ç³»-è§£é‡Šè®ºè¯-å±‚æ¬¡æ±‡æ€»)
  - [Rust å®ç°ä¸ä»£ç ç¤ºä¾‹](#rust-å®ç°ä¸ä»£ç ç¤ºä¾‹)
  - [å®Œæ•´è¯æ˜](#å®Œæ•´è¯æ˜)
    - [å½¢å¼åŒ–è®ºè¯é“¾](#å½¢å¼åŒ–è®ºè¯é“¾)
    - [ä¸ Rust ç±»å‹ç³»ç»Ÿçš„è”ç³»](#ä¸-rust-ç±»å‹ç³»ç»Ÿçš„è”ç³»)
    - [å†…å­˜å®‰å…¨ä¿è¯](#å†…å­˜å®‰å…¨ä¿è¯)
  - [å…¸å‹åœºæ™¯](#å…¸å‹åœºæ™¯)
  - [ç›¸å…³æ¨¡å¼](#ç›¸å…³æ¨¡å¼)
  - [å®ç°å˜ä½“](#å®ç°å˜ä½“)
  - [åä¾‹ï¼šæŠ½è±¡ä¸å®ç°ç´§è€¦åˆ](#åä¾‹æŠ½è±¡ä¸å®ç°ç´§è€¦åˆ)
  - [é€‰å‹å†³ç­–æ ‘](#é€‰å‹å†³ç­–æ ‘)
  - [ä¸ GoF å¯¹æ¯”](#ä¸-gof-å¯¹æ¯”)
  - [è¾¹ç•Œ](#è¾¹ç•Œ)
  - [ä¸ Rust 1.93 çš„å¯¹åº”](#ä¸-rust-193-çš„å¯¹åº”)
  - [æ€ç»´å¯¼å›¾](#æ€ç»´å¯¼å›¾)
  - [ä¸å…¶ä»–æ¨¡å¼çš„å…³ç³»å›¾](#ä¸å…¶ä»–æ¨¡å¼çš„å…³ç³»å›¾)
  - [å®è´¨å†…å®¹äº”ç»´è‡ªæ£€](#å®è´¨å†…å®¹äº”ç»´è‡ªæ£€)

---

## å½¢å¼åŒ–å®šä¹‰

### Def 1.1ï¼ˆBridge ç»“æ„ï¼‰

è®¾ $\mathcal{A}$ ä¸ºæŠ½è±¡ç±»å‹ï¼Œ$\mathcal{I}$ ä¸ºå®ç°ç±»å‹ã€‚Bridge æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„ $\mathcal{BR} = (\mathcal{A}, \mathcal{I}, \mathit{bridge})$ï¼Œæ»¡è¶³ï¼š

- $\mathcal{A}$ æŒæœ‰ $\mathcal{I}$ï¼š$\mathcal{A} \supset \mathcal{I}$
- æŠ½è±¡ä¸å®ç°å¯ç‹¬ç«‹å˜åŒ–ï¼›äºŒè€…é€šè¿‡ trait è§£è€¦
- trait å®šä¹‰ $\mathcal{I}$ï¼Œ$\mathcal{A}$ é€šè¿‡æ³›å‹ `T: Impl` æˆ– `Box<dyn Impl>` ä½¿ç”¨
- **åŒå‘æ‰©å±•**ï¼šæŠ½è±¡å’Œå®ç°å¯ç‹¬ç«‹æ·»åŠ æ–°å˜ä½“

**å½¢å¼åŒ–è¡¨ç¤º**ï¼š
$$\mathcal{BR} = \langle \mathcal{A}, \mathcal{I}, \mathit{bridge}: \mathcal{A} \times \mathcal{I} \rightarrow \mathrm{Behavior} \rangle$$

---

### Axiom BR1ï¼ˆè§£è€¦å…¬ç†ï¼‰

$$\forall \mathcal{A}, \mathcal{I},\, \mathcal{A}\text{ ä¸ }\mathcal{I}\text{ æ— ç¼–è¯‘æœŸä¾èµ–ï¼Œä»…é€šè¿‡ trait çº¦æŸå…³è”}$$

æŠ½è±¡ä¸å®ç°è§£è€¦ï¼ŒäºŒè€…å¯ç‹¬ç«‹æ‰©å±•ã€‚

### Axiom BR2ï¼ˆå§”æ‰˜å€Ÿç”¨å…¬ç†ï¼‰

$$\mathcal{A}.\mathit{op} \text{ è°ƒç”¨ } \mathcal{I}.\mathit{impl\_op} \text{ï¼Œæ»¡è¶³å€Ÿç”¨è§„åˆ™}$$

å§”æ‰˜æ—¶å€Ÿç”¨æ»¡è¶³ Rust å€Ÿç”¨è§„åˆ™ã€‚

---

### å®šç† BR-T1ï¼ˆtrait ç±»å‹å®‰å…¨å®šç†ï¼‰

ç”± [trait_system_formalization](../../../type_theory/trait_system_formalization.md)ï¼Œtrait å¯¹è±¡æˆ–æ³›å‹ä¿è¯ç±»å‹å®‰å…¨ã€‚

**è¯æ˜**ï¼š

1. **æ³›å‹ç‰ˆæœ¬**ï¼š

   ```rust
   struct Circle<R: Renderer> { renderer: R }
   impl<R: Renderer> Circle<R> { fn draw(&self) { self.renderer.render_circle(...); } }
   ```

   - ç¼–è¯‘æœŸå•æ€åŒ–ï¼šä¸ºæ¯ä¸ª `R` ç”Ÿæˆç‰¹å®šä»£ç 
   - ç±»å‹çº¦æŸï¼š`R: Renderer` ä¿è¯ `render_circle` å­˜åœ¨
   - é›¶è¿è¡Œæ—¶å¼€é”€

2. **trait å¯¹è±¡ç‰ˆæœ¬**ï¼š

   ```rust
   struct Circle { renderer: Box<dyn Renderer> }
   ```

   - è¿è¡Œæ—¶è™šè¡¨æ´¾å‘
   - ç±»å‹å®‰å…¨ï¼šè™šè¡¨åœ¨æ„é€ æ—¶ç¡®å®š

3. **ç‹¬ç«‹æ€§**ï¼š
   - æ·»åŠ æ–° `Renderer`ï¼šå®ç° traitï¼Œæ— éœ€ä¿®æ”¹ `Circle`
   - æ·»åŠ æ–°å½¢çŠ¶ï¼šå®šä¹‰æ–°ç»“æ„ä½“ï¼Œä½¿ç”¨ç°æœ‰ `Renderer`

ç”± trait_system_formalization è§£ææ­£ç¡®æ€§ï¼Œå¾—è¯ã€‚$\square$

---

### å®šç† BR-T2ï¼ˆç»„åˆä¼˜äºç»§æ‰¿å®šç†ï¼‰

Bridge æ¨¡å¼ä½¿ç”¨ç»„åˆè€Œéç»§æ‰¿ï¼Œé¿å…ç»§æ‰¿å±‚æ¬¡çˆ†ç‚¸ã€‚

**è¯æ˜**ï¼š

1. **ç»§æ‰¿æ–¹å¼**ï¼ˆGoFï¼‰ï¼š
   - $N$ ä¸ªæŠ½è±¡å˜ä½“ Ã— $M$ ä¸ªå®ç°å˜ä½“ = $N \times M$ ä¸ªç±»
   - ç±»çˆ†ç‚¸ï¼š$O(N \times M)$

2. **ç»„åˆæ–¹å¼**ï¼ˆRust Bridgeï¼‰ï¼š
   - $N$ ä¸ªæŠ½è±¡å˜ä½“ + $M$ ä¸ªå®ç°å˜ä½“ = $N + M$ ä¸ªç±»å‹
   - çº¿æ€§å¢é•¿ï¼š$O(N + M)$

3. **ç‹¬ç«‹æ‰©å±•**ï¼š
   - æ–°å¢æŠ½è±¡ï¼šæ·»åŠ æ–°ç»“æ„ä½“ï¼Œå¤ç”¨ç°æœ‰ `Renderer`
   - æ–°å¢å®ç°ï¼šå®ç° `Renderer`ï¼Œæ‰€æœ‰å½¢çŠ¶è‡ªåŠ¨æ”¯æŒ

ç”±ç»„åˆæ•°å­¦åŠ Rust trait ç³»ç»Ÿï¼Œå¾—è¯ã€‚$\square$

---

### æ¨è®º BR-C1ï¼ˆçº¯ Safe Bridgeï¼‰

Bridge ä¸ºçº¯ Safeï¼›trait è§£è€¦æŠ½è±¡ä¸å®ç°ï¼Œæ—  `unsafe`ã€‚

**è¯æ˜**ï¼š

1. trait å®šä¹‰ï¼š`trait Renderer { ... }` çº¯ Safe
2. æ³›å‹çº¦æŸï¼š`R: Renderer` çº¯ Safe
3. ç»„åˆæŒæœ‰ï¼š`struct Circle<R> { renderer: R }` çº¯ Safe
4. å§”æ‰˜è°ƒç”¨ï¼š`self.renderer.render()` çº¯ Safe
5. æ—  `unsafe` å—ï¼šæ•´ä¸ª Bridge å®ç°æ— éœ€ unsafe

ç”± BR-T1ã€BR-T2 åŠ [safe_unsafe_matrix](../../05_boundary_system/safe_unsafe_matrix.md) SBM-T1ï¼Œå¾—è¯ã€‚$\square$

---

### æ¦‚å¿µå®šä¹‰-å±æ€§å…³ç³»-è§£é‡Šè®ºè¯ å±‚æ¬¡æ±‡æ€»

| å±‚æ¬¡ | å†…å®¹ | æœ¬é¡µå¯¹åº” |
| :--- | :--- | :--- |
| **æ¦‚å¿µå®šä¹‰å±‚** | Def 1.1ï¼ˆBridge ç»“æ„ï¼‰ã€Axiom BR1/BR2ï¼ˆè§£è€¦ã€å§”æ‰˜å€Ÿç”¨ï¼‰ | ä¸Š |
| **å±æ€§å…³ç³»å±‚** | Axiom BR1/BR2 $\rightarrow$ å®šç† BR-T1/BR-T2 $\rightarrow$ æ¨è®º BR-C1ï¼›ä¾èµ– traitã€safe_unsafe_matrix | ä¸Š |
| **è§£é‡Šè®ºè¯å±‚** | BR-T1/BR-T2 å®Œæ•´è¯æ˜ï¼›åä¾‹ï¼šæŠ½è±¡ä¸å®ç°ç´§è€¦åˆ | Â§å®Œæ•´è¯æ˜ã€Â§åä¾‹ |

---

## Rust å®ç°ä¸ä»£ç ç¤ºä¾‹

```rust
trait Renderer {
    fn render_circle(&self, radius: f32);
}

struct VectorRenderer;
impl Renderer for VectorRenderer {
    fn render_circle(&self, radius: f32) {
        println!("Drawing circle (vector) r={}", radius);
    }
}

struct RasterRenderer;
impl Renderer for RasterRenderer {
    fn render_circle(&self, radius: f32) {
        println!("Drawing circle (raster) r={}", radius);
    }
}

struct Circle<R: Renderer> {
    radius: f32,
    renderer: R,
}

impl<R: Renderer> Circle<R> {
    fn new(radius: f32, renderer: R) -> Self {
        Self { radius, renderer }
    }
    fn draw(&self) {
        self.renderer.render_circle(self.radius);
    }
}

// ä½¿ç”¨ï¼šæŠ½è±¡ï¼ˆCircleï¼‰ä¸å®ç°ï¼ˆRendererï¼‰ç‹¬ç«‹
let c = Circle::new(5.0, VectorRenderer);
c.draw();
```

**å½¢å¼åŒ–å¯¹åº”**ï¼š`Circle` å³ $\mathcal{A}$ï¼›`Renderer` å³ $\mathcal{I}$ï¼›`draw` å§”æ‰˜ `renderer.render_circle`ã€‚

---

## å®Œæ•´è¯æ˜

### å½¢å¼åŒ–è®ºè¯é“¾

```
Axiom BR1 (è§£è€¦)
    â†“ å®ç°
trait å®šä¹‰å®ç°æ¥å£
    â†“ ä¿è¯
å®šç† BR-T1 (trait ç±»å‹å®‰å…¨)
    â†“ ç»„åˆ
Axiom BR2 (å§”æ‰˜å€Ÿç”¨)
    â†“ ä¼˜åŠ¿
å®šç† BR-T2 (ç»„åˆä¼˜äºç»§æ‰¿)
    â†“ ç»“è®º
æ¨è®º BR-C1 (çº¯ Safe Bridge)
```

### ä¸ Rust ç±»å‹ç³»ç»Ÿçš„è”ç³»

| Rust ç‰¹æ€§ | Bridge å®ç° | ç±»å‹å®‰å…¨ä¿è¯ |
| :--- | :--- | :--- |
| `trait` | å®ç°æ¥å£ | æ–¹æ³•ç­¾åçº¦æŸ |
| æ³›å‹ `<R: Renderer>` | æŠ½è±¡æŒæœ‰å®ç° | ç¼–è¯‘æœŸç±»å‹æ£€æŸ¥ |
| `Box<dyn Trait>` | è¿è¡Œæ—¶å¤šæ€ | è™šè¡¨æ´¾å‘å®‰å…¨ |
| ç»„åˆ | å­—æ®µæŒæœ‰ | æ‰€æœ‰æƒæ¸…æ™° |

### å†…å­˜å®‰å…¨ä¿è¯

1. **æ— æ‚¬å‚**ï¼šæ³›å‹æˆ– trait å¯¹è±¡ä¿è¯å®ç°æœ‰æ•ˆ
2. **å€Ÿç”¨å®‰å…¨**ï¼šå§”æ‰˜è°ƒç”¨ç¬¦åˆå€Ÿç”¨è§„åˆ™
3. **æ‰€æœ‰æƒæ¸…æ™°**ï¼šæŠ½è±¡æ‹¥æœ‰å®ç°å®ä¾‹
4. **ç±»å‹å®‰å…¨**ï¼štrait çº¦æŸä¿è¯æ–¹æ³•å­˜åœ¨

---

## å…¸å‹åœºæ™¯

| åœºæ™¯ | è¯´æ˜ |
| :--- | :--- |
| æ¸²æŸ“åç«¯ | å‘é‡/å…‰æ …ã€OpenGL/Vulkan |
| å­˜å‚¨æŠ½è±¡ | å†…å­˜/æ–‡ä»¶/ç½‘ç»œ |
| åºåˆ—åŒ– | JSON/MessagePack/Binary |
| å¹³å°æŠ½è±¡ | Win/Mac/Linux å®ç° |

---

## ç›¸å…³æ¨¡å¼

| æ¨¡å¼ | å…³ç³» |
| :--- | :--- |
| [Adapter](adapter.md) | Bridge è§£è€¦ï¼›Adapter é€‚é…å·²æœ‰æ¥å£ |
| [Strategy](../03_behavioral/strategy.md) | å®ç°å¯è§†ä¸ºç­–ç•¥ |
| [Abstract Factory](../01_creational/abstract_factory.md) | å·¥å‚å¯åˆ›å»ºæŠ½è±¡+å®ç°ç»„åˆ |

---

## å®ç°å˜ä½“

| å˜ä½“ | è¯´æ˜ | é€‚ç”¨ |
| :--- | :--- | :--- |
| æ³›å‹ `A<R: Impl>` | ç¼–è¯‘æœŸï¼›é›¶æˆæœ¬ | å®ç°ç±»å‹å·²çŸ¥ |
| `Box<dyn Impl>` | è¿è¡Œæ—¶å¤šæ€ | åŠ¨æ€é€‰æ‹©å®ç° |
| æšä¸¾å®ç° | `enum Impl { A, B }` | æœ‰é™å®ç°é›† |

---

## åä¾‹ï¼šæŠ½è±¡ä¸å®ç°ç´§è€¦åˆ

**é”™è¯¯**ï¼šæŠ½è±¡ç±»å‹ç›´æ¥ä¾èµ–å…·ä½“å®ç°ç±»å‹ï¼Œæ— æ³•æ›¿æ¢ã€‚

```rust
struct BadCircle {
    renderer: VectorRenderer,  // å†™æ­»ï¼Œæ— æ³•æ¢æˆ RasterRenderer
}
```

**åæœ**ï¼šè¿å Axiom BR1ï¼›æ‰©å±•éœ€ä¿®æ”¹æŠ½è±¡ç±»å‹ã€‚

---

## é€‰å‹å†³ç­–æ ‘

```text
æŠ½è±¡ä¸å®ç°éœ€ç‹¬ç«‹å˜åŒ–ï¼Ÿ
â”œâ”€â”€ æ˜¯ â†’ å®ç°ç±»å‹æœ‰é™ï¼Ÿ â†’ æ³›å‹ `A<R: Impl>`ï¼ˆé›¶æˆæœ¬ï¼‰
â”‚       â””â”€â”€ å®ç°ç±»å‹è¿è¡Œæ—¶å†³å®šï¼Ÿ â†’ `Box<dyn Impl>`
â”œâ”€â”€ å¦ â†’ ç›´æ¥ä¾èµ–å…·ä½“ç±»å‹
â””â”€â”€ ä»…é€‚é…å·²æœ‰æ¥å£ï¼Ÿ â†’ Adapter
```

---

## ä¸ GoF å¯¹æ¯”

| GoF | Rust å¯¹åº” | å·®å¼‚ |
| :--- | :--- | :--- |
| æŠ½è±¡ç±» + å®ç°ç±» | trait + impl | trait æ— çŠ¶æ€ |
| ç»§æ‰¿å±‚æ¬¡ | ç»„åˆ + trait | æ— ç»§æ‰¿ |
| è¿è¡Œæ—¶ç»‘å®š | `Box<dyn Impl>` | ç­‰ä»· |

---

## è¾¹ç•Œ

| ç»´åº¦ | åˆ†ç±» |
| :--- | :--- |
| å®‰å…¨ | çº¯ Safe |
| æ”¯æŒ | åŸç”Ÿ |
| è¡¨è¾¾ | ç­‰ä»· |

---

## ä¸ Rust 1.93 çš„å¯¹åº”

| 1.93 ç‰¹æ€§ | ä¸æœ¬æ¨¡å¼ | è¯´æ˜ |
| :--- | :--- | :--- |
| æ— æ–°å¢å½±å“ | â€” | 1.93 æ— å½±å“ Bridge è¯­ä¹‰çš„å˜æ›´ |
| 92 é¡¹è½ç‚¹ | æ—  | æœ¬æ¨¡å¼æœªæ¶‰åŠ [RUST_193_COUNTEREXAMPLES_INDEX](../../../RUST_193_COUNTEREXAMPLES_INDEX.md) ç‰¹å®šé¡¹ |

---

## æ€ç»´å¯¼å›¾

```mermaid
mindmap
  root((Bridge<br/>æ¡¥æ¥æ¨¡å¼))
    ç»“æ„
      Abstraction
      Implementation trait
      impl: Impl
    è¡Œä¸º
      æŠ½è±¡å§”æ‰˜å®ç°
      ç‹¬ç«‹æ‰©å±•
      ç»„åˆä¼˜äºç»§æ‰¿
    å®ç°æ–¹å¼
      æ³›å‹é›¶æˆæœ¬
      trait å¯¹è±¡
      æšä¸¾å®ç°
    åº”ç”¨åœºæ™¯
      æ¸²æŸ“åç«¯
      å­˜å‚¨æŠ½è±¡
      åºåˆ—åŒ–
      å¹³å°æŠ½è±¡
```

---

## ä¸å…¶ä»–æ¨¡å¼çš„å…³ç³»å›¾

```mermaid
graph LR
    B[Bridge<br/>æ¡¥æ¥æ¨¡å¼] -->|è§£è€¦| A[Adapter<br/>é€‚é…å™¨]
    B -->|å®ç°å³ç­–ç•¥| S[Strategy<br/>ç­–ç•¥æ¨¡å¼]
    B -->|ç»„åˆåˆ›å»º| AF[Abstract Factory<br/>æŠ½è±¡å·¥å‚]
    B -.->|å¯¹æ¯”| I[Inheritance<br/>ç»§æ‰¿]
    style B fill:#2196F3,stroke:#1565C0,stroke-width:3px,color:#fff
    style A fill:#2196F3,stroke:#1565C0,color:#fff
    style S fill:#2196F3,stroke:#1565C0,color:#fff
    style AF fill:#2196F3,stroke:#1565C0,color:#fff
    style I fill:#9E9E9E,stroke:#616161,color:#fff
```

---

## å®è´¨å†…å®¹äº”ç»´è‡ªæ£€

| è‡ªæ£€é¡¹ | çŠ¶æ€ | è¯´æ˜ |
| :--- | :--- | :--- |
| å½¢å¼åŒ– | âœ… | Def 1.1ã€Axiom BR1/BR2ã€å®šç† BR-T1/T2ï¼ˆL3 å®Œæ•´è¯æ˜ï¼‰ã€æ¨è®º BR-C1 |
| ä»£ç  | âœ… | å¯è¿è¡Œç¤ºä¾‹ |
| åœºæ™¯ | âœ… | å…¸å‹åœºæ™¯è¡¨ |
| åä¾‹ | âœ… | æŠ½è±¡ä¸å®ç°ç´§è€¦åˆ |
| è¡”æ¥ | âœ… | traitã€ownershipã€CE-T2 |
| æƒå¨å¯¹åº” | âœ… | [GoF](../README.md#ä¸-gof-åŸä¹¦å¯¹åº”)ã€[formal_methods](../../../formal_methods/README.md)ã€[INTERNATIONAL_FORMAL_VERIFICATION_INDEX](../../../INTERNATIONAL_FORMAL_VERIFICATION_INDEX.md) |
