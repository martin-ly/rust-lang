# æ€§èƒ½åŸºå‡†æµ‹è¯•

> **åˆ›å»ºæ—¥æœŸ**: 2025-01-27
> **æœ€åæ›´æ–°**: 2025-01-27
> **Rust ç‰ˆæœ¬**: 1.91.0 (Edition 2024) âœ…
> **çŠ¶æ€**: ğŸ”„ è¿›è¡Œä¸­

---

## ğŸ“Š ç›®å½•

- [æ€§èƒ½åŸºå‡†æµ‹è¯•](#æ€§èƒ½åŸºå‡†æµ‹è¯•)
  - [ğŸ“Š ç›®å½•](#-ç›®å½•)
  - [ğŸ¯ ç ”ç©¶ç›®æ ‡](#-ç ”ç©¶ç›®æ ‡)
    - [æ ¸å¿ƒé—®é¢˜](#æ ¸å¿ƒé—®é¢˜)
    - [é¢„æœŸæˆæœ](#é¢„æœŸæˆæœ)
  - [ğŸ“š ç†è®ºåŸºç¡€](#-ç†è®ºåŸºç¡€)
    - [æ€§èƒ½æŒ‡æ ‡](#æ€§èƒ½æŒ‡æ ‡)
    - [åŸºå‡†æµ‹è¯•åŸåˆ™](#åŸºå‡†æµ‹è¯•åŸåˆ™)
  - [ğŸ”¬ å®éªŒè®¾è®¡](#-å®éªŒè®¾è®¡)
    - [1. æµ‹è¯•æ¡†æ¶](#1-æµ‹è¯•æ¡†æ¶)
    - [2. æµ‹è¯•åœºæ™¯](#2-æµ‹è¯•åœºæ™¯)
    - [3. æ•°æ®æ”¶é›†](#3-æ•°æ®æ”¶é›†)
  - [ğŸ“Š å®éªŒç»“æœ](#-å®éªŒç»“æœ)
    - [å¾…æµ‹è¯•çš„åœºæ™¯](#å¾…æµ‹è¯•çš„åœºæ™¯)
    - [ç»“æœåˆ†æ](#ç»“æœåˆ†æ)
  - [ğŸ’» ä»£ç ç¤ºä¾‹](#-ä»£ç ç¤ºä¾‹)
    - [ç¤ºä¾‹ 1: åŸºæœ¬åŸºå‡†æµ‹è¯•](#ç¤ºä¾‹-1-åŸºæœ¬åŸºå‡†æµ‹è¯•)
    - [ç¤ºä¾‹ 2: å¯¹æ¯”æµ‹è¯•](#ç¤ºä¾‹-2-å¯¹æ¯”æµ‹è¯•)
    - [ç¤ºä¾‹ 3: å‚æ•°åŒ–æµ‹è¯•](#ç¤ºä¾‹-3-å‚æ•°åŒ–æµ‹è¯•)
  - [ğŸ“– å‚è€ƒæ–‡çŒ®](#-å‚è€ƒæ–‡çŒ®)
    - [å·¥å…·æ–‡æ¡£](#å·¥å…·æ–‡æ¡£)
    - [ç›¸å…³ä»£ç ](#ç›¸å…³ä»£ç )
    - [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
  - [ğŸ”„ ç ”ç©¶è¿›å±•](#-ç ”ç©¶è¿›å±•)
    - [å·²å®Œæˆ âœ…](#å·²å®Œæˆ-)
    - [è¿›è¡Œä¸­ ğŸ”„](#è¿›è¡Œä¸­-)
    - [è®¡åˆ’ä¸­ ğŸ“‹](#è®¡åˆ’ä¸­-)

---

## ğŸ¯ ç ”ç©¶ç›®æ ‡

æœ¬ç ”ç©¶çš„ç›®çš„æ˜¯é€šè¿‡åŸºå‡†æµ‹è¯•è¯„ä¼°ä¸åŒå®ç°çš„æ€§èƒ½ç‰¹å¾ï¼Œä¸ºä¼˜åŒ–æä¾›æ•°æ®æ”¯æŒã€‚

### æ ¸å¿ƒé—®é¢˜

1. **æ€§èƒ½å·®å¼‚**: ä¸åŒå®ç°çš„æ€§èƒ½å·®å¼‚å¦‚ä½•ï¼Ÿ
2. **ç“¶é¢ˆè¯†åˆ«**: å¦‚ä½•è¯†åˆ«æ€§èƒ½ç“¶é¢ˆï¼Ÿ
3. **ä¼˜åŒ–æ•ˆæœ**: ä¼˜åŒ–çš„æ•ˆæœå¦‚ä½•é‡åŒ–ï¼Ÿ

### é¢„æœŸæˆæœ

- æ€§èƒ½åŸºå‡†æµ‹è¯•æ¡†æ¶
- æ€§èƒ½æ•°æ®å’Œåˆ†ææŠ¥å‘Š
- ä¼˜åŒ–å»ºè®®å’Œå®è·µæŒ‡å—

---

## ğŸ“š ç†è®ºåŸºç¡€

### æ€§èƒ½æŒ‡æ ‡

1. **æ‰§è¡Œæ—¶é—´**: ç¨‹åºæ‰§è¡Œæ‰€éœ€çš„æ—¶é—´
2. **ååé‡**: å•ä½æ—¶é—´å†…å¤„ç†çš„æ•°æ®é‡
3. **å»¶è¿Ÿ**: å•ä¸ªæ“ä½œçš„å“åº”æ—¶é—´
4. **èµ„æºä½¿ç”¨**: CPUã€å†…å­˜ç­‰èµ„æºçš„ä½¿ç”¨æƒ…å†µ

### åŸºå‡†æµ‹è¯•åŸåˆ™

- **å¯é‡å¤æ€§**: ç»“æœåº”è¯¥å¯é‡å¤
- **ä»£è¡¨æ€§**: æµ‹è¯•åº”è¯¥ä»£è¡¨å®é™…ä½¿ç”¨åœºæ™¯
- **å…¬å¹³æ€§**: æµ‹è¯•åº”è¯¥å…¬å¹³æ¯”è¾ƒä¸åŒå®ç°
- **ç»Ÿè®¡æœ‰æ•ˆæ€§**: ä½¿ç”¨ç»Ÿè®¡æ–¹æ³•åˆ†æç»“æœ

---

## ğŸ”¬ å®éªŒè®¾è®¡

### 1. æµ‹è¯•æ¡†æ¶

ä½¿ç”¨ Criterion.rs ä½œä¸ºåŸºå‡†æµ‹è¯•æ¡†æ¶ï¼š

```rust
use criterion::{black_box, criterion_group, criterion_main, Criterion};

fn benchmark_function(c: &mut Criterion) {
    c.bench_function("function_name", |b| {
        b.iter(|| {
            // è¢«æµ‹è¯•çš„ä»£ç 
            black_box(function_to_test())
        })
    });
}

criterion_group!(benches, benchmark_function);
criterion_main!(benches);
```

### 2. æµ‹è¯•åœºæ™¯

- **å°æ•°æ®**: æµ‹è¯•å°è§„æ¨¡æ•°æ®çš„æ€§èƒ½
- **å¤§æ•°æ®**: æµ‹è¯•å¤§è§„æ¨¡æ•°æ®çš„æ€§èƒ½
- **è¾¹ç•Œæƒ…å†µ**: æµ‹è¯•è¾¹ç•Œæƒ…å†µçš„æ€§èƒ½
- **å…¸å‹åœºæ™¯**: æµ‹è¯•å…¸å‹ä½¿ç”¨åœºæ™¯çš„æ€§èƒ½

### 3. æ•°æ®æ”¶é›†

- **å¤šæ¬¡è¿è¡Œ**: æ¯ä¸ªæµ‹è¯•è¿è¡Œå¤šæ¬¡å–å¹³å‡å€¼
- **ç»Ÿè®¡æ–¹æ³•**: ä½¿ç”¨ç»Ÿè®¡æ–¹æ³•åˆ†æç»“æœ
- **ç¯å¢ƒæ§åˆ¶**: æ§åˆ¶å®éªŒç¯å¢ƒçš„ä¸€è‡´æ€§

---

## ğŸ“Š å®éªŒç»“æœ

### å¾…æµ‹è¯•çš„åœºæ™¯

1. **æ•°æ®ç»“æ„æ€§èƒ½**: ä¸åŒæ•°æ®ç»“æ„çš„æ€§èƒ½æ¯”è¾ƒ
2. **ç®—æ³•æ€§èƒ½**: ä¸åŒç®—æ³•çš„æ€§èƒ½æ¯”è¾ƒ
3. **å¹¶å‘æ€§èƒ½**: ä¸åŒå¹¶å‘æ¨¡å‹çš„æ€§èƒ½æ¯”è¾ƒ
4. **å†…å­˜åˆ†é…**: ä¸åŒå†…å­˜åˆ†é…ç­–ç•¥çš„æ€§èƒ½æ¯”è¾ƒ

### ç»“æœåˆ†æ

- **æ€§èƒ½å¯¹æ¯”**: å¯¹æ¯”ä¸åŒå®ç°çš„æ€§èƒ½
- **ç“¶é¢ˆè¯†åˆ«**: è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
- **ä¼˜åŒ–å»ºè®®**: æä¾›ä¼˜åŒ–å»ºè®®

---

## ğŸ’» ä»£ç ç¤ºä¾‹

### ç¤ºä¾‹ 1: åŸºæœ¬åŸºå‡†æµ‹è¯•

```rust
use criterion::{black_box, criterion_group, criterion_main, Criterion};

fn fibonacci(n: u64) -> u64 {
    match n {
        0 => 0,
        1 => 1,
        n => fibonacci(n - 1) + fibonacci(n - 2),
    }
}

fn benchmark_fibonacci(c: &mut Criterion) {
    c.bench_function("fibonacci 20", |b| {
        b.iter(|| fibonacci(black_box(20)))
    });
}

criterion_group!(benches, benchmark_fibonacci);
criterion_main!(benches);
```

### ç¤ºä¾‹ 2: å¯¹æ¯”æµ‹è¯•

```rust
use criterion::{black_box, criterion_group, criterion_main, Criterion};

fn vec_sum(vec: &[i32]) -> i32 {
    vec.iter().sum()
}

fn vec_sum_fold(vec: &[i32]) -> i32 {
    vec.iter().fold(0, |acc, x| acc + x)
}

fn benchmark_comparison(c: &mut Criterion) {
    let data: Vec<i32> = (0..1000).collect();

    c.bench_function("sum", |b| {
        b.iter(|| vec_sum(black_box(&data)))
    });

    c.bench_function("fold", |b| {
        b.iter(|| vec_sum_fold(black_box(&data)))
    });
}

criterion_group!(benches, benchmark_comparison);
criterion_main!(benches);
```

### ç¤ºä¾‹ 3: å‚æ•°åŒ–æµ‹è¯•

```rust
use criterion::{black_box, criterion_group, criterion_main, Criterion, PlotConfiguration};

fn benchmark_with_size(c: &mut Criterion) {
    let plot_config = PlotConfiguration::default().summary_scale(criterion::AxisScale::Logarithmic);

    let mut group = c.benchmark_group("vector_operations");
    group.plot_config(plot_config);

    for size in [10, 100, 1000, 10000].iter() {
        let data: Vec<i32> = (0..*size).collect();

        group.bench_with_input(
            criterion::BenchmarkId::new("sum", size),
            &data,
            |b, data| b.iter(|| vec_sum(black_box(data))),
        );
    }

    group.finish();
}

criterion_group!(benches, benchmark_with_size);
criterion_main!(benches);
```

---

## ğŸ“– å‚è€ƒæ–‡çŒ®

### å·¥å…·æ–‡æ¡£

- [Criterion.rs æ–‡æ¡£](https://docs.rs/criterion/)
- [Rust åŸºå‡†æµ‹è¯•æŒ‡å—](https://doc.rust-lang.org/unstable-book/library-features/test.html)
- [æ€§èƒ½åˆ†æå·¥å…·](https://doc.rust-lang.org/book/ch14-06-performance.html)

### ç›¸å…³ä»£ç 

- [åŸºå‡†æµ‹è¯•æ¡†æ¶](../../../crates/c08_algorithms/benches/)
- [æ€§èƒ½åˆ†æå·¥å…·](../../../crates/c06_async/benches/)
- [ç®—æ³•å®ç°](../../../crates/c08_algorithms/src/)

### æœ€ä½³å®è·µ

- [Rust æ€§èƒ½ä¼˜åŒ–æŒ‡å—](https://nnethercote.github.io/perf-book/)
- [æ€§èƒ½æµ‹è¯•æœ€ä½³å®è·µ](https://github.com/bheisler/criterion.rs/blob/master/book/src/user_guide/best_practices.md)

---

## ğŸ”„ ç ”ç©¶è¿›å±•

### å·²å®Œæˆ âœ…

- [x] ç ”ç©¶ç›®æ ‡å®šä¹‰
- [x] ç†è®ºåŸºç¡€æ•´ç†
- [x] å®éªŒè®¾è®¡æ¡†æ¶

### è¿›è¡Œä¸­ ğŸ”„

- [ ] å…·ä½“å®éªŒè®¾è®¡
- [ ] æ•°æ®æ”¶é›†
- [ ] ç»“æœåˆ†æ

### è®¡åˆ’ä¸­ ğŸ“‹

- [ ] æ€§èƒ½ä¼˜åŒ–å»ºè®®
- [ ] å®é™…åº”ç”¨æ¡ˆä¾‹
- [ ] å·¥å…·æ”¹è¿›

---

**ç»´æŠ¤è€…**: Rust Performance Research Group
**æœ€åæ›´æ–°**: 2025-01-27
**çŠ¶æ€**: ğŸ”„ **è¿›è¡Œä¸­**
